{"version":3,"file":"static/js/211.1c953a26.chunk.js","mappings":"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","sources":["components/FoodTracker/AddFoodTab.js","components/FoodTracker/FoodJournalTab.js","components/FoodTracker/enhanced-efficiency-functions.js","components/FoodTracker/FoodTrackerAnalysis.js","components/FoodTracker/MicronutrientRadarChart.js","components/FoodTracker/VitaminTimeSeriesTab.js","components/FoodTracker/FoodTrackerPage.js"],"sourcesContent":["import React from 'react';\n\n// ServingSuggestions component - WITHOUT common portions\nconst ServingSuggestions = ({ selectedMeal, onServingSelect, currentServing, currentUnit = 'g' }) => {\n  if (!selectedMeal || !selectedMeal.nutritional_metrics) return null;\n\n  const { serving_options } = selectedMeal.nutritional_metrics; // REMOVED: common_portions\n  \n  const isSelected = (weight, unit = 'g') => {\n    const weightMatch = parseFloat(currentServing) === parseFloat(weight);\n    const unitMatch = (currentUnit || 'g') === (unit || 'g');\n    return weightMatch && unitMatch;\n  };\n\n  const handleServingClick = (weight, description, unit = 'g') => {\n    console.log('Serving button clicked:', { weight, description, unit });\n    if (onServingSelect && typeof onServingSelect === 'function') {\n      onServingSelect(weight, description, unit);\n    } else {\n      console.error('onServingSelect is not a function:', onServingSelect);\n    }\n  };\n\n  const getUnitIcon = (unit) => {\n    switch(unit) {\n      case 'ml': return '';\n      case 'g': return '';\n      case 'oz': return '';\n      default: return '';\n    }\n  };\n\n  return (\n    <div className=\"serving-suggestions\">\n      <h4> Serving Size Suggestions</h4>\n      \n      {serving_options && Object.keys(serving_options).length > 0 && (\n        <div className=\"serving-category\">\n          <h5>Standard Serving Options</h5>\n          <div className=\"serving-buttons\">\n            {Object.entries(serving_options).map(([key, option]) => {\n              const selected = isSelected(option.weight, option.unit || 'g');\n              \n              return (\n                <button\n                  key={`standard-${key}-${option.weight}-${option.unit || 'g'}`}\n                  className={`serving-button ${selected ? 'selected' : ''}`}\n                  onClick={() => handleServingClick(option.weight, option.description, option.unit || 'g')}\n                  title={option.description}\n                  data-unit={option.unit || 'g'}\n                  data-selected={selected}\n                >\n                  <span className=\"serving-icon\">{getUnitIcon(option.unit || 'g')}</span>\n                  <span className=\"serving-weight\">\n                    {option.weight}{option.unit || 'g'}\n                  </span>\n                  <span className=\"serving-description\">{option.description}</span>\n                </button>\n              );\n            })}\n          </div>\n        </div>\n      )}\n      \n      <div className=\"serving-note\">\n        <small> Click any suggestion to automatically set the serving size and update nutrition values</small>\n        <small> Liquid measurements (ml) are converted to equivalent weights for accurate nutrition calculation</small>\n        {currentServing && currentUnit && (\n          <div className=\"current-selection\">\n            <small><strong>Current:</strong> {currentServing}{currentUnit}</small>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\n// Long COVID Food Information Component\nconst LongCovidFoodInfo = ({ foodName, mealData }) => {\n  if (mealData && (mealData.longCovidRelevance || mealData.longCovidBenefits || mealData.longCovidCautions)) {\n    const covidRelevance = mealData.longCovidRelevance || {};\n    const benefits = mealData.longCovidBenefits || [];\n    const cautions = mealData.longCovidCautions || [];\n    const functionalCompounds = mealData.functionalCompounds || {};\n\n    let category = 'neutral';\n    if (benefits.length > cautions.length) category = 'beneficial';\n    if (cautions.length > benefits.length) category = 'caution';\n\n    const antiInflammatoryLevel = covidRelevance.antiInflammatory || 'unknown';\n\n    return (\n      <div className={`long-covid-food-info ${category}`}>\n        <div className=\"food-info-header\">\n          <span className={`category-icon ${category}`}>\n            {category === 'beneficial' ? '' : \n             category === 'caution' ? '' : ''}\n          </span>\n          <strong>Database Analysis: {foodName}</strong>\n        </div>\n        \n        <div className=\"inflammatory-level\">\n          <h5> Anti-Inflammatory Level</h5>\n          <div className={`level-indicator level-${antiInflammatoryLevel}`}>\n            <span className=\"level-value\"> {antiInflammatoryLevel.toUpperCase()}</span>\n            <span className=\"level-description\">\n              {antiInflammatoryLevel === 'high' ? 'Excellent for reducing inflammation' :\n               antiInflammatoryLevel === 'moderate' ? 'Moderately helpful for inflammation' :\n               antiInflammatoryLevel === 'low' ? 'Limited anti-inflammatory effects' :\n               antiInflammatoryLevel === 'neutral' ? 'No significant inflammatory impact' : 'Not assessed'}\n            </span>\n          </div>\n        </div>\n\n        {Object.keys(functionalCompounds).length > 0 && (\n          <div className=\"functional-compounds\">\n            <h5> Functional Compounds</h5>\n            <div className=\"compounds-grid\">\n              {Object.entries(functionalCompounds).map(([compound, level]) => (\n                <div key={compound} className=\"compound-item\">\n                  <span className=\"compound-name\">{compound.replace(/_/g, ' ')}</span>\n                  <span className={`compound-level level-${level}`}> {level}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n        \n        {benefits.length > 0 && (\n          <div className=\"benefits-list\">\n            <h5> Benefits for Long COVID Recovery</h5>\n            <ul>\n              {benefits.map((benefit, i) => (\n                <li key={i}>{benefit}</li>\n              ))}\n            </ul>\n          </div>\n        )}\n        \n        {cautions.length > 0 && (\n          <div className=\"cautions-list\">\n            <h5> Important Considerations</h5>\n            <ul>\n              {cautions.map((caution, i) => (\n                <li key={i}>{caution}</li>\n              ))}\n            </ul>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"no-food-info\">\n      <div className=\"no-data-icon\"></div>\n      <h4>No Long COVID Data Available</h4>\n      <p>This food doesn't have specific Long COVID information in our database yet.</p>\n      <p>Consider general anti-inflammatory principles:</p>\n      <ul className=\"general-tips\">\n        <li>Choose whole, unprocessed versions when possible</li>\n        <li>Pay attention to how it affects your symptoms</li>\n        <li>Consider portion sizes and frequency</li>\n        <li>Pair with known anti-inflammatory foods</li>\n      </ul>\n    </div>\n  );\n};\n\n// Long COVID Side Panel Component\nconst LongCovidSidePanel = ({ selectedFood, selectedMeal, foodLog = [], isSearching = false, searchTerm = '' }) => {\n  if (selectedFood && selectedMeal) {\n    return (\n      <div className=\"long-covid-side-panel\">\n        <h3> Long COVID Nutrition Guide</h3>\n        <div className=\"selected-food-analysis\">\n          <LongCovidFoodInfo foodName={selectedFood} mealData={selectedMeal} />\n          \n          <div className=\"back-to-guide\">\n            <p className=\"guide-hint\">\n              <em>Clear selection to see the full nutrition guide</em>\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (isSearching && searchTerm.length >= 2) {\n    return (\n      <div className=\"long-covid-side-panel\">\n        <h3> Long COVID Nutrition Guide</h3>\n        \n        <div className=\"search-status\">\n          <p className=\"search-hint\">\n            <em>Searching for \"{searchTerm}\"... Select a food above to see its specific analysis.</em>\n          </p>\n        </div>\n        \n        <div className=\"nutrition-categories\">\n          <div className=\"category-section beneficial\">\n            <h4> Quick Anti-Inflammatory Guide</h4>\n            <p>Focus on omega-3 rich fish, berries, leafy greens, and anti-inflammatory spices.</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"long-covid-side-panel\">\n      <h3> Long COVID Nutrition Guide</h3>\n\n      <div className=\"nutrition-categories\">\n        <div className=\"category-section beneficial\">\n          <h4> Anti-Inflammatory Foods</h4>\n          <ul>\n            <li><strong>Fatty Fish:</strong> Salmon, mackerel, sardines (omega-3s)</li>\n            <li><strong>Berries:</strong> Blueberries, strawberries (antioxidants)</li>\n            <li><strong>Leafy Greens:</strong> Spinach, kale (vitamins, minerals)</li>\n            <li><strong>Nuts:</strong> Walnuts, almonds (healthy fats)</li>\n            <li><strong>Turmeric:</strong> Contains curcumin (anti-inflammatory)</li>\n            <li><strong>Ginger:</strong> Natural anti-inflammatory</li>\n            <li><strong>Green Tea:</strong> Polyphenols reduce inflammation</li>\n          </ul>\n        </div>\n\n        <div className=\"category-section neutral\">\n          <h4> Recommended Foods</h4>\n          <ul>\n            <li><strong>Whole Grains:</strong> Oats, quinoa, brown rice</li>\n            <li><strong>Lean Proteins:</strong> Chicken, turkey, legumes</li>\n            <li><strong>Citrus Fruits:</strong> High in vitamin C</li>\n            <li><strong>Olive Oil:</strong> Monounsaturated fats</li>\n            <li><strong>Garlic & Onions:</strong> Immune support</li>\n          </ul>\n        </div>\n\n        <div className=\"category-section caution\">\n          <h4> Foods to Limit</h4>\n          <ul>\n            <li><strong>Processed Foods:</strong> High in inflammation-promoting ingredients</li>\n            <li><strong>Refined Sugars:</strong> Can worsen inflammation</li>\n            <li><strong>Red/Processed Meat:</strong> May increase inflammatory markers</li>\n            <li><strong>Trans Fats:</strong> Found in margarine, processed foods</li>\n            <li><strong>Refined Carbs:</strong> White bread, pastries</li>\n            <li><strong>Fried Foods:</strong> High in inflammatory compounds</li>\n          </ul>\n        </div>\n      </div>\n\n      <div className=\"additional-tips\">\n        <h4> General Tips</h4>\n        <ul>\n          <li>Stay well hydrated (8+ glasses water daily)</li>\n          <li>Consider vitamin D supplementation</li>\n          <li>Eat regular, smaller meals to maintain energy</li>\n          <li>Focus on nutrient-dense, whole foods</li>\n          <li>Limit alcohol and caffeine if they worsen symptoms</li>\n        </ul>\n      </div>\n    </div>\n  );\n};\n\n// Main AddFoodTab component\nconst AddFoodTab = ({\n  // Search and meal selection\n  search,\n  setSearch,\n  suggestions,\n  setSuggestions,\n  selectedMeal,\n  setSelectedMeal,\n  searchFocused,\n  setSearchFocused,\n  renderSearchInput,\n  handleSelectMeal,\n  clearSearch,\n  \n  // Form fields and state\n  fields,\n  setFields,\n  mealType,\n  setMealType,\n  time,\n  setTime,\n  date,\n  setDate,\n  longCovidAdjust,\n  setLongCovidAdjust,\n  \n  // Edit mode\n  editingEntry,\n  handleCancelEdit,\n  \n  // Form handlers\n  handleFieldChange,\n  handleServingSelection,\n  handleTimeChange,\n  convertTo24Hour,\n  handleLogFood,\n  \n  // Status and messages\n  loading,\n  success,\n  error,\n  \n  // Constants\n  mealTypes,\n  pyodideStatus,\n  \n  // Other props\n  foodLog,\n  MicronutrientRadarChart\n}) => {\n  return (\n    <div className=\"food-form-section\">\n      <div className=\"food-form-left\">\n        {/* Edit Mode Indicator */}\n        {editingEntry && (\n          <div className=\"edit-mode-banner\">\n            <div className=\"edit-indicator\">\n              <span className=\"edit-icon\"></span>\n              <span className=\"edit-text\">\n                <strong>Editing:</strong> {editingEntry.name}\n              </span>\n            </div>\n            <button \n              className=\"cancel-edit-btn\"\n              onClick={handleCancelEdit}\n              type=\"button\"\n            >\n              Cancel Edit\n            </button>\n          </div>\n        )}\n\n        {/* Long COVID Checkbox */}\n        <div className=\"form-group long-covid-checkbox-group\">\n          <label className=\"long-covid-checkbox-label\">\n            <input \n              type=\"checkbox\" \n              checked={longCovidAdjust} \n              onChange={e => setLongCovidAdjust(e.target.checked)} \n              className=\"long-covid-checkbox\"\n            /> \n            <span className=\"checkbox-text\">\n              I have Long COVID - Show food recommendations and adjustments\n            </span>\n          </label>\n          {longCovidAdjust && (\n            <div className=\"long-covid-info-banner\">\n              <p> <strong>Long COVID Mode:</strong> Food recommendations will be adjusted to focus on anti-inflammatory options that may help manage symptoms and support recovery.</p>\n            </div>\n          )}\n        </div>\n\n        {renderSearchInput()}\n\n        {/* Nutrition fields with serving suggestions */}\n        {selectedMeal && (\n          <ServingSuggestions \n            selectedMeal={selectedMeal}\n            onServingSelect={handleServingSelection}\n            currentServing={fields.serving}\n            currentUnit={fields.servingUnit || 'g'}\n          />\n        )}\n\n        <div className=\"form-row\">\n          <div className=\"form-group\">\n            <input \n              name=\"protein\" \n              value={fields.protein || ''} \n              onChange={handleFieldChange} \n              type=\"number\"\n              step=\"0.1\"\n              placeholder=\" \"\n              readOnly={selectedMeal}\n            />\n            <label>Protein (g)</label>\n          </div>\n          <div className=\"form-group\">\n            <input \n              name=\"carbs\" \n              value={fields.carbs || ''} \n              onChange={handleFieldChange} \n              type=\"number\"\n              step=\"0.1\"\n              placeholder=\" \"\n              readOnly={selectedMeal}\n            />\n            <label>Carbs (g)</label>\n          </div>\n          <div className=\"form-group\">\n            <input \n              name=\"fat\" \n              value={fields.fat || ''} \n              onChange={handleFieldChange} \n              type=\"number\"\n              step=\"0.1\"\n              placeholder=\" \"\n              readOnly={selectedMeal}\n            />\n            <label>Fat (g)</label>\n          </div>\n          <div className=\"form-group\">\n            <input \n              name=\"serving\" \n              value={fields.serving || ''} \n              onChange={handleFieldChange}\n              type=\"number\"\n              step=\"1\"\n              className=\"serving-input\"\n              placeholder=\" \"\n            />\n            <label>Serving (g)</label>\n          </div>\n        </div>\n\n        {/* Meal details */}\n        <div className=\"form-row\">\n          <div className=\"form-group\">\n            <label htmlFor=\"meal-type\">Meal Type</label>\n            <select \n              id=\"meal-type\" \n              value={mealType} \n              onChange={e => setMealType(e.target.value)}\n            >\n              {mealTypes.map(type => (\n                <option key={type} value={type}>{type}</option>\n              ))}\n            </select>\n          </div>\n          <div className=\"form-group\">\n            <input \n              type=\"time\" \n              value={convertTo24Hour(time)} \n              onChange={handleTimeChange}\n              placeholder=\" \"\n            />\n            <label>Time</label>\n          </div>\n          <div className=\"form-group\">\n            <input \n              type=\"date\" \n              value={date} \n              onChange={e => setDate(e.target.value)}\n              placeholder=\" \"\n            />\n            <label>Date</label>\n          </div>\n        </div>\n\n        {/* Calories field */}\n        <div className=\"form-group\">\n          <input \n            name=\"calories\" \n            value={fields.calories || ''} \n            onChange={handleFieldChange} \n            type=\"number\"\n            step=\"1\"\n            placeholder=\" \"\n          />\n          <label>Calories</label>\n        </div>\n\n        <div className=\"form-group\">\n          <button \n            className={`submit-button ${editingEntry ? 'update-mode' : ''}`}\n            onClick={handleLogFood}\n            disabled={loading || !fields.name}\n          >\n            {loading ? \n              (editingEntry ? 'Updating...' : 'Logging...') : \n              (editingEntry ? 'Update Food' : 'Log Food')\n            }\n          </button>\n          {success && <div className=\"success-message\">{success}</div>}\n          {error && <div className=\"error-message\">{error}</div>}\n        </div>\n      </div>\n\n      <div className=\"food-form-right\">\n        {longCovidAdjust && (\n          <LongCovidSidePanel \n            selectedFood={fields.name} \n            selectedMeal={selectedMeal}\n            foodLog={foodLog}\n            isSearching={search.length >= 2 && !selectedMeal}\n            searchTerm={search}\n          />\n        )}\n\n        {/* Micronutrient Radar Chart */}\n        {selectedMeal && fields.micronutrients && Object.keys(fields.micronutrients).length > 0 && (\n          <MicronutrientRadarChart \n            micronutrients={fields.micronutrients}\n            selectedMeal={selectedMeal}\n          />\n        )}\n\n        {!longCovidAdjust && (\n          <div className=\"general-nutrition-info\">\n            <h3> Nutrition Tips</h3>\n            <p>Enable Long COVID mode above to get personalized food recommendations and anti-inflammatory guidance.</p>\n            {pyodideStatus === 'ready' && (\n              <div className=\"ai-tip\">\n                <p> <strong>AI Tip:</strong> The search above uses machine learning to find the most relevant foods for your queries!</p>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default AddFoodTab;","import React from 'react';\n\n// Delete Confirmation Modal Component\nconst DeleteConfirmModal = ({ entryId, entryName, onConfirm, onCancel, deleteLoading }) => (\n  <div className=\"modal-overlay\">\n    <div className=\"delete-confirm-modal\">\n      <h3>Delete Food Entry</h3>\n      <p>Are you sure you want to delete this food entry?</p>\n      <div className=\"entry-preview\">\n        <strong>{entryName}</strong>\n      </div>\n      <p className=\"warning-text\">This action cannot be undone.</p>\n      <div className=\"modal-actions\">\n        <button \n          className=\"cancel-button\" \n          onClick={onCancel}\n          disabled={deleteLoading}\n        >\n          Cancel\n        </button>\n        <button \n          className=\"delete-button\" \n          onClick={() => onConfirm(entryId)}\n          disabled={deleteLoading}\n        >\n          {deleteLoading ? 'Deleting...' : 'Delete Entry'}\n        </button>\n      </div>\n    </div>\n  </div>\n);\n\nconst FoodJournalTab = ({\n  // Data\n  foodLog,\n  journalPage,\n  \n  // Loading and error states\n  logLoading,\n  journalError,\n  success,\n  \n  // Delete confirmation\n  deleteConfirmId,\n  setDeleteConfirmId,\n  deleteLoading,\n  handleDeleteEntry,\n  \n  // Actions\n  fetchFoodLog,\n  handleEditEntry,\n  \n  // Constants\n  ENTRIES_PER_PAGE,\n  \n  // Utility functions\n  formatDateHeader\n}) => {\n  \n  // Helper function to convert 12-hour time to 24-hour for sorting\n  const convertTo24HourForSort = (time12h) => {\n    if (!time12h) return '12:00';\n    \n    const [time, modifier] = time12h.split(' ');\n    if (!time || !modifier) return time12h;\n    \n    let [hours, minutes] = time.split(':');\n    let hour24 = parseInt(hours, 10);\n    \n    if (modifier.toUpperCase() === 'AM') {\n      if (hour24 === 12) hour24 = 0;\n    } else if (modifier.toUpperCase() === 'PM') {\n      if (hour24 !== 12) hour24 += 12;\n    }\n    \n    return `${hour24.toString().padStart(2, '0')}:${minutes}`;\n  };\n\n  // Calculate daily totals\n  const calculateDayTotals = (entries) => {\n    return entries.reduce((totals, entry) => {\n      totals.calories += (parseFloat(entry.calories) || 0);\n      totals.protein += (parseFloat(entry.protein) || 0);\n      totals.carbs += (parseFloat(entry.carbs) || 0);\n      totals.fat += (parseFloat(entry.fat) || 0);\n      totals.meals += 1;\n      return totals;\n    }, { calories: 0, protein: 0, carbs: 0, fat: 0, meals: 0 });\n  };\n\n  // Handle all snack types for badge display\n  const getMealBadge = (mealType) => {\n    switch(mealType) {\n      case 'Breakfast': return 'B';\n      case 'Morning Snack': return 'MS';\n      case 'Lunch': return 'L';\n      case 'Afternoon Snack': return 'AS';\n      case 'Dinner': return 'D';\n      case 'Late Night Snack': return 'LN';\n      case 'Snack': return 'S';\n      default: return mealType.charAt(0);\n    }\n  };\n\n  return (\n    <div className=\"food-journal-section\">\n      {/* Delete Confirmation Modal */}\n      {deleteConfirmId && (\n        <DeleteConfirmModal\n          entryId={deleteConfirmId}\n          entryName={foodLog.find(entry => entry.id === deleteConfirmId)?.name || 'Unknown'}\n          onConfirm={handleDeleteEntry}\n          onCancel={() => setDeleteConfirmId(null)}\n          deleteLoading={deleteLoading}\n        />\n      )}\n\n      <div className=\"journal-header\">\n        <h3>Your Food Journal</h3>\n        <button \n          className=\"refresh-button\"\n          onClick={() => fetchFoodLog(1)}\n          disabled={logLoading}\n        >\n          {logLoading ? 'Loading...' : 'Refresh'}\n        </button>\n      </div>\n      \n      {journalError && <div className=\"error-message\">{journalError}</div>}\n      {success && <div className=\"success-message\">{success}</div>}\n      \n      {logLoading && foodLog.length === 0 ? (\n        <div className=\"loading-indicator\">Loading your food journal...</div>\n      ) : foodLog.length === 0 ? (\n        <div className=\"empty-state\">\n          <p>No entries found in your food journal.</p>\n          <p>Start by adding a meal in the \"Add Food\" tab!</p>\n        </div>\n      ) : (\n        <>\n          <div className=\"journal-summary\">\n            <p>Showing {foodLog.length} meal entries</p>\n          </div>\n          \n          <div className=\"journal-table-container\">\n            {(() => {\n              // Sort entries using proper date comparison\n              const sortedEntries = [...foodLog].sort((a, b) => {\n                if (a.date !== b.date) {\n                  return b.date.localeCompare(a.date); // Works for YYYY-MM-DD format\n                }\n                \n                const timeA = convertTo24HourForSort(a.time);\n                const timeB = convertTo24HourForSort(b.time);\n                return timeA.localeCompare(timeB);\n              });\n              \n              // Group entries by date\n              const groupedEntries = {};\n              sortedEntries.forEach(entry => {\n                if (!groupedEntries[entry.date]) {\n                  groupedEntries[entry.date] = [];\n                }\n                groupedEntries[entry.date].push(entry);\n              });\n              \n              return (\n                <div className=\"journal-by-day\">\n                  {Object.entries(groupedEntries).map(([date, entries]) => {\n                    const dayTotals = calculateDayTotals(entries);\n                    \n                    return (\n                      <div key={date} className=\"day-group\">\n                        {/* Day Header */}\n                        <div className=\"day-header\">\n                          <div className=\"day-header-left\">\n                            <h4 className=\"day-title\">\n                              {formatDateHeader(date)}\n                            </h4>\n                            <span className=\"day-meal-count\">\n                              {dayTotals.meals} meal{dayTotals.meals !== 1 ? 's' : ''}\n                            </span>\n                          </div>\n                          <div className=\"day-totals\">\n                            <div className=\"day-total-item\">\n                              <span className=\"total-label\">Total:</span>\n                              <span className=\"total-value\">{Math.round(dayTotals.calories)} cal</span>\n                            </div>\n                            <div className=\"day-total-macros\">\n                              <span className=\"macro-total\">P: {dayTotals.protein.toFixed(1)}g</span>\n                              <span className=\"macro-total\">C: {dayTotals.carbs.toFixed(1)}g</span>\n                              <span className=\"macro-total\">F: {dayTotals.fat.toFixed(1)}g</span>\n                            </div>\n                          </div>\n                        </div>\n                        \n                        {/* Day's Meals Table */}\n                        <table className=\"food-log-table day-table\">\n                          <thead>\n                            <tr>\n                              <th className=\"time-col\">Time</th>\n                              <th className=\"meal-type-col\">Meal</th>\n                              <th className=\"food-col\">Food</th>\n                              <th className=\"serving-col\">Serving</th>\n                              <th className=\"macro-col\">P</th>\n                              <th className=\"macro-col\">C</th>\n                              <th className=\"macro-col\">F</th>\n                              <th className=\"calories-col\">Cal</th>\n                              <th className=\"efficiency-col\">Eff%</th>\n                              <th className=\"actions-col\">Actions</th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                            {entries.map((entry, index) => (\n                              <tr key={entry.id} className={`meal-row ${index === 0 ? 'first-meal' : ''}`}>\n                                <td className=\"time-cell\">\n                                  <span className=\"meal-time\">\n                                    {entry.time.replace(':00', '').replace(' ', '')}\n                                  </span>\n                                </td>\n                                <td className=\"meal-type-cell\">\n                                  <span className={`meal-badge ${(entry.mealType || 'unknown').trim().toLowerCase().replace(/\\s+/g, '-')}`}>\n                                    {getMealBadge(entry.mealType || 'Unknown')}\n                                  </span>\n                                </td>\n                                <td className=\"food-cell\" title={entry.name}>\n                                  <span className=\"food-name\">\n                                    {entry.name.length > 25 ? `${entry.name.substring(0, 25)}...` : entry.name}\n                                  </span>\n                                </td>\n                                <td className=\"serving-cell\">{entry.serving || '0'}g</td>\n                                <td className=\"macro-cell\">{typeof entry.protein === 'number' ? entry.protein.toFixed(1) : (entry.protein || '0')}</td>\n                                <td className=\"macro-cell\">{typeof entry.carbs === 'number' ? entry.carbs.toFixed(1) : (entry.carbs || '0')}</td>\n                                <td className=\"macro-cell\">{typeof entry.fat === 'number' ? entry.fat.toFixed(1) : (entry.fat || '0')}</td>\n                                <td className=\"calories-cell\">\n                                  <strong>{entry.calories || '0'}</strong>\n                                </td>\n                                <td className=\"efficiency-cell\">\n                                  <span className={`efficiency-badge ${\n                                    typeof entry.metabolicEfficiency === 'number' \n                                      ? entry.metabolicEfficiency >= 80 ? 'high' : \n                                        entry.metabolicEfficiency >= 60 ? 'medium' : 'low'\n                                      : 'unknown'\n                                  }`}>\n                                    {typeof entry.metabolicEfficiency === 'number' ? entry.metabolicEfficiency.toFixed(0) : 'N/A'}\n                                  </span>\n                                </td>\n                                <td className=\"actions-cell\">\n                                  <div className=\"action-buttons compact\">\n                                    <button\n                                      className=\"edit-btn compact\"\n                                      onClick={() => handleEditEntry(entry)}\n                                      title=\"Edit entry\"\n                                    >\n                                      \n                                    </button>\n                                    <button\n                                      className=\"delete-btn compact\"\n                                      onClick={() => setDeleteConfirmId(entry.id)}\n                                      title=\"Delete entry\"\n                                    >\n                                      \n                                    </button>\n                                  </div>\n                                </td>\n                              </tr>\n                            ))}\n                          </tbody>\n                        </table>\n                      </div>\n                    );\n                  })}\n                </div>\n              );\n            })()}\n          </div>\n          \n          {foodLog.length >= journalPage * ENTRIES_PER_PAGE && (\n            <div className=\"load-more-container\">\n              <button \n                className=\"load-more-button\"\n                onClick={() => fetchFoodLog(journalPage + 1)}\n                disabled={logLoading}\n              >\n                {logLoading ? 'Loading...' : 'Load More Entries'}\n              </button>\n            </div>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default FoodJournalTab;","// enhanced-efficiency-functions.js - Fixed with proper time sorting and chronological line positioning\nimport React, { useRef, useState, useEffect } from 'react';\nimport * as d3 from 'd3';\n\n// Long COVID Severity Factors\n// FIXED: Long COVID RDA Multipliers (for increased nutritional requirements)\nexport const getSeverityFactor = (severity) => {\n  // These factors represent INCREASED nutritional NEEDS due to COVID severity\n  const severityFactors = {\n    'mild': 1.2,        // 20% increase in RDA requirements\n    'moderate': 1.5,    // 50% increase in RDA requirements  \n    'severe': 1.8,      // 80% increase in RDA requirements\n    'very severe': 2.2  // 120% increase in RDA requirements\n  };\n  return severityFactors[severity?.toLowerCase()] || 1.0;\n};\n\n// NEW: Separate function for metabolic efficiency (where lower values make sense)\nexport const getMetabolicEfficiencyFactor = (severity) => {\n  const severityFactors = {\n    'mild': 0.95,       // Slightly reduced efficiency\n    'moderate': 0.85,   // Moderately reduced efficiency\n    'severe': 0.75,     // Significantly reduced efficiency\n    'very severe': 0.65 // Severely reduced efficiency\n  };\n  return severityFactors[severity?.toLowerCase()] || 0.85;\n};\n\n// UPDATED: Calculate Food Efficiency using the correct factor for efficiency + expanded snack types\nexport const calculateFoodEfficiency = (mealData, userProfile) => {\n  const timeStr = mealData.time;\n  const hourMatch = timeStr.match(/(\\d+):/);\n  const hour = hourMatch ? parseInt(hourMatch[1], 10) : 12;\n  const isPM = timeStr.toLowerCase().includes('pm');\n  \n  let hour24 = hour;\n  if (isPM && hour !== 12) hour24 += 12;\n  if (!isPM && hour === 12) hour24 = 0;\n  \n  // Macronutrient factors\n  const proteinFactor = (parseFloat(mealData.protein) || 0) * 0.2;\n  const carbFactor = (parseFloat(mealData.carbs) || 0) * 0.1;\n  const fatFactor = (parseFloat(mealData.fat) || 0) * 0.15;\n  \n  // Circadian rhythm factors\n  let timeFactor = 1.0;\n  if (hour24 < 6 || hour24 > 20) {\n    timeFactor = 0.7;\n  } else if (hour24 >= 7 && hour24 <= 10) {\n    timeFactor = 1.2;\n  } else if (hour24 >= 17 && hour24 <= 19) {\n    timeFactor = 0.9;\n  }\n  \n  // UPDATED: Expanded meal type factors including all snack types\n  const mealTypeFactors = {\n    'Breakfast': 1.3,\n    'Morning Snack': 0.9,      // Good mid-morning metabolism\n    'Lunch': 1.1,\n    'Afternoon Snack': 0.8,    // Decent afternoon metabolism\n    'Dinner': 0.9,\n    'Late Night Snack': 0.6   // Lower efficiency for late eating\n            // Keep original for backward compatibility\n  };\n  const mealTypeFactor = mealTypeFactors[mealData.mealType] || 1.0;\n  \n  // Base efficiency calculation\n  const macroBalance = Math.min(100, (proteinFactor + carbFactor + fatFactor) * 10);\n  let efficiency = macroBalance * timeFactor * mealTypeFactor;\n  \n  // Long COVID adjustments - FIXED to use metabolic efficiency factor\n  if (mealData.longCovidAdjust && userProfile?.hasLongCovid) {\n    const severityFactor = getMetabolicEfficiencyFactor(userProfile.longCovidSeverity); // CHANGED: Use metabolic efficiency factor\n    efficiency *= severityFactor;\n    \n    // Boost for beneficial foods\n    if (mealData.longCovidBenefits && mealData.longCovidBenefits.length > 0) {\n      efficiency *= 1.1;\n    }\n    \n    // Reduce for problematic foods\n    if (mealData.longCovidCautions && mealData.longCovidCautions.length > 0) {\n      efficiency *= 0.9;\n    }\n  }\n  \n  return Math.min(100, Math.max(0, efficiency));\n};\n\n// Micronutrient enhancement functions\nexport const estimateMicronutrientEnhancement = (micronutrients, severity) => {\n  const severityMultipliers = {\n    'mild': 1.2,\n    'moderate': 1.5,\n    'severe': 1.8,\n    'very severe': 2.0\n  };\n  \n  const multiplier = severityMultipliers[severity?.toLowerCase()] || 1.0;\n  const enhancedMicronutrients = {};\n  \n  // Key nutrients for Long COVID recovery\n  const keyNutrients = [\n    'vitamin_c', 'vitamin_d', 'zinc', 'selenium', 'vitamin_b6', \n    'vitamin_b12', 'folate', 'iron', 'magnesium'\n  ];\n  \n  Object.entries(micronutrients).forEach(([nutrient, data]) => {\n    if (keyNutrients.includes(nutrient)) {\n      enhancedMicronutrients[nutrient] = {\n        ...data,\n        recommendedValue: (data.value || 0) * multiplier,\n        isEnhanced: true,\n        reason: `Increased for Long COVID ${severity} severity`\n      };\n    } else {\n      enhancedMicronutrients[nutrient] = {\n        ...data,\n        recommendedValue: data.value || 0,\n        isEnhanced: false\n      };\n    }\n  });\n  \n  return enhancedMicronutrients;\n};\n\n// Standard micronutrient enhancement (non-Long COVID)\nexport const estimateStandardMicronutrientEnhancement = (micronutrients, userProfile) => {\n  const enhancedMicronutrients = {};\n  \n  Object.entries(micronutrients).forEach(([nutrient, data]) => {\n    let multiplier = 1.0;\n    \n    // Age-based adjustments\n    if (userProfile.age > 65) {\n      if (['vitamin_d', 'vitamin_b12', 'calcium'].includes(nutrient)) {\n        multiplier *= 1.2;\n      }\n    }\n    \n    // Gender-based adjustments\n    if (userProfile.gender === 'female') {\n      if (nutrient === 'iron') {\n        multiplier *= 2.25; // Women need more iron\n      }\n    }\n    \n    // Activity level adjustments\n    if (userProfile.activityLevel === 'high' || userProfile.activityLevel === 'very_high') {\n      if (['magnesium', 'iron', 'vitamin_b1', 'vitamin_b2'].includes(nutrient)) {\n        multiplier *= 1.3;\n      }\n    }\n    \n    enhancedMicronutrients[nutrient] = {\n      ...data,\n      recommendedValue: (data.value || 0) * multiplier,\n      isEnhanced: multiplier > 1.0,\n      reason: multiplier > 1.0 ? 'Adjusted for demographics and activity' : 'Standard recommendation'\n    };\n  });\n  \n  return enhancedMicronutrients;\n};\n\n// Fixed EnhancedEfficiencyChart with proper chronological line ordering\nexport const EnhancedEfficiencyChart = ({ data, userData }) => {\n  const chartRef = useRef(null);\n  const [processedData, setProcessedData] = useState([]);\n  \n  useEffect(() => {\n    if (!data || data.length === 0) return;\n    \n    // Process meals with enhanced efficiency calculations\n    const updatedData = data.map(meal => {\n      const efficiency = calculateFoodEfficiency(meal, userData);\n      return {\n        ...meal,\n        originalEfficiency: meal.efficiency || 80,\n        enhancedEfficiency: efficiency,\n        actualEnergy: meal.calories * (efficiency / 100),\n        wastedEnergy: meal.calories * ((100 - efficiency) / 100)\n      };\n    });\n    \n    setProcessedData(updatedData);\n  }, [data, userData]);\n  \n  useEffect(() => {\n    if (!chartRef.current || !processedData || processedData.length === 0) return;\n    \n\n    \n    // Clear previous chart\n    d3.select(chartRef.current).selectAll(\"*\").remove();\n    \n    // Set dimensions\n    const margin = { top: 60, right: 120, bottom: 140, left: 70 };\n    const width = 800 - margin.left - margin.right;\n    const height = 500 - margin.top - margin.bottom;\n    \n    // Create SVG\n    const svg = d3.select(chartRef.current)\n      .append(\"svg\")\n      .attr(\"width\", width + margin.left + margin.right)\n      .attr(\"height\", height + margin.top + margin.bottom)\n      .append(\"g\")\n      .attr(\"transform\", `translate(${margin.left},${margin.top})`);\n    \n    // Chart title\n    svg.append(\"text\")\n      .attr(\"x\", width / 2)\n      .attr(\"y\", -30)\n      .attr(\"text-anchor\", \"middle\")\n      .style(\"font-size\", \"18px\")\n      .style(\"font-weight\", \"bold\")\n      .text(\"Enhanced Metabolic Efficiency Chart\");\n      \n    // Chart subtitle\n    svg.append(\"text\")\n      .attr(\"x\", width / 2)\n      .attr(\"y\", -10)\n      .attr(\"text-anchor\", \"middle\")\n      .style(\"font-size\", \"14px\")\n      .style(\"font-style\", \"italic\")\n      .text(\"Optimized for Long COVID energy management\");\n    \n    // Filter data to only include the last week\n    const today = new Date();\n    const oneWeekAgo = new Date();\n    oneWeekAgo.setDate(today.getDate() - 7);\n    \n    const lastWeekData = processedData.filter(meal => {\n      try {\n        const mealDate = new Date(meal.date);\n        return mealDate >= oneWeekAgo;\n      } catch (err) {\n        console.warn('Error parsing date:', meal.date);\n        return false;\n      }\n    });\n    \n    // Generate an array of all days in the past week\n    const allDatesInRange = [];\n    for (let i = 6; i >= 0; i--) {\n      const date = new Date();\n      date.setDate(today.getDate() - i);\n      const formattedDate = date.toISOString().split('T')[0];\n      allDatesInRange.push(formattedDate);\n    }\n    \n    // Group data by date and meal type for bars\n    const combinedData = [];\n    const groupedByDate = d3.group(lastWeekData, d => d.date);\n    \n    const uniqueMealTypes = ['Breakfast', 'Morning Snack', 'Lunch', 'Afternoon Snack', 'Dinner', 'Late Night Snack'];\n    \n    allDatesInRange.forEach(date => {\n      const dateData = groupedByDate.get(date) || [];\n      \n      if (dateData.length > 0) {\n        const mealsByType = d3.group(dateData, d => d.mealType);\n      \n        // Process meal types in the correct order\n        uniqueMealTypes.forEach(mealType => {\n          const meals = mealsByType.get(mealType);\n          if (meals && meals.length > 0) {\n            const totalCalories = d3.sum(meals, d => d.calories);\n            const weightedEfficiency = meals.reduce((acc, meal) => {\n              return acc + (meal.enhancedEfficiency * meal.calories / totalCalories);\n            }, 0);\n            \n            const totalActualEnergy = d3.sum(meals, d => d.actualEnergy);\n            const totalWastedEnergy = totalCalories - totalActualEnergy;\n            \n            combinedData.push({\n              date: date,\n              mealType: mealType,\n              time: meals[0].time,\n              name: `${mealType} (${meals.length} items)`,\n              efficiency: Math.round(weightedEfficiency),\n              calories: totalCalories,\n              actualEnergy: totalActualEnergy,\n              wastedEnergy: totalWastedEnergy,\n              originalMeals: meals,\n              mealOrder: uniqueMealTypes.indexOf(mealType) // Add explicit order\n            });\n          }\n        });\n      }\n    });\n    \n    // Calculate scales\n    const xOuter = d3.scaleBand()\n      .domain(allDatesInRange)\n      .range([0, width])\n      .padding(0.2);\n    \n    const xInner = d3.scaleBand()\n      .domain(uniqueMealTypes)\n      .range([0, xOuter.bandwidth()])\n      .padding(0.1);\n    \n    const formatDate = date => {\n      const parts = date.split('-');\n      return `${parts[1]}/${parts[2]}`;\n    };\n    \n    const maxCalories = d3.max(combinedData, d => d.calories) || 1000;\n    const y = d3.scaleLinear()\n      .domain([0, maxCalories])\n      .range([height, 0]);\n\n    const yEff = d3.scaleLinear()\n      .domain([0, 100])\n      .range([height, 0]);\n\n    // Create axes\n    svg.append(\"g\")\n      .attr(\"transform\", `translate(0,${height})`)\n      .call(d3.axisBottom(xOuter).tickFormat(formatDate))\n      .selectAll(\"text\")\n      .style(\"text-anchor\", \"end\")\n      .attr(\"dx\", \"-.8em\")\n      .attr(\"dy\", \".15em\")\n      .attr(\"transform\", \"rotate(-45)\");\n\n    svg.append(\"g\")\n      .call(d3.axisLeft(y))\n      .append(\"text\")\n      .attr(\"transform\", \"rotate(-90)\")\n      .attr(\"y\", -50)\n      .attr(\"x\", -height / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .style(\"fill\", \"#000\")\n      .text(\"Calories\");\n\n    svg.append(\"g\")\n      .attr(\"transform\", `translate(${width}, 0)`)\n      .call(d3.axisRight(yEff))\n      .append(\"text\")\n      .attr(\"transform\", \"rotate(-90)\")\n      .attr(\"y\", 50)\n      .attr(\"x\", -height / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .style(\"fill\", \"#000\")\n      .text(\"Enhanced Efficiency (%)\");\n\n    // Color scheme for meal types\n    const mealColors = {\n      \"Breakfast\": \"#FF9F1C\",\n      \"Morning Snack\": \"#FFB84D\",\n      \"Lunch\": \"#2EC4B6\",\n      \"Afternoon Snack\": \"#4ECDC4\",\n      \"Dinner\": \"#E71D36\",\n      \"Late Night Snack\": \"#FF6B6B\"\n    };\n\n    // Create tooltip\n    const tooltip = d3.select(\"body\")\n      .append(\"div\")\n      .attr(\"class\", \"chart-tooltip\")\n      .style(\"position\", \"absolute\")\n      .style(\"visibility\", \"hidden\")\n      .style(\"background-color\", \"white\")\n      .style(\"border\", \"1px solid #ddd\")\n      .style(\"border-radius\", \"5px\")\n      .style(\"padding\", \"12px\")\n      .style(\"font-size\", \"14px\")\n      .style(\"box-shadow\", \"0 3px 14px rgba(0,0,0,0.25)\")\n      .style(\"z-index\", \"10\")\n      .style(\"max-width\", \"300px\");\n\n    // Add stacked bars\n    combinedData.forEach(meal => {\n      const mealColor = mealColors[meal.mealType] || \"#999999\";\n      const barX = xOuter(meal.date) + xInner(meal.mealType);\n      const barWidth = xInner.bandwidth();\n      \n      // Actual energy bar\n      svg.append(\"rect\")\n        .attr(\"class\", \"actual-energy-bar\")\n        .attr(\"x\", barX)\n        .attr(\"y\", y(meal.actualEnergy))\n        .attr(\"width\", barWidth)\n        .attr(\"height\", height - y(meal.actualEnergy))\n        .attr(\"fill\", mealColor)\n        .attr(\"opacity\", 0.9)\n        .attr(\"stroke\", \"#333\")\n        .attr(\"stroke-width\", 1)\n        .on(\"mouseover\", function(event) {\n          d3.select(this).attr(\"opacity\", 0.7);\n          tooltip\n            .style(\"visibility\", \"visible\")\n            .html(`\n              <div style=\"font-weight:bold;margin-bottom:10px;font-size:15px;\">${meal.date} - ${meal.mealType}</div>\n              <div style=\"margin-bottom:6px;\">Total Calories: ${Math.round(meal.calories)}</div>\n              <div style=\"margin-bottom:6px;\"><strong>Enhanced Efficiency: ${meal.efficiency}%</strong></div>\n              <div style=\"margin-bottom:6px;\">Usable Energy: ${Math.round(meal.actualEnergy)} cal</div>\n              <div style=\"margin-bottom:12px;\">Energy Lost: ${Math.round(meal.wastedEnergy)} cal</div>\n              <div style=\"font-weight:bold;margin-bottom:5px;\">Individual Items:</div>\n              <ul style=\"margin-top:0;padding-left:20px;\">\n                ${meal.originalMeals.map(item => `\n                  <li>${item.name} - ${item.calories} cal (${Math.round(item.enhancedEfficiency)}% efficient)</li>\n                `).join('')}\n              </ul>\n            `)\n            .style(\"left\", `${event.pageX + 15}px`)\n            .style(\"top\", `${event.pageY - 10}px`);\n        })\n        .on(\"mouseout\", function() {\n          d3.select(this).attr(\"opacity\", 0.9);\n          tooltip.style(\"visibility\", \"hidden\");\n        });\n      \n      // Potential energy bar (wasted energy)\n      svg.append(\"rect\")\n        .attr(\"class\", \"potential-energy-bar\")\n        .attr(\"x\", barX)\n        .attr(\"y\", y(meal.calories))\n        .attr(\"width\", barWidth)\n        .attr(\"height\", y(meal.actualEnergy) - y(meal.calories))\n        .attr(\"fill\", mealColor)\n        .attr(\"opacity\", 0.3)\n        .attr(\"stroke\", \"#333\")\n        .attr(\"stroke-width\", 1)\n        .attr(\"stroke-dasharray\", \"3,3\");\n    });\n\n    // FIXED: Create properly sorted chronological data for the efficiency line\n    if (combinedData.length > 0) {\n      // Sort meals chronologically: first by date, then by meal order\n      const chronologicalData = [...combinedData].sort((a, b) => {\n        // First sort by date\n        if (a.date !== b.date) return a.date.localeCompare(b.date);\n        \n        // Then sort by meal order (already assigned during data creation)\n        return a.mealOrder - b.mealOrder;\n      });\n      \n      console.log('Final chronological order:', chronologicalData.map(d => ({\n        date: d.date,\n        mealType: d.mealType,\n        mealOrder: d.mealOrder,\n        efficiency: d.efficiency\n      })));\n\n      // Calculate x positions for the line based on the actual bar positions\n      const lineData = chronologicalData.map((meal, index) => {\n        // Calculate the actual bar position (center of the bar)\n        const barX = xOuter(meal.date) + xInner(meal.mealType);\n        const barWidth = xInner.bandwidth();\n        const barCenterX = barX + (barWidth / 2);\n        \n        console.log(`Meal ${index}: ${meal.mealType} on ${meal.date} at x=${barCenterX}, efficiency=${meal.efficiency}`);\n        \n        return {\n          ...meal,\n          xPos: barCenterX,\n          chronologicalIndex: index\n        };\n      });\n\n      // Sort lineData by x position to ensure left-to-right flow\n      const sortedLineData = [...lineData].sort((a, b) => a.xPos - b.xPos);\n      \n      console.log('Line data sorted by x position:', sortedLineData.map(d => ({\n        mealType: d.mealType,\n        xPos: Math.round(d.xPos),\n        efficiency: d.efficiency\n      })));\n\n      // Create the efficiency line\n      const lineGenerator = d3.line()\n        .x(d => d.xPos)\n        .y(d => yEff(d.efficiency))\n        .defined(d => d.efficiency != null && !isNaN(d.efficiency))\n        .curve(d3.curveMonotoneX);\n      \n      svg.append(\"path\")\n        .datum(sortedLineData)  // Use sorted data\n        .attr(\"fill\", \"none\")\n        .attr(\"stroke\", \"#FF5733\")\n        .attr(\"stroke-width\", 3)\n        .attr(\"d\", lineGenerator);\n      \n      // Add efficiency points\n      svg.selectAll(\".efficiency-point\")\n        .data(sortedLineData)  // Use sorted data\n        .enter()\n        .append(\"circle\")\n        .attr(\"class\", \"efficiency-point\")\n        .attr(\"cx\", d => d.xPos)\n        .attr(\"cy\", d => yEff(d.efficiency))\n        .attr(\"r\", 5)\n        .attr(\"fill\", \"#FF5733\")\n        .attr(\"stroke\", \"#333\")\n        .attr(\"stroke-width\", 1)\n        .on(\"mouseover\", function(event, d) {\n          d3.select(this).attr(\"r\", 8);\n          tooltip\n            .style(\"visibility\", \"visible\")\n            .html(`\n              <div style=\"font-weight:bold;font-size:16px;\">${d.mealType} - ${d.time}</div>\n              <div style=\"font-weight:bold;font-size:14px;\">${d.date}</div>\n              <div>Enhanced Efficiency: <strong>${d.efficiency}%</strong></div>\n              <div style=\"margin-top:6px\">X Position: ${Math.round(d.xPos)}</div>\n            `)\n            .style(\"left\", `${event.pageX + 15}px`)\n            .style(\"top\", `${event.pageY - 10}px`);\n        })\n        .on(\"mouseout\", function() {\n          d3.select(this).attr(\"r\", 5);\n          tooltip.style(\"visibility\", \"hidden\");\n        });\n    }\n\n    // Add legend\n    const legendY = height + 80;\n    \n    // Efficiency line legend\n    svg.append(\"line\")\n      .attr(\"x1\", 10)\n      .attr(\"x2\", 40)\n      .attr(\"y1\", legendY)\n      .attr(\"y2\", legendY)\n      .attr(\"stroke\", \"#FF5733\")\n      .attr(\"stroke-width\", 3);\n    \n    svg.append(\"circle\")\n      .attr(\"cx\", 25)\n      .attr(\"cy\", legendY)\n      .attr(\"r\", 5)\n      .attr(\"fill\", \"#FF5733\")\n      .attr(\"stroke\", \"#333\")\n      .attr(\"stroke-width\", 1);\n    \n    svg.append(\"text\")\n      .attr(\"x\", 50)\n      .attr(\"y\", legendY + 4)\n      .style(\"font-size\", \"12px\")\n      .text(\"Efficiency (%)\");\n    \n    // Energy bars legend\n    const legendData = [\n      { label: \"Usable Energy\", color: \"#2EC4B6\", opacity: 0.9 },\n      { label: \"Energy Lost\", color: \"#2EC4B6\", opacity: 0.3 }\n    ];\n    \n    svg.selectAll(\".legend-rect\")\n      .data(legendData)\n      .enter()\n      .append(\"rect\")\n      .attr(\"x\", 200)\n      .attr(\"y\", (d, i) => legendY - 10 + i * 20)\n      .attr(\"width\", 15)\n      .attr(\"height\", 15)\n      .attr(\"fill\", d => d.color)\n      .attr(\"opacity\", d => d.opacity)\n      .attr(\"stroke\", \"#333\")\n      .attr(\"stroke-width\", 1);\n    \n    svg.selectAll(\".legend-text\")\n      .data(legendData)\n      .enter()\n      .append(\"text\")\n      .attr(\"x\", 225)\n      .attr(\"y\", (d, i) => legendY + 2 + i * 20)\n      .style(\"font-size\", \"12px\")\n      .text(d => d.label);\n    \n    // Meal type legend\n    const mealTypeData = Object.entries(mealColors).map(([type, color]) => ({ type, color }));\n    \n    svg.selectAll(\".meal-type-rect\")\n      .data(mealTypeData)\n      .enter()\n      .append(\"rect\")\n      .attr(\"x\", (d, i) => 400 + Math.floor(i/3) * 140)\n      .attr(\"y\", (d, i) => legendY - 10 + (i % 3) * 20)\n      .attr(\"width\", 15)\n      .attr(\"height\", 15)\n      .attr(\"fill\", d => d.color)\n      .attr(\"stroke\", \"#333\")\n      .attr(\"stroke-width\", 1);\n    \n    svg.selectAll(\".meal-type-text\")\n      .data(mealTypeData)\n      .enter()\n      .append(\"text\")\n      .attr(\"x\", (d, i) => 425 + Math.floor(i/3) * 140)\n      .attr(\"y\", (d, i) => legendY + 2 + (i % 3) * 20)\n      .style(\"font-size\", \"12px\")\n      .text(d => d.type);\n\n    // Cleanup function\n    return () => {\n      d3.select(\".chart-tooltip\").remove();\n    };\n  }, [chartRef, processedData, userData]);\n  \n  if (!processedData || processedData.length === 0) {\n    return (\n      <div className=\"chart-container\">\n        <div ref={chartRef} className=\"efficiency-chart\">\n          <div className=\"placeholder\">\n            <p>No meal data available for enhanced efficiency analysis.</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n  \n  return (\n    <div className=\"chart-container\">\n      <div ref={chartRef} className=\"efficiency-chart\" style={{ minHeight: '500px' }}></div>\n      <div className=\"chart-info\" style={{ marginTop: '20px', padding: '15px', backgroundColor: '#f8f9fa', borderRadius: '8px' }}>\n        <h4>Enhanced Metabolic Efficiency - Fixed Chronological Line</h4>\n        <p>\n          This chart now properly connects meals in chronological order. The efficiency line flows smoothly \n          from the earliest meal to the latest meal across all days, regardless of meal type.\n        </p>\n        <div style={{ marginTop: '10px' }}>\n          <strong>Key Fixes:</strong>\n          <ul style={{ marginTop: '5px', paddingLeft: '20px' }}>\n            <li>Meals are sorted chronologically by date and time before connecting</li>\n            <li>Line positions are calculated as smooth progression across chart width</li>\n            <li>No more jumping between different meal types on the same day</li>\n            <li>Hover tooltips show chronological order for verification</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n};","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport './MicronutrientChart.css';\nimport './FoodTrackerAnalysis.css';\n\n// Import enhanced efficiency functions\nimport { \n  calculateFoodEfficiency\n} from './enhanced-efficiency-functions';\n\n// FIXED: Use ONLY named imports for D3\nimport { \n  select, \n  scaleBand, \n  scaleLinear, \n  axisBottom, \n  axisLeft, \n  axisRight,\n  max,\n  sum,\n  group,\n  line,\n  curveMonotoneX\n} from 'd3';\n\n// FIXED: Utility functions to handle dates without timezone issues\nconst parseDate = (dateString) => {\n  const parts = dateString.split('-');\n  return new Date(parseInt(parts[0]), parseInt(parts[1]) - 1, parseInt(parts[2]));\n};\n\nconst formatDateForComparison = (date) => {\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const day = String(date.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n};\n\nconst isSameOrAfter = (dateString1, dateString2) => {\n  const date1 = parseDate(dateString1);\n  const date2 = parseDate(dateString2);\n  return date1 >= date2;\n};\n\n// FIXED: Enhanced nutrient key mapping function\nfunction normalizeNutrientKey(key) {\n  const keyMappings = {\n    // B-vitamins\n    'b1': 'vitamin_b1',\n    'B1': 'vitamin_b1',\n    'thiamine': 'vitamin_b1',\n    'thiamin': 'vitamin_b1',\n    \n    'b2': 'vitamin_b2',\n    'B2': 'vitamin_b2',\n    'riboflavin': 'vitamin_b2',\n    \n    'b3': 'vitamin_b3',\n    'B3': 'vitamin_b3',\n    'niacin': 'vitamin_b3',\n    \n    'b6': 'vitamin_b6',\n    'B6': 'vitamin_b6',\n    'pyridoxine': 'vitamin_b6',\n    \n    'b12': 'vitamin_b12',\n    'B12': 'vitamin_b12',\n    'cobalamin': 'vitamin_b12',\n    \n    // Other vitamins\n    'vit_a': 'vitamin_a',\n    'vitA': 'vitamin_a',\n    'retinol': 'vitamin_a',\n    \n    'vit_c': 'vitamin_c',\n    'vitC': 'vitamin_c',\n    'ascorbic_acid': 'vitamin_c',\n    \n    'vit_d': 'vitamin_d',\n    'vitD': 'vitamin_d',\n    'cholecalciferol': 'vitamin_d',\n    \n    'vit_e': 'vitamin_e',\n    'vitE': 'vitamin_e',\n    'tocopherol': 'vitamin_e',\n    \n    'vit_k': 'vitamin_k',\n    'vitK': 'vitamin_k',\n    \n    'folic_acid': 'folate',\n    'folicAcid': 'folate',\n    \n    // Minerals - normalize to lowercase\n    'Iron': 'iron',\n    'Calcium': 'calcium',\n    'Magnesium': 'magnesium',\n    'Zinc': 'zinc',\n    'Selenium': 'selenium',\n    'Copper': 'copper',\n    'Potassium': 'potassium',\n    'Phosphorus': 'phosphorus',\n    'Manganese': 'manganese'\n  };\n  \n  // First try direct mapping\n  if (keyMappings[key]) {\n    return keyMappings[key];\n  }\n  \n  // Convert to lowercase and try again\n  const lowerKey = key.toLowerCase();\n  if (keyMappings[lowerKey]) {\n    return keyMappings[lowerKey];\n  }\n  \n  // Return normalized version (lowercase with underscores)\n  return lowerKey.replace(/[^a-z0-9]/g, '_').replace(/_+/g, '_').replace(/^_|_$/g, '');\n}\n\n// FIXED: Enhanced ensureCompleteNutrientData function with better unit handling\nfunction ensureCompleteNutrientData(intakeData, baseRDAData) {\n  console.log('=== FIXED ensureCompleteNutrientData ===');\n  console.log('Input intakeData:', intakeData);\n  \n  const completeIntakeData = {};\n\n  // Iterate over all nutrients defined in baseRDAData\n  for (const nutrientKey in baseRDAData) {\n    if (!baseRDAData.hasOwnProperty(nutrientKey)) continue;\n    \n    const rdaInfo = baseRDAData[nutrientKey];\n    \n    if (!rdaInfo || rdaInfo.value === undefined || !rdaInfo.unit) {\n      console.warn(`Invalid RDA data for ${nutrientKey}:`, rdaInfo);\n      continue;\n    }\n\n    // Check if this nutrient exists in the user's intake data\n    if (intakeData && intakeData[nutrientKey] !== undefined) {\n      const intakeValue = intakeData[nutrientKey];\n\n      // Case 1: Already proper object format { value: X, unit: Y }\n      if (typeof intakeValue === 'object' && intakeValue !== null && \n          intakeValue.value !== undefined && intakeValue.unit !== undefined) {\n        \n        let finalValue = parseFloat(intakeValue.value) || 0;\n        let finalUnit = intakeValue.unit;\n        \n        // FIXED: Handle unit conversions more carefully\n        if (finalUnit !== rdaInfo.unit) {\n          // Convert common unit mismatches\n          if (finalUnit === 'mcg' && rdaInfo.unit === 'mg') {\n            finalValue = finalValue / 1000;\n            finalUnit = 'mg';\n          } else if (finalUnit === 'mg' && rdaInfo.unit === 'mcg') {\n            finalValue = finalValue * 1000;\n            finalUnit = 'mcg';\n          } else if (finalUnit === 'g' && rdaInfo.unit === 'mg') {\n            finalValue = finalValue * 1000;\n            finalUnit = 'mg';\n          }\n          // ADD THIS: IU to mcg conversion for vitamin A\n          else if (finalUnit === 'IU' && nutrientKey === 'vitamin_a' && rdaInfo.unit === 'mcg') {\n            finalValue = finalValue * 0.3; // 1 IU  0.3 mcg RAE for vitamin A\n            finalUnit = 'mcg';\n          }\n          // ADD THIS: IU to mcg conversion for vitamin D  \n          else if (finalUnit === 'IU' && nutrientKey === 'vitamin_d' && rdaInfo.unit === 'mcg') {\n            finalValue = finalValue * 0.025; // 1 IU = 0.025 mcg for vitamin D\n            finalUnit = 'mcg';\n          }\n          \n          console.log(`Converted ${nutrientKey}: ${intakeValue.value} ${intakeValue.unit}  ${finalValue} ${finalUnit}`);\n        }\n        \n        completeIntakeData[nutrientKey] = {\n          value: finalValue,\n          unit: finalUnit\n        };\n      }\n      // Case 2: Just a number (assume RDA unit)\n      else if (typeof intakeValue === 'number') {\n        completeIntakeData[nutrientKey] = {\n          value: intakeValue,\n          unit: rdaInfo.unit\n        };\n      }\n      // Case 3: String number\n      else if (typeof intakeValue === 'string') {\n        const numValue = parseFloat(intakeValue) || 0;\n        completeIntakeData[nutrientKey] = {\n          value: numValue,\n          unit: rdaInfo.unit\n        };\n      }\n      // Case 4: Unexpected format\n      else {\n        console.warn(`Unexpected intake format for ${nutrientKey}:`, intakeValue);\n        completeIntakeData[nutrientKey] = {\n          value: 0,\n          unit: rdaInfo.unit\n        };\n      }\n    } else {\n      // Nutrient not found in intake data\n      completeIntakeData[nutrientKey] = {\n        value: 0,\n        unit: rdaInfo.unit\n      };\n    }\n  }\n  \n  console.log('Output completeIntakeData:', completeIntakeData);\n  console.log('=== END FIXED ensureCompleteNutrientData ===\\n');\n  \n  return completeIntakeData;\n}\n\n// FIXED: Updated baseRDAData with more nutrients including potassium\nconst baseRDAData10 = {\n  vitamin_a: {\n    value: 900,\n    unit: 'mcg',\n    femaleAdjust: 0.78,\n    description: \"Supports vision, immune function, and cell growth\"\n  },\n  vitamin_c: {\n    value: 90,\n    unit: 'mg',\n    femaleAdjust: 0.83,\n    description: \"Antioxidant that supports immune function and collagen production\"\n  },\n  vitamin_d: {\n    value: 15,\n    unit: 'mcg',\n    femaleAdjust: 1.0,\n    description: \"Crucial for calcium absorption and bone health\"\n  },\n  vitamin_e: {\n    value: 15,\n    unit: 'mg',\n    femaleAdjust: 1.0,\n    description: \"Antioxidant that protects cells from damage\"\n  },\n  vitamin_k: {\n    value: 120,\n    unit: 'mcg',\n    femaleAdjust: 0.75,\n    description: \"Essential for blood clotting and bone health\"\n  },\n  vitamin_b6: {\n    value: 1.3,\n    unit: 'mg',\n    femaleAdjust: 1.0,\n    description: \"Important for metabolism and brain development\"\n  },\n  vitamin_b12: {\n    value: 2.4,\n    unit: 'mcg',\n    femaleAdjust: 1.0,\n    description: \"Essential for nerve function and blood cell formation\"\n  },\n  folate: {\n    value: 400,\n    unit: 'mcg',\n    femaleAdjust: 1.0,\n    description: \"Critical for cell division and DNA synthesis\"\n  },\n  iron: {\n    value: 8,\n    unit: 'mg',\n    femaleAdjust: 2.25,\n    description: \"Essential for oxygen transport in the blood\"\n  },\n  calcium: {\n    value: 1000,\n    unit: 'mg',\n    femaleAdjust: 1.0,\n    description: \"Critical for bone health and muscle function\"\n  },\n  magnesium: {\n    value: 420,\n    unit: 'mg',\n    femaleAdjust: 0.76,\n    description: \"Involved in over 300 biochemical reactions in the body\"\n  },\n  zinc: {\n    value: 11,\n    unit: 'mg',\n    femaleAdjust: 0.73,\n    description: \"Important for immune function and wound healing\"\n  },\n  selenium: {\n    value: 55,\n    unit: 'mcg',\n    femaleAdjust: 1.0,\n    description: \"Antioxidant that helps protect cells from damage\"\n  },\n  copper: {\n    value: 0.9,\n    unit: 'mg',\n    femaleAdjust: 1.0,\n    description: \"Important for red blood cell formation and nerve function\"\n  },\n  potassium: {\n    value: 3500,\n    unit: 'mg',\n    femaleAdjust: 0.86,\n    description: \"Essential for heart function and blood pressure regulation\"\n  },\n  phosphorus: {\n    value: 700,\n    unit: 'mg',\n    femaleAdjust: 1.0,\n    description: \"Important for bone and teeth formation and energy storage\"\n  },\n  vitamin_b1: {\n    value: 1.2,\n    unit: 'mg',\n    femaleAdjust: 0.92,\n    description: \"Essential for energy metabolism\"\n  },\n  vitamin_b2: {\n    value: 1.3,\n    unit: 'mg',\n    femaleAdjust: 0.85,\n    description: \"Important for energy production and cell function\"\n  },\n  vitamin_b3: {\n    value: 16,\n    unit: 'mg',\n    femaleAdjust: 0.875,\n    description: \"Helps convert food into energy\"\n  },\n  manganese: {\n    value: 2.3,\n    unit: 'mg',\n    femaleAdjust: 0.78,\n    description: \"Important for bone development and wound healing\"\n  }\n};\n\n// MacronutrientChart component\nfunction MacronutrientChart({ userData, userIntake = {} }) {\n  const chartRef = useRef(null);\n  const [personalizedRDA, setPersonalizedRDA] = useState(null);\n\n  const calculatePersonalizedRDA = useCallback((userData) => {\n    const calculateBMI = (weight, height) => {\n      if (!weight || !height) return null;\n      return weight / Math.pow(height / 100, 2);\n    };\n    \n    const calculateTDEE = (userData) => {\n      const { age, gender, weight, height, activity_level } = userData;\n      \n      if (!age || !weight || !height) {\n        return 2000;\n      }\n      \n      let bmr;\n      if (gender === 'female') {\n        bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;\n      } else {\n        bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;\n      }\n      \n      const activityFactors = {\n        'sedentary': 1.2,\n        'light': 1.375,\n        'moderate': 1.55,\n        'very': 1.725,\n        'extreme': 1.9\n      };\n      \n      const activityMultiplier = activityFactors[activity_level] || 1.375;\n      let tdee = bmr * activityMultiplier;\n      \n      if (userData.covid_condition) {\n        tdee *= 1.07;\n      }\n      \n      const bmi = calculateBMI(weight, height);\n      if (bmi) {\n        if (bmi < 18.5) {\n          tdee *= 1.1;\n        } else if (bmi > 30) {\n          tdee *= 0.9;\n        }\n      }\n      \n      return Math.round(tdee);\n    };\n    \n    const calculateMacroDistribution = (totalCalories, userData) => {\n      if (!totalCalories) return null;\n      \n      let proteinPct = 0.25;\n      let carbsPct = 0.45;\n      let fatPct = 0.3;\n      \n      if (userData.covid_condition) {\n        proteinPct = 0.30;\n        carbsPct = 0.40;\n        fatPct = 0.30;\n      }\n      \n      const bmi = calculateBMI(userData.weight, userData.height);\n      if (bmi && bmi < 18.5) {\n        fatPct = 0.35;\n        carbsPct = 0.45;\n        proteinPct = 0.20;\n      }\n      \n      if (bmi && bmi > 30) {\n        proteinPct = 0.35;\n        carbsPct = 0.35;\n        fatPct = 0.30;\n      }\n      \n      if (userData.age > 65) {\n        proteinPct = Math.min(proteinPct + 0.05, 0.40);\n        const remaining = 1.0 - proteinPct;\n        carbsPct = remaining * (carbsPct / (carbsPct + fatPct));\n        fatPct = remaining * (fatPct / (carbsPct + fatPct));\n      }\n      \n      return {\n        protein: proteinPct,\n        carbs: carbsPct,\n        fat: fatPct\n      };\n    };\n\n    const totalCalories = calculateTDEE(userData);\n    const macroDistribution = calculateMacroDistribution(totalCalories, userData);\n    \n    const protein = (totalCalories * macroDistribution.protein / 4).toFixed(1);\n    const carbs = (totalCalories * macroDistribution.carbs / 4).toFixed(1);\n    const fat = (totalCalories * macroDistribution.fat / 9).toFixed(1);\n    \n    const covidNotes = {\n      protein: 'Increased to support immune function and tissue repair',\n      carbs: 'Focus on complex carbs with anti-inflammatory properties',\n      fat: 'Higher proportion of omega-3s recommended to reduce inflammation'\n    };\n    \n    return {\n      protein: { \n        value: parseFloat(protein),\n        covidNote: userData.covid_condition ? covidNotes.protein : null\n      },\n      carbs: { \n        value: parseFloat(carbs),\n        covidNote: userData.covid_condition ? covidNotes.carbs : null\n      },\n      fat: { \n        value: parseFloat(fat),\n        covidNote: userData.covid_condition ? covidNotes.fat : null\n      },\n      calories: {\n        value: totalCalories\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (userData) {\n      const rda = calculatePersonalizedRDA(userData);\n      setPersonalizedRDA(rda);\n    }\n  }, [userData, calculatePersonalizedRDA]);\n\n  useEffect(() => {\n    if (!chartRef.current || !personalizedRDA || !userIntake) return;\n    \n    try {\n      select(chartRef.current).selectAll(\"*\").remove();\n  \n      const margin = { top: 40, right: 180, bottom: 60, left: 70 };\n      const width = 700 - margin.left - margin.right;\n      const height = 350 - margin.top - margin.bottom;\n      \n      const svg = select(chartRef.current)\n        .append(\"svg\")\n        .attr(\"width\", width + margin.left + margin.right)\n        .attr(\"height\", height + margin.top + margin.bottom)\n        .append(\"g\")\n        .attr(\"transform\", `translate(${margin.left},${margin.top})`);\n        \n      const macros = ['protein', 'carbs', 'fat'];\n      const data = [\n        { name: \"Current Intake\", ...userIntake },\n        { name: \"Recommended\", \n          protein: personalizedRDA.protein.value,\n          carbs: personalizedRDA.carbs.value,\n          fat: personalizedRDA.fat.value\n        }\n      ];\n      \n      const colors = {\n        protein: \"#22c55e\",\n        carbs: \"#3b82f6\",\n        fat: \"#f59e0b\"\n      };\n      \n      const x = scaleBand()\n        .domain(data.map(d => d.name))\n        .range([0, width])\n        .padding(0.3);\n      \n      const maxValue = max(data, d => {\n        return d.protein + d.carbs + d.fat;\n      });\n      \n      const y = scaleLinear()\n        .domain([0, maxValue * 1.1])\n        .range([height, 0]);\n      \n      svg.append(\"g\")\n        .attr(\"transform\", `translate(0,${height})`)\n        .call(axisBottom(x))\n        .selectAll(\"text\")\n        .attr(\"font-size\", \"12px\")\n        .attr(\"font-weight\", d => d === \"Recommended\" ? \"bold\" : \"normal\");\n      \n      svg.append(\"g\")\n        .call(axisLeft(y).ticks(5))\n        .selectAll(\"text\")\n        .attr(\"font-size\", \"12px\");\n      \n      svg.append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"y\", -margin.left + 20)\n        .attr(\"x\", -height / 2)\n        .attr(\"font-size\", \"14px\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"fill\", \"#666\")\n        .text(\"Grams\");\n      \n      const currentDate = new Date();\n      const formattedDate = currentDate.toLocaleDateString('en-US', {\n        month: 'short',\n        day: 'numeric',\n        year: 'numeric'\n      });\n      \n      svg.append(\"text\")\n        .attr(\"x\", width / 2)\n        .attr(\"y\", -margin.top / 2)\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"font-size\", \"16px\")\n        .attr(\"font-weight\", \"bold\")\n        .attr(\"fill\", \"#333\")\n        .text(`Long COVID Macronutrient Analysis - ${formattedDate}`);\n      \n      data.forEach(d => {\n        let y0 = 0;\n        d.stackedData = macros.map(nutrient => {\n          return {\n            nutrient,\n            y0,\n            y1: y0 += (d[nutrient] || 0)\n          };\n        });\n      });\n      \n      const tooltip = select(\"body\")\n        .append(\"div\")\n        .attr(\"class\", \"d3-tooltip\")\n        .style(\"position\", \"absolute\")\n        .style(\"background-color\", \"white\")\n        .style(\"border\", \"1px solid #ddd\")\n        .style(\"border-radius\", \"4px\")\n        .style(\"padding\", \"8px\")\n        .style(\"font-size\", \"12px\")\n        .style(\"pointer-events\", \"none\")\n        .style(\"opacity\", 0)\n        .style(\"box-shadow\", \"0 2px 4px rgba(0,0,0,0.1)\")\n        .style(\"z-index\", 100);\n      \n      const groups = svg.selectAll(\".bar-group\")\n        .data(data)\n        .join(\"g\")\n        .attr(\"class\", \"bar-group\")\n        .attr(\"transform\", d => `translate(${x(d.name)},0)`);\n      \n      groups.selectAll(\"rect\")\n        .data(d => d.stackedData)\n        .join(\"rect\")\n        .attr(\"width\", x.bandwidth())\n        .attr(\"y\", d => y(d.y1))\n        .attr(\"height\", d => y(d.y0) - y(d.y1))\n        .attr(\"fill\", d => colors[d.nutrient])\n        .attr(\"stroke\", \"white\")\n        .attr(\"stroke-width\", 1)\n        .on(\"mouseover\", function(event, d) {\n          const parentData = select(this.parentNode).datum();\n          const amount = parentData[d.nutrient].toFixed(1);\n          const percentage = ((parentData[d.nutrient] / (parentData.protein + parentData.carbs + parentData.fat)) * 100).toFixed(1);\n          \n          const caloriesPerGram = d.nutrient === 'fat' ? 9 : 4;\n          const calories = (parentData[d.nutrient] * caloriesPerGram).toFixed(0);\n          \n          const covidNote = parentData.name === \"Recommended\" && \n                          personalizedRDA[d.nutrient].covidNote ? \n                          `<br><span style=\"color:#6366f1;font-style:italic\">${personalizedRDA[d.nutrient].covidNote}</span>` : '';\n          \n          tooltip\n            .style(\"opacity\", 1)\n            .html(`\n              <div style=\"font-weight:bold;text-transform:capitalize;color:${colors[d.nutrient]}\">${d.nutrient}</div>\n              <div style=\"margin:4px 0\">\n                <b>Amount:</b> ${amount}g\n                <br><b>Percentage:</b> ${percentage}%\n                <br><b>Calories:</b> ${calories} kcal\n                ${covidNote}\n              </div>\n            `)\n            .style(\"left\", (event.pageX + 10) + \"px\")\n            .style(\"top\", (event.pageY - 28) + \"px\");\n            \n          select(this)\n            .attr(\"stroke\", \"#333\")\n            .attr(\"stroke-width\", 2);\n        })\n        .on(\"mouseout\", function() {\n          tooltip.style(\"opacity\", 0);\n          select(this)\n            .attr(\"stroke\", \"white\")\n            .attr(\"stroke-width\", 1);\n        });\n      \n      const legend = svg.append(\"g\")\n        .attr(\"class\", \"legend\")\n        .attr(\"transform\", `translate(${width + 20}, 0)`);\n      \n      macros.forEach((nutrient, i) => {\n        const legendRow = legend.append(\"g\")\n          .attr(\"transform\", `translate(0, ${i * 25})`);\n          \n        legendRow.append(\"rect\")\n          .attr(\"width\", 15)\n          .attr(\"height\", 15)\n          .attr(\"fill\", colors[nutrient]);\n          \n        legendRow.append(\"text\")\n          .attr(\"x\", 24)\n          .attr(\"y\", 12)\n          .attr(\"text-anchor\", \"start\")\n          .style(\"text-transform\", \"capitalize\")\n          .style(\"font-size\", \"14px\")\n          .text(nutrient);\n      });\n      \n      if (userData?.covid_condition) {\n        svg.append(\"text\")\n          .attr(\"x\", width / 2)\n          .attr(\"y\", height + 40)\n          .attr(\"text-anchor\", \"middle\")\n          .attr(\"font-size\", \"12px\")\n          .attr(\"font-style\", \"italic\")\n          .attr(\"fill\", \"#6366f1\")\n          .text(\"Note: RDA values adjusted for Long COVID recovery needs\");\n      }\n      \n      const calculateCalories = (data) => {\n        return (data.protein * 4 + data.carbs * 4 + data.fat * 9).toFixed(0);\n      };\n      \n      const calorieInfo = svg.append(\"g\")\n        .attr(\"class\", \"calorie-info\")\n        .attr(\"transform\", `translate(${width + 20}, ${macros.length * 25 + 20})`);\n        \n      calorieInfo.append(\"text\")\n        .attr(\"font-size\", \"14px\")\n        .attr(\"font-weight\", \"bold\")\n        .text(\"Total Calories:\");\n        \n      calorieInfo.append(\"text\")\n        .attr(\"y\", 25)\n        .attr(\"font-size\", \"14px\")\n        .text(`Intake: ${calculateCalories(userIntake)} kcal`);\n        \n      calorieInfo.append(\"text\")\n        .attr(\"y\", 50)\n        .attr(\"font-size\", \"14px\")\n        .text(`Recommended: ${personalizedRDA.calories.value.toFixed(0)} kcal`);\n      \n      return () => {\n        select(\".d3-tooltip\").remove();\n      };\n    } catch (error) {\n      console.error('Error rendering MacronutrientChart:', error);\n    }\n  }, [chartRef, personalizedRDA, userIntake, userData]);\n\n  return (\n    <div className=\"w-full\">\n      <div \n        ref={chartRef} \n        className=\"macro-chart mx-auto overflow-visible\"\n        style={{ minHeight: \"350px\" }}\n      ></div>\n    </div>\n  );\n}\n\n// BulletChart component\nconst BulletChart = ({ data, maxPercent }) => {\n  const actualWidth = Math.min(100, (data.rawValue / data.rda) * 100);\n  const displayPercentage = Math.round((data.rawValue / data.rda) * 100);\n  const optimalWidth = Math.min(100, 100);\n\n  const getColor = (percent) => {\n    if (percent >= 100) return \"#4CAF50\";\n    if (percent >= 70) return \"#8BC34A\";\n    if (percent >= 50) return \"#FFC107\";\n    if (percent >= 30) return \"#FF9800\";\n    return \"#F44336\";\n  };\n\n  const barColor = getColor(actualWidth);\n\n  return (\n    <div className=\"bullet-chart\">\n      <div className=\"bullet-chart-header\">\n        <div className=\"bullet-chart-title\">\n          <span className=\"nutrient-name\">{data.name}</span>\n          {data.isAdjusted && (\n            <span className=\"adjusted-badge\">\n              Adjusted\n            </span>\n          )}\n        </div>\n        <div className=\"bullet-chart-values\">\n          {data.rawValue.toFixed(2)} / {data.rda} {data.unit}\n          <span className=\"bullet-chart-percentage\" style={{ color: barColor }}>\n            ({displayPercentage}%)\n          </span>\n        </div>\n      </div>\n      \n      <div className=\"bullet-chart-track\">\n        <div \n          className=\"threshold-marker\"\n          style={{ left: '70%' }}\n        ></div>\n        \n        <div \n          className=\"actual-value-bar\"\n          style={{ \n            width: `${actualWidth}%`, \n            backgroundColor: barColor \n          }}\n        ></div>\n        \n        <div \n          className=\"target-line\"\n          style={{ left: `${optimalWidth}%` }}\n        ></div>\n      </div>\n    </div>\n  );\n};\n\n// FIXED: Complete MicronutrientChart component\nfunction MicronutrientChart({ data, userData }) {\n  const [userInfo, setUserInfo] = useState(userData || {});\n  const [chartData, setChartData] = useState([]);\n  const [allChartData, setAllChartData] = useState([]);\n  const [nutrientIntake] = useState(data && Object.keys(data).length > 0 ? ensureCompleteNutrientData(data, baseRDAData10) : {});\n  const [, setPersonalizedRDA] = useState({});\n  const [displayMode, setDisplayMode] = useState('all');\n  const [isLoading, setIsLoading] = useState(true);\n  const [selectedCategory, setSelectedCategory] = useState('all');\n\n  const getSeverityFactor = useCallback((severity) => {\n    switch (severity?.toLowerCase()) {\n      case 'mild': return 1.1;\n      case 'moderate': return 1.3;\n      case 'severe': return 1.5;\n      case 'very severe': return 1.8;\n      default: return 1.0;\n    }\n  }, []);\n\n  const processNutrientData = useCallback((intakeData, rdaData) => {\n    console.log('=== FIXED processNutrientData ===');\n    console.log('Processing', Object.keys(rdaData).length, 'nutrients');\n    \n    const processedNutrients = [];\n\n    for (const nutrientKey in rdaData) {\n      if (!rdaData.hasOwnProperty(nutrientKey)) continue;\n      \n      const rdaInfo = rdaData[nutrientKey];\n      \n      if (!rdaInfo || rdaInfo.value === undefined || !rdaInfo.unit) {\n        console.warn(`Skipping ${nutrientKey}: Invalid RDA info`, rdaInfo);\n        continue;\n      }\n\n      const intakeDetails = intakeData[nutrientKey];\n      let intakeValue = 0;\n      \n      if (intakeDetails && typeof intakeDetails === 'object' && intakeDetails.value !== undefined) {\n        intakeValue = parseFloat(intakeDetails.value) || 0;\n      }\n      console.log(\"intakeValue\", intakeValue);\n      const percentOfRDA = rdaInfo.value > 0 ? (intakeValue / rdaInfo.value) * 100 : 0;\n      \n      if (percentOfRDA > 10000) {\n        console.warn(`Extremely high percentage for ${nutrientKey}: ${percentOfRDA}% - possible unit error`);\n      }\n      \n      const formattedName = nutrientKey.replace(/_/g, ' ').replace(/\\b\\w/g, c => c.toUpperCase());\n      const category = nutrientKey.includes('vitamin') ? 'vitamins' : 'minerals';\n\n      const processedNutrient = {\n        key: nutrientKey,\n        name: formattedName,\n        value: parseFloat(percentOfRDA.toFixed(10)),\n        rawValue: intakeValue,\n        unit: rdaInfo.unit,\n        rda: rdaInfo.value,\n        rdaUnit: rdaInfo.unit,\n        isAdjustedRDA: rdaInfo.isAdjusted || false,\n        percentOfRDA: parseFloat(percentOfRDA.toFixed(10)),\n        category: category,\n      };\n      \n      console.log(`${formattedName}: ${intakeValue}${rdaInfo.unit} / ${rdaInfo.value}${rdaInfo.unit} = ${percentOfRDA.toFixed(1)}%`);\n      \n      processedNutrients.push(processedNutrient);\n    }\n\n    const sortedNutrients = processedNutrients.sort((a, b) => a.percentOfRDA - b.percentOfRDA);\n    \n    console.log('=== PROCESSING SUMMARY ===');\n    console.log('Total nutrients processed:', sortedNutrients.length);\n    console.log('Deficient (<70%):', sortedNutrients.filter(n => n.value < 70).length);\n    console.log('Optimal (100%):', sortedNutrients.filter(n => n.value >= 100).length);\n    \n    return sortedNutrients;\n  }, []);\n\n  const applyFilters = useCallback((dataToFilter) => {\n    let filteredData = [...dataToFilter];\n\n    if (selectedCategory !== 'all') {\n      filteredData = filteredData.filter(item => item.category === selectedCategory);\n    }\n    \n    if (displayMode === 'deficient') {\n      filteredData = filteredData.filter(item => item.value < 70);\n      filteredData.sort((a, b) => a.value - b.value);\n    } else if (displayMode === 'optimal') {\n      filteredData = filteredData.filter(item => item.value >= 100);\n      filteredData.sort((a, b) => b.value - a.value);\n    } else {\n      filteredData.sort((a, b) => a.value - b.value);\n    }\n\n    setChartData(filteredData);\n  }, [displayMode, selectedCategory]);\n\n  const calculatePersonalizedRDA = useCallback((baseRDAData_, userData) => {\n    if (!baseRDAData_ || Object.keys(baseRDAData_).length === 0) {\n      console.error('baseRDAData_ is empty or invalid!');\n      return {};\n    }\n\n    const personalRDA = JSON.parse(JSON.stringify(baseRDAData_));\n\n    Object.keys(personalRDA).forEach(nutrient => {\n      if (!personalRDA[nutrient] || typeof personalRDA[nutrient].value !== 'number') {\n        console.error(`Invalid data structure for ${nutrient}`);\n        personalRDA[nutrient] = { value: 0, unit: personalRDA[nutrient]?.unit || 'mg', isAdjusted: false };\n        return;\n      }\n\n      let adjustedValue = personalRDA[nutrient].value;\n\n      if (userData?.gender && userData.gender.toLowerCase() === 'female') {\n        const femaleAdjust = personalRDA[nutrient].femaleAdjust || 1.0;\n        adjustedValue *= femaleAdjust;\n      }\n\n      if (userData?.age) {\n        let ageMultiplier = 1.0;\n        if (userData.age >= 70) {\n          if (nutrient === 'vitamin_d') ageMultiplier = 1.2;\n          if (nutrient === 'vitamin_b12') ageMultiplier = 1.1;\n          if (nutrient === 'calcium') ageMultiplier = 1.15;\n        } else if (userData.age >= 50) {\n          if (nutrient === 'vitamin_d') ageMultiplier = 1.1;\n          if (nutrient === 'vitamin_b12') ageMultiplier = 1.05;\n        } else if (userData.age <= 18) {\n          if (nutrient === 'calcium') ageMultiplier = 1.15;\n          if (nutrient === 'iron') ageMultiplier = 1.1;\n        }\n\n        if (ageMultiplier !== 1.0) {\n          adjustedValue *= ageMultiplier;\n        }\n      }\n\n      const severity = userData?.covid_severity || userData?.longCovidSeverity;\n      const hasCovidCondition = severity && severity !== 'None' && severity !== null && severity !== undefined;\n\n      if (hasCovidCondition) {\n        const severityFactor = getSeverityFactor(severity);\n\n        if (['vitamin_c', 'vitamin_d', 'zinc', 'selenium'].includes(nutrient)) {\n          const covidMultiplier = Math.min(severityFactor * 1.5, 2.5);\n          adjustedValue *= covidMultiplier;\n        } else if (['vitamin_a', 'vitamin_e', 'vitamin_b6', 'vitamin_b12', 'folate', 'iron'].includes(nutrient)) {\n          const covidMultiplier = Math.min(severityFactor * 1.3, 2.0);\n          adjustedValue *= covidMultiplier;\n        } else if (['magnesium', 'copper', 'vitamin_b1', 'vitamin_b2', 'vitamin_b3'].includes(nutrient)) {\n          const covidMultiplier = Math.min(severityFactor * 1.1, 1.5);\n          adjustedValue *= covidMultiplier;\n        }\n      }\n\n      if (isNaN(adjustedValue) || !isFinite(adjustedValue) || adjustedValue <= 0) {\n        console.error(`Invalid final value for ${nutrient}: ${adjustedValue}, resetting to base`);\n        adjustedValue = personalRDA[nutrient].value;\n      }\n\n      const roundedValue = Math.round(adjustedValue * 10) / 10;\n\n      personalRDA[nutrient] = {\n        ...personalRDA[nutrient],\n        value: roundedValue,\n        isAdjusted: roundedValue !== baseRDAData_[nutrient].value\n      };\n    });\n\n    return personalRDA;\n  }, [getSeverityFactor]);\n\n  const getNutrientStatus = (percentValue) => {\n    if (percentValue >= 100) return { label: \"Optimal\", color: \"#4CAF50\" };\n    if (percentValue >= 70) return { label: \"Good\", color: \"#8BC34A\" };\n    if (percentValue >= 50) return { label: \"Moderate\", color: \"#FFC107\" };\n    if (percentValue >= 30) return { label: \"Low\", color: \"#FF9800\" };\n    return { label: \"Very Low\", color: \"#F44336\" };\n  };\n\n  const getNutrientInfo = (nutrientName) => {\n    const nutrientInfoMap = {};\n    for (const key in baseRDAData10) {\n        nutrientInfoMap[key.replace(/_/g, ' ')] = baseRDAData10[key].description;\n    }\n\n    const exactMatch = nutrientInfoMap[nutrientName.toLowerCase()];\n    if (exactMatch) return exactMatch;\n\n    for (const key in nutrientInfoMap) {\n      if (nutrientName.toLowerCase().includes(key)) {\n        return nutrientInfoMap[key];\n      }\n    }\n    return '';\n  };\n\n  useEffect(() => {\n    setIsLoading(true);\n    const timer = setTimeout(() => {\n      try {\n        const calculatedRDA = calculatePersonalizedRDA(baseRDAData10, userInfo);\n\n        if (!calculatedRDA || Object.keys(calculatedRDA).length === 0) {\n          console.error('Failed to calculate RDA values');\n          setIsLoading(false);\n          return;\n        }\n\n        setPersonalizedRDA(calculatedRDA);\n\n        const processedAllData = processNutrientData(nutrientIntake, calculatedRDA);\n        \n        setAllChartData(processedAllData);\n        applyFilters(processedAllData);\n\n      } catch (error) {\n        console.error('Error in MicronutrientChart useEffect:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    }, 500);\n\n    return () => clearTimeout(timer);\n  }, [userInfo, nutrientIntake, calculatePersonalizedRDA, processNutrientData, applyFilters]);\n\n  useEffect(() => {\n    if (allChartData.length > 0) {\n      applyFilters(allChartData);\n    }\n  }, [displayMode, selectedCategory, allChartData, applyFilters]);\n\n  const getCovidSeverityClass = (severity) => {\n    switch(severity?.toLowerCase()) {\n      case 'mild': return 'covid-severity-mild';\n      case 'moderate': return 'covid-severity-moderate';\n      case 'severe': return 'covid-severity-severe';\n      case 'very severe': return 'covid-severity-very-severe';\n      default: return 'covid-severity-unknown';\n    }\n  };\n\n  const toggleCovidSeverity = () => {\n    const severities = [null, 'mild', 'moderate', 'severe', 'very severe'];\n    const currentSeverity = userInfo.covid_severity?.toLowerCase() || userInfo.longCovidSeverity?.toLowerCase() || null;\n    const currentIndex = severities.indexOf(currentSeverity);\n    const nextIndex = (currentIndex + 1) % severities.length;\n    const newSeverity = severities[nextIndex];\n\n    const updatedUserInfo = {\n      ...userInfo,\n      covid_severity: newSeverity,\n      longCovidSeverity: newSeverity,\n      hasLongCovid: newSeverity !== null\n    };\n\n    if (newSeverity === null) {\n      delete updatedUserInfo.covid_severity;\n      delete updatedUserInfo.longCovidSeverity;\n      updatedUserInfo.hasLongCovid = false;\n    }\n\n    setUserInfo(updatedUserInfo);\n  };\n\n  const getCurrentCovidSeverity = () => {\n    const severity = userInfo.covid_severity || userInfo.longCovidSeverity;\n    if (!severity || severity === null || severity === 'None') return 'None';\n    return severity.charAt(0).toUpperCase() + severity.slice(1);\n  };\n\n  const changeDisplayMode = (mode) => {\n    setDisplayMode(mode);\n  };\n\n  const changeCategory = (category) => {\n    setSelectedCategory(category);\n  };\n\n  const getFilterDescription = () => {\n    const displayPart = displayMode === 'deficient' ? \"below 70% RDA\" : displayMode === 'optimal' ? \"at 100%+ RDA\" : \"\";\n    const categoryPart = selectedCategory === 'vitamins' ? \"vitamins\" : selectedCategory === 'minerals' ? \"minerals\" : \"nutrients\";\n\n    let description = categoryPart;\n    if (displayPart) {\n        description += ` ${displayPart}`;\n    }\n    return description.trim();\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"loading-container\">\n        <div className=\"loading-indicator\">\n          <div className=\"spinner\"></div>\n          <p className=\"loading-text\">Loading personalized micronutrient data...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const deficientCount = allChartData.filter(item => item.value < 70).length;\n\n  if ((!data || Object.keys(data).length === 0) && (!userData || Object.keys(userData).length === 0)) {\n    return (\n      <div className=\"micronutrient-chart-container\">\n        <div className=\"chart-card\">\n          <div className=\"chart-header\">\n            <h2 className=\"chart-title\">Micronutrient Status</h2>\n          </div>\n          <div className=\"empty-state\">\n            <div className=\"empty-state-icon\"></div>\n            <h3 className=\"empty-state-title\">No Data Available</h3>\n            <p className=\"empty-state-description\">\n              Please set up your profile and log some meals to see your personalized micronutrient analysis.\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!data || Object.keys(data).length === 0 || allChartData.length === 0) {\n    return (\n      <div className=\"micronutrient-chart-container\">\n        <div className=\"chart-card\">\n          <div className=\"chart-header\">\n            <h2 className=\"chart-title\">Micronutrient Status</h2>\n          </div>\n          <div className=\"empty-state\">\n            <div className=\"empty-state-icon\"></div>\n            <h3 className=\"empty-state-title\">No Micronutrient Data Available</h3>\n            <p className=\"empty-state-description\">\n              Once you log some meals, we'll analyze your nutrient intake and show your personalized micronutrient status here.\n            </p>\n          </div>\n        </div>\n        <div className=\"profile-card\">\n          <h3 className=\"profile-title\">User Profile</h3>\n          <div className=\"profile-grid\">\n            <div className=\"profile-item\">\n              <p className=\"profile-label\">Age</p>\n              <p className=\"profile-value\">{userInfo?.age || 'Not specified'} years</p>\n            </div>\n            <div className=\"profile-item\">\n              <p className=\"profile-label\">Gender</p>\n              <p className=\"profile-value\">{userInfo?.gender ? userInfo.gender.charAt(0).toUpperCase() + userInfo.gender.slice(1) : 'Not specified'}</p>\n            </div>\n            <div className=\"profile-item\">\n              <p className=\"profile-label\">BMI</p>\n              <p className=\"profile-value\">{userInfo?.weight && userInfo?.height ?\n                (userInfo.weight / Math.pow(userInfo.height/100, 2)).toFixed(1) : 'N/A'}</p>\n            </div>\n            <div className=\"profile-item\">\n              <p className=\"profile-label\">Activity Level</p>\n              <p className=\"profile-value\">{userInfo?.activity_level || 'Not specified'}</p>\n            </div>\n            <div className=\"profile-item\">\n              <p className=\"profile-label\">Medical Conditions</p>\n              <p className=\"profile-value\">{userInfo?.medical_conditions && userInfo.medical_conditions.length > 0 ?\n                userInfo.medical_conditions.map(c => c.charAt(0).toUpperCase() + c.slice(1)).join(', ') : 'None'}</p>\n            </div>\n            <div className=\"profile-item\">\n              <p className=\"profile-label\">COVID Status</p>\n              <button\n                onClick={toggleCovidSeverity}\n                className=\"covid-toggle-button\"\n                style={{\n                  padding: '8px 12px',\n                  backgroundColor: '#e3f2fd',\n                  border: '2px solid #2196f3',\n                  borderRadius: '6px',\n                  cursor: 'pointer',\n                  fontSize: '14px',\n                  fontWeight: '500',\n                  color: '#1976d2',\n                  transition: 'all 0.2s ease',\n                  minWidth: '120px'\n                }}\n                onMouseEnter={(e) => {\n                  e.target.style.backgroundColor = '#bbdefb';\n                  e.target.style.transform = 'scale(1.02)';\n                }}\n                onMouseLeave={(e) => {\n                  e.target.style.backgroundColor = '#e3f2fd';\n                  e.target.style.transform = 'scale(1)';\n                }}\n              >\n                {getCurrentCovidSeverity()} (Click to change)\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"micronutrient-chart-container\">\n      <div className=\"chart-card\">\n        <div className=\"chart-header\">\n          <h2 className=\"chart-title\">Micronutrient Status</h2>\n\n          <div className=\"display-mode-buttons\">\n            <button\n              onClick={() => changeDisplayMode('all')}\n              className={`mode-button ${displayMode === 'all' ? 'mode-button-active' : ''}`}\n            >\n              All ({allChartData.length})\n            </button>\n            <button\n              onClick={() => changeDisplayMode('deficient')}\n              className={`mode-button ${displayMode === 'deficient' ? 'mode-button-deficient' : ''}`}\n            >\n              Deficient ({deficientCount})\n            </button>\n            <button\n              onClick={() => changeDisplayMode('optimal')}\n              className={`mode-button ${displayMode === 'optimal' ? 'mode-button-optimal' : ''}`}\n            >\n              Optimal ({allChartData.filter(item => item.percentOfRDA >= 100).length})\n            </button>\n          </div>\n        </div>\n\n        <div className=\"category-filter\">\n          <button\n            onClick={() => changeCategory('all')}\n            className={`category-button ${selectedCategory === 'all' ? 'category-button-active' : ''}`}\n          >\n            All Nutrients\n          </button>\n          <button\n            onClick={() => changeCategory('vitamins')}\n            className={`category-button ${selectedCategory === 'vitamins' ? 'category-button-active' : ''}`}\n          >\n            Vitamins\n          </button>\n          <button\n            onClick={() => changeCategory('minerals')}\n            className={`category-button ${selectedCategory === 'minerals' ? 'category-button-active' : ''}`}\n          >\n            Minerals\n          </button>\n        </div>\n\n        {deficientCount > 0 && (\n          <div className=\"deficiency-alert\">\n            <p className=\"deficiency-message\">\n              {deficientCount} {deficientCount === 1 ? 'nutrient is' : 'nutrients are'} below recommended levels.\n            </p>\n          </div>\n        )}\n\n        {userInfo.covid_severity && getCurrentCovidSeverity() !== 'None' && (\n          <div className={`covid-alert ${getCovidSeverityClass(userInfo.covid_severity)}`}>\n            <p className=\"covid-title\">Long COVID Condition - {getCurrentCovidSeverity()} Severity</p>\n            <p className=\"covid-description\">Recommended values have been adjusted for immune system support</p>\n          </div>\n        )}\n\n        <div className=\"chart-content\">\n          {chartData.length === 0 && allChartData.length > 0 ? (\n            <div className=\"no-filter-results\">\n              <div className=\"no-results-icon\"></div>\n              <h3 className=\"no-results-title\">Great news!</h3>\n              <p className=\"no-results-message\">\n                You don't have any {getFilterDescription()} to display.\n                {displayMode === 'deficient' && \" This means your nutrient levels are doing well in this category!\"}\n                {displayMode === 'optimal' && \" Try logging more diverse meals to reach optimal levels.\"}\n              </p>\n              <p className=\"no-results-suggestion\">\n                Try selecting \"All\" to see your complete nutrient profile.\n              </p>\n            </div>\n          ) : (\n            chartData.map((nutrient) => (\n              <BulletChart\n                key={nutrient.key}\n                data={nutrient}\n                maxPercent={150}\n                getNutrientStatus={getNutrientStatus}\n                getNutrientInfo={getNutrientInfo}\n              />\n            ))\n          )}\n        </div>\n\n        <div className=\"chart-legend\">\n          <div className=\"legend-item\">\n            <div className=\"legend-color legend-optimal\"></div>\n            <span className=\"legend-text\"> 100% (Optimal)</span>\n          </div>\n          <div className=\"legend-item\">\n            <div className=\"legend-color legend-good\"></div>\n            <span className=\"legend-text\">70-99% (Good)</span>\n          </div>\n          <div className=\"legend-item\">\n            <div className=\"legend-color legend-moderate\"></div>\n            <span className=\"legend-text\">50-69% (Moderate)</span>\n          </div>\n          <div className=\"legend-item\">\n            <div className=\"legend-color legend-low\"></div>\n            <span className=\"legend-text\">30-49% (Low)</span>\n          </div>\n          <div className=\"legend-item\">\n            <div className=\"legend-color legend-very-low\"></div>\n            <span className=\"legend-text\">0-29% (Very Low)</span>\n          </div>\n          <div className=\"legend-item\">\n            <div className=\"legend-target\"></div>\n            <span className=\"legend-text\">Target (100% RDA)</span>\n          </div>\n          <div className=\"legend-item\">\n            <div className=\"legend-threshold\"></div>\n            <span className=\"legend-text\">Deficiency Threshold (70%)</span>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"profile-card\">\n        <h3 className=\"profile-title\">User Profile</h3>\n        <div className=\"profile-grid\">\n          <div className=\"profile-item\">\n            <p className=\"profile-label\">Age</p>\n            <p className=\"profile-value\">{userInfo?.age || 'Not specified'} years</p>\n          </div>\n          <div className=\"profile-item\">\n            <p className=\"profile-label\">Gender</p>\n            <p className=\"profile-value\">{userInfo?.gender ? userInfo.gender.charAt(0).toUpperCase() + userInfo.gender.slice(1) : 'Not specified'}</p>\n          </div>\n          <div className=\"profile-item\">\n            <p className=\"profile-label\">BMI</p>\n            <p className=\"profile-value\">{userInfo?.weight && userInfo?.height ?\n              (userInfo.weight / Math.pow(userInfo.height/100, 2)).toFixed(1) : 'N/A'}</p>\n          </div>\n          <div className=\"profile-item\">\n            <p className=\"profile-label\">Activity Level</p>\n            <p className=\"profile-value\">{userInfo?.activity_level || 'Not specified'}</p>\n          </div>\n          <div className=\"profile-item\">\n            <p className=\"profile-label\">Medical Conditions</p>\n            <p className=\"profile-value\">{userInfo?.medical_conditions && userInfo.medical_conditions.length > 0 ?\n              userInfo.medical_conditions.map(c => c.charAt(0).toUpperCase() + c.slice(1)).join(', ') : 'None'}</p>\n          </div>\n          <div className=\"profile-item\">\n            <p className=\"profile-label\">COVID Status</p>\n            <button\n              onClick={toggleCovidSeverity}\n              className=\"covid-toggle-button\"\n              style={{\n                padding: '8px 12px',\n                backgroundColor: '#e3f2fd',\n                border: '2px solid #2196f3',\n                borderRadius: '6px',\n                cursor: 'pointer',\n                fontSize: '14px',\n                fontWeight: '500',\n                color: '#1976d2',\n                transition: 'all 0.2s ease',\n                minWidth: '120px'\n              }}\n              onMouseEnter={(e) => {\n                e.target.style.backgroundColor = '#bbdefb';\n                e.target.style.transform = 'scale(1.02)';\n              }}\n              onMouseLeave={(e) => {\n                e.target.style.backgroundColor = '#e3f2fd';\n                e.target.style.transform = 'scale(1)';\n              }}\n            >\n              {getCurrentCovidSeverity()} (Click to change)\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// FIXED: Enhanced getChartData function with better nutrient key mapping\nfunction getChartData(foodLog, userProfile) {\n  if (!foodLog || !Array.isArray(foodLog)) {\n    return { macroSums: {}, microSums: {}, efficiencyData: [] };\n  }\n\n  if (foodLog.length === 0) {\n    return { macroSums: {}, microSums: {}, efficiencyData: [] };\n  }\n\n  const today = formatDateForComparison(new Date());\n  const todayEntries = foodLog.filter(e => e.date === today);\n  \n  console.log('=== FIXED getChartData DEBUG ===');\n  \n  if (todayEntries.length === 0) {\n    return { macroSums: {}, microSums: {}, efficiencyData: foodLog };\n  }\n\n  const macroSums = todayEntries.reduce((acc, e) => {\n    const protein = parseFloat(e.protein) || 0;\n    const carbs = parseFloat(e.carbs) || 0;\n    const fat = parseFloat(e.fat) || 0;\n    const calories = parseFloat(e.calories) || 0;\n    \n    acc.protein = (acc.protein || 0) + protein;\n    acc.carbs = (acc.carbs || 0) + carbs;\n    acc.fat = (acc.fat || 0) + fat;\n    acc.calories = (acc.calories || 0) + calories;\n    \n    console.log(`Entry: ${e.name} - P:${protein}g C:${carbs}g F:${fat}g Cal:${calories}`);\n    return acc;\n  }, {});\n  \n  const microSums = {};\n  \n  todayEntries.forEach((entry, entryIndex) => {\n    console.log(`\\n--- Processing Entry ${entryIndex}: ${entry.name} ---`);\n    \n    if (!entry.micronutrients) {\n      console.log(`No micronutrients data for ${entry.name}`);\n      return;\n    }\n    \n    Object.entries(entry.micronutrients).forEach(([originalKey, nutrientValue]) => {\n      // FIXED: Skip macro nutrients\n      const macroNutrients = ['protein', 'carbs', 'fat', 'calories', 'name', 'unit'];\n      if (macroNutrients.includes(originalKey.toLowerCase())) {\n        return;\n      }\n      \n      // FIXED: Normalize the nutrient key using our mapping function\n      const nutrientKey = normalizeNutrientKey(originalKey);\n      console.log(`Mapping: \"${originalKey}\"  \"${nutrientKey}\"`);\n      \n      let valueToAdd = 0;\n      let unit = 'mg';\n      \n      // FIXED: Handle different value formats including \"1.7 mg\" strings\n      if (typeof nutrientValue === 'object' && nutrientValue !== null) {\n        if (nutrientValue.value !== undefined) {\n          valueToAdd = parseFloat(nutrientValue.value) || 0;\n          unit = nutrientValue.unit || 'mg';\n        } else {\n          console.warn(`Object format not recognized for ${originalKey}:`, nutrientValue);\n          return;\n        }\n      } else if (typeof nutrientValue === 'number') {\n        valueToAdd = nutrientValue;\n      } else if (typeof nutrientValue === 'string') {\n        // FIXED: Parse strings like \"1.7 mg\" or \"121.0 mg\"\n        const match = nutrientValue.match(/^([\\d.]+)\\s*(\\w+)?/);\n        if (match) {\n          valueToAdd = parseFloat(match[1]) || 0;\n          unit = match[2] || 'mg';\n        } else {\n          valueToAdd = parseFloat(nutrientValue) || 0;\n        }\n      } else {\n        console.warn(`Unrecognized value format for ${originalKey}:`, nutrientValue);\n        return;\n      }\n      \n      // FIXED: Handle unit conversions for specific nutrients\n      if (nutrientKey === 'zinc' || nutrientKey === 'selenium' || nutrientKey === 'copper') {\n        if (unit === 'mcg' || unit === 'g') {\n          if (nutrientKey === 'zinc' || nutrientKey === 'copper') {\n            valueToAdd = valueToAdd / 1000;\n            unit = 'mg';\n            console.log(`Converted ${nutrientKey} from mcg to mg: ${valueToAdd}`);\n          }\n        }\n      }\n      \n      // FIXED: Sanity check for unreasonable values\n      const reasonableMaxValues = {\n        'zinc': 50,\n        'selenium': 400,\n        'copper': 10,\n        'iron': 100,\n        'vitamin_c': 2000,\n        'vitamin_d': 100,\n        'vitamin_e': 50,\n        'vitamin_b6': 20,\n        'vitamin_b12': 100,\n        'calcium': 3000,\n        'magnesium': 1000,\n        'potassium': 10000\n      };\n      \n      const maxValue = reasonableMaxValues[nutrientKey] || 10000;\n      if (valueToAdd < 0 || valueToAdd > maxValue) {\n        console.warn(`Suspicious ${nutrientKey} value: ${valueToAdd} ${unit} (max expected: ${maxValue}) - using cautiously`);\n        valueToAdd = Math.min(Math.max(valueToAdd, 0), maxValue);\n      }\n      \n      // FIXED: Accumulate the values\n      if (!microSums[nutrientKey]) {\n        microSums[nutrientKey] = { value: 0, unit: unit };\n      }\n      \n      microSums[nutrientKey].value += valueToAdd;\n      \n      console.log(`${nutrientKey}: +${valueToAdd} ${unit}  Total: ${microSums[nutrientKey].value} ${unit}`);\n    });\n  });\n  \n  console.log('\\n=== FINAL SUMS ===');\n  console.log('Macros:', macroSums);\n  console.log('Micros:', microSums);\n  \n  // FIXED: Validate final micronutrient totals\n  Object.entries(microSums).forEach(([nutrient, data]) => {\n    const warningThresholds = {\n      'zinc': 100,\n      'selenium': 1000,\n      'copper': 50,\n      'iron': 200,\n      'vitamin_c': 5000,\n    };\n    \n    const threshold = warningThresholds[nutrient] || 1000;\n    if (data.value > threshold) {\n      console.warn(`Unusually high ${nutrient}: ${data.value} ${data.unit} (threshold: ${threshold})`);\n    }\n  });\n  \n  console.log('=== END FIXED DEBUG ===\\n');\n  \n  return { \n    macroSums, \n    microSums, \n    efficiencyData: foodLog \n  };\n}\n\n// Updated EfficiencyChart - FIXED to use named imports\nfunction EfficiencyChart({ data, userData, foodDatabase }) {\n  const chartRef = useRef(null);\n  const [processedData, setProcessedData] = useState([]);\n\n  useEffect(() => {\n    if (!data || data.length === 0) return;\n    \n    const today = new Date();\n    const oneWeekAgo = new Date();\n    oneWeekAgo.setDate(today.getDate() - 7);\n    const oneWeekAgoString = formatDateForComparison(oneWeekAgo);\n    \n    const lastWeekData = data.filter(meal => {\n      try {\n        return isSameOrAfter(meal.date, oneWeekAgoString);\n      } catch (err) {\n        console.warn('Error parsing date:', meal.date);\n        return false;\n      }\n    });\n    \n    const updatedData = lastWeekData.map((meal, index) => {\n      try {\n        console.log(`Calculating efficiency for ${meal.name} using enhanced function`);\n        const efficiency = calculateFoodEfficiency(meal, userData);\n        \n        const finalEfficiency = (efficiency && efficiency > 0) ? efficiency : (meal.efficiency || meal.metabolicEfficiency || 80);\n        \n        console.log(`Final efficiency for ${meal.name}: ${finalEfficiency}`);\n        \n        return {\n          ...meal,\n          originalEfficiency: meal.efficiency || meal.metabolicEfficiency || 80,\n          efficiency: finalEfficiency,\n          actualEnergy: Math.round(meal.calories * (finalEfficiency / 100)),\n          wastedEnergy: Math.round(meal.calories * ((100 - finalEfficiency) / 100))\n        };\n      } catch (err) {\n        console.warn(`Error processing meal ${index}:`, err);\n        const fallbackEfficiency = meal.efficiency || meal.metabolicEfficiency || 80;\n        return {\n          ...meal,\n          efficiency: fallbackEfficiency,\n          actualEnergy: Math.round(meal.calories * (fallbackEfficiency / 100)),\n          wastedEnergy: Math.round(meal.calories * ((100 - fallbackEfficiency) / 100))\n        };\n      }\n    });\n    \n    const filteredData = updatedData.filter(meal => \n      meal.mealType !== \"Pre-workout\" && meal.mealType !== \"Post-workout\"\n    );\n    \n    console.log('ProcessedData with consistent efficiency:', filteredData);\n    setProcessedData(filteredData);\n  }, [data, userData, foodDatabase]);\n\n  useEffect(() => {\n    if (!chartRef.current || !processedData || processedData.length === 0) return;\n    \n    select(chartRef.current).selectAll(\"*\").remove();\n    \n    const margin = { top: 60, right: 20, bottom: 50, left: 50 };\n    const width = 900 - margin.left - margin.right;\n    const height = 450 - margin.top - margin.bottom;\n    \n    const svg = select(chartRef.current)\n      .append(\"svg\")\n      .attr(\"width\", width + margin.left + margin.right)\n      .attr(\"height\", height + margin.top + margin.bottom)\n      .append(\"g\")\n      .attr(\"transform\", `translate(${margin.left},${margin.top})`);\n    \n    svg.append(\"text\")\n      .attr(\"x\", width / 2)\n      .attr(\"y\", -30)\n      .attr(\"text-anchor\", \"middle\")\n      .style(\"font-size\", \"18px\")\n      .style(\"font-weight\", \"bold\")\n      .text(\"Enhanced Metabolic Efficiency Chart\");\n      \n    svg.append(\"text\")\n      .attr(\"x\", width / 2)\n      .attr(\"y\", -10)\n      .attr(\"text-anchor\", \"middle\")\n      .style(\"font-size\", \"14px\")\n      .style(\"font-style\", \"italic\")\n      .text(\"Optimized for Long COVID energy management\");\n    \n    const tooltip = select(\"body\")\n      .append(\"div\")\n      .attr(\"class\", \"chart-tooltip\")\n      .style(\"position\", \"absolute\")\n      .style(\"visibility\", \"hidden\")\n      .style(\"background-color\", \"white\")\n      .style(\"border\", \"1px solid #ddd\")\n      .style(\"border-radius\", \"5px\")\n      .style(\"padding\", \"12px\")\n      .style(\"font-size\", \"14px\")\n      .style(\"box-shadow\", \"0 3px 14px rgba(0,0,0,0.25)\")\n      .style(\"z-index\", \"10\")\n      .style(\"max-width\", \"300px\");\n    \n    // Generate date range without timezone issues\n    const allDatesInRange = [];\n    const today = new Date();\n    for (let i = 6; i >= 0; i--) {\n      const date = new Date();\n      date.setDate(today.getDate() - i);\n      const formattedDate = formatDateForComparison(date);\n      allDatesInRange.push(formattedDate);\n    }\n    \n    const combinedData = [];\n    const groupedByDate = group(processedData, d => d.date);\n    \n    const uniqueMealTypes = ['Breakfast', 'Morning Snack', 'Lunch', 'Afternoon Snack', 'Dinner', 'Late Night Snack'];\n    \n    allDatesInRange.forEach(date => {\n      const dateData = groupedByDate.get(date) || [];\n      \n      if (dateData.length > 0) {\n        const mealsByType = group(dateData, d => d.mealType);\n      \n        uniqueMealTypes.forEach(mealType => {\n          const meals = mealsByType.get(mealType);\n          if (meals && meals.length > 0) {\n            const totalCalories = sum(meals, d => d.calories);\n            \n            const weightedEfficiency = meals.reduce((acc, meal) => {\n              const mealEfficiency = meal.efficiency || 0;\n              const calorieWeight = totalCalories > 0 ? meal.calories / totalCalories : 0;\n              return acc + (mealEfficiency * calorieWeight);\n            }, 0);\n            \n            const totalActualEnergy = sum(meals, d => d.actualEnergy || (d.calories * (d.efficiency / 100)));\n            const totalWastedEnergy = totalCalories - totalActualEnergy;\n            \n            combinedData.push({\n              date: date,\n              mealType: mealType,\n              time: meals[0].time,\n              name: `${mealType} (${meals.length} items)`,\n              efficiency: Math.round(weightedEfficiency),\n              calories: totalCalories,\n              actualEnergy: totalActualEnergy,\n              wastedEnergy: totalWastedEnergy,\n              originalMeals: meals,\n              mealOrder: uniqueMealTypes.indexOf(mealType)\n            });\n          }\n        });\n      }\n    });\n    \n    const chronologicalData = [...combinedData].sort((a, b) => {\n      if (a.date !== b.date) return a.date.localeCompare(b.date);\n      return a.mealOrder - b.mealOrder;\n    });\n\n    const xOuter = scaleBand()\n      .domain(allDatesInRange)\n      .range([0, width])\n      .padding(0.2);\n    \n    const xInner = scaleBand()\n      .domain(uniqueMealTypes)\n      .range([0, xOuter.bandwidth()])\n      .padding(0.1);\n    \n    const formatDate = date => {\n      const parts = date.split('-');\n      return `${parseInt(parts[1])}/${parseInt(parts[2])}`;\n    };\n    \n    const maxCalories = max(combinedData, d => d.calories) || 1000;\n    const y = scaleLinear()\n      .domain([0, maxCalories])\n      .range([height, 0]);\n\n    const yEff = scaleLinear()\n      .domain([0, 100])\n      .range([height, 0]);\n\n    // Create axes\n    svg.append(\"g\")\n      .attr(\"transform\", `translate(0,${height})`)\n      .call(axisBottom(xOuter).tickFormat(formatDate))\n      .selectAll(\"text\")\n      .style(\"text-anchor\", \"end\")\n      .attr(\"dx\", \"-.8em\")\n      .attr(\"dy\", \".15em\")\n      .attr(\"transform\", \"rotate(-45)\");\n\n    svg.append(\"g\")\n      .call(axisLeft(y))\n      .append(\"text\")\n      .attr(\"transform\", \"rotate(-90)\")\n      .attr(\"y\", -50)\n      .attr(\"x\", -height / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .style(\"fill\", \"#000\")\n      .text(\"Calories\");\n\n    svg.append(\"g\")\n      .attr(\"transform\", `translate(${width}, 0)`)\n      .call(axisRight(yEff))\n      .append(\"text\")\n      .attr(\"transform\", \"rotate(-90)\")\n      .attr(\"y\", 50)\n      .attr(\"x\", -height / 2)\n      .attr(\"text-anchor\", \"middle\")\n      .style(\"fill\", \"#000\")\n      .text(\"Enhanced Efficiency (%)\");\n\n    const mealColors = {\n      \"Breakfast\": \"#DC2626\",\n      \"Morning Snack\": \"#EA580C\",\n      \"Lunch\": \"#16A34A\",\n      \"Afternoon Snack\": \"#0891B2\",\n      \"Dinner\": \"#7C3AED\",\n      \"Late Night Snack\": \"#BE185D\"\n    };\n\n    // Add stacked bars\n    combinedData.forEach(meal => {\n      const mealColor = mealColors[meal.mealType] || \"#999999\";\n      const barX = xOuter(meal.date) + xInner(meal.mealType);\n      const barWidth = xInner.bandwidth();\n      \n      // Actual energy bar\n      svg.append(\"rect\")\n        .attr(\"class\", \"actual-energy-bar\")\n        .attr(\"x\", barX)\n        .attr(\"y\", y(meal.actualEnergy))\n        .attr(\"width\", barWidth)\n        .attr(\"height\", height - y(meal.actualEnergy))\n        .attr(\"fill\", mealColor)\n        .attr(\"opacity\", 0.9)\n        .attr(\"stroke\", \"#333\")\n        .attr(\"stroke-width\", 1)\n        .on(\"mouseover\", function(event) {\n          select(this).attr(\"opacity\", 0.7);\n          tooltip\n            .style(\"visibility\", \"visible\")\n            .html(`\n              <div style=\"font-weight:bold;margin-bottom:10px;font-size:15px;\">${meal.date} - ${meal.mealType}</div>\n              <div style=\"margin-bottom:6px;\">Total Calories: ${Math.round(meal.calories)}</div>\n              <div style=\"margin-bottom:6px;\"><strong>Enhanced Efficiency: ${meal.efficiency}%</strong></div>\n              <div style=\"margin-bottom:6px;\">Usable Energy: ${Math.round(meal.actualEnergy)} cal</div>\n              <div style=\"margin-bottom:12px;\">Energy Lost: ${Math.round(meal.wastedEnergy)} cal</div>\n              <div style=\"font-weight:bold;margin-bottom:5px;\">Individual Items:</div>\n              <ul style=\"margin-top:0;padding-left:20px;\">\n                ${meal.originalMeals.map(item => `\n                  <li>${item.name} - ${item.calories} cal (${Math.round(item.efficiency)}% efficient)</li>\n                `).join('')}\n              </ul>\n            `)\n            .style(\"left\", `${event.pageX + 15}px`)\n            .style(\"top\", `${event.pageY - 10}px`);\n        })\n        .on(\"mouseout\", function() {\n          select(this).attr(\"opacity\", 0.9);\n          tooltip.style(\"visibility\", \"hidden\");\n        });\n      \n      // Potential energy bar (wasted energy)\n      svg.append(\"rect\")\n        .attr(\"class\", \"potential-energy-bar\")\n        .attr(\"x\", barX)\n        .attr(\"y\", y(meal.calories))\n        .attr(\"width\", barWidth)\n        .attr(\"height\", y(meal.actualEnergy) - y(meal.calories))\n        .attr(\"fill\", mealColor)\n        .attr(\"opacity\", 0.3)\n        .attr(\"stroke\", \"#333\")\n        .attr(\"stroke-width\", 1)\n        .attr(\"stroke-dasharray\", \"3,3\");\n    });\n\n    if (chronologicalData.length > 0) {\n      const lineData = chronologicalData.map((meal, index) => {\n        const barX = xOuter(meal.date) + xInner(meal.mealType);\n        const barWidth = xInner.bandwidth();\n        const barCenterX = barX + (barWidth / 2);\n        \n        return {\n          ...meal,\n          xPos: barCenterX,\n          chronologicalIndex: index\n        };\n      });\n\n      const sortedLineData = [...lineData].sort((a, b) => a.xPos - b.xPos);\n      \n      const lineGenerator = line()\n        .x(d => d.xPos)\n        .y(d => yEff(d.efficiency))\n        .defined(d => d.efficiency != null && !isNaN(d.efficiency))\n        .curve(curveMonotoneX);\n      \n      svg.append(\"path\")\n        .datum(sortedLineData)\n        .attr(\"fill\", \"none\")\n        .attr(\"stroke\", \"grey\")\n        .attr(\"stroke-width\", 3)\n        .attr(\"d\", lineGenerator);\n      \n      svg.selectAll(\".efficiency-point\")\n        .data(sortedLineData)\n        .enter()\n        .append(\"circle\")\n        .attr(\"class\", \"efficiency-point\")\n        .attr(\"cx\", d => d.xPos)\n        .attr(\"cy\", d => yEff(d.efficiency))\n        .attr(\"r\", 5)\n        .attr(\"fill\", \"grey\")\n        .attr(\"stroke\", \"#333\")\n        .attr(\"stroke-width\", 1)\n        .on(\"mouseover\", function(event, d) {\n          select(this).attr(\"r\", 8);\n          tooltip\n            .style(\"visibility\", \"visible\")\n            .html(`\n              <div style=\"font-weight:bold;font-size:16px;\">${d.mealType} - ${d.time}</div>\n              <div style=\"font-weight:bold;font-size:14px;\">${d.date}</div>\n              <div>Enhanced Efficiency: <strong>${d.efficiency}%</strong></div>\n              <div style=\"margin-top:6px\">Calculated using enhanced Long COVID algorithms</div>\n            `)\n            .style(\"left\", `${event.pageX + 15}px`)\n            .style(\"top\", `${event.pageY - 10}px`);\n        })\n        .on(\"mouseout\", function() {\n          select(this).attr(\"r\", 5);\n          tooltip.style(\"visibility\", \"hidden\");\n        });\n    }\n\n    // Add legend\n    const legendY = height + 100;\n    \n    svg.append(\"line\")\n      .attr(\"x1\", 10)\n      .attr(\"x2\", 40)\n      .attr(\"y1\", legendY)\n      .attr(\"y2\", legendY)\n      .attr(\"stroke\", \"grey\")\n      .attr(\"stroke-width\", 3);\n    \n    svg.append(\"circle\")\n      .attr(\"cx\", 25)\n      .attr(\"cy\", legendY)\n      .attr(\"r\", 5)\n      .attr(\"fill\", \"grey\")\n      .attr(\"stroke\", \"#333\")\n      .attr(\"stroke-width\", 1);\n    \n    svg.append(\"text\")\n      .attr(\"x\", 50)\n      .attr(\"y\", legendY + 4)\n      .style(\"font-size\", \"12px\")\n      .text(\"Enhanced Efficiency (%)\");\n    \n    const legendData = [\n      { label: \"Usable Energy\", color: \"#DC2626\", opacity: 0.9 },\n      { label: \"Energy Lost\", color: \"#DC2626\", opacity: 0.3 }\n    ];\n    \n    svg.selectAll(\".legend-rect\")\n      .data(legendData)\n      .enter()\n      .append(\"rect\")\n      .attr(\"x\", 200)\n      .attr(\"y\", (d, i) => legendY - 10 + i * 20)\n      .attr(\"width\", 15)\n      .attr(\"height\", 15)\n      .attr(\"fill\", d => d.color)\n      .attr(\"opacity\", d => d.opacity)\n      .attr(\"stroke\", \"#333\")\n      .attr(\"stroke-width\", 1);\n    \n    svg.selectAll(\".legend-text\")\n      .data(legendData)\n      .enter()\n      .append(\"text\")\n      .attr(\"x\", 225)\n      .attr(\"y\", (d, i) => legendY + 2 + i * 20)\n      .style(\"font-size\", \"12px\")\n      .text(d => d.label);\n    \n    // Meal type legend\n    const mealTypeData = Object.entries(mealColors).map(([type, color]) => ({ type, color }));\n    \n    svg.selectAll(\".meal-type-rect\")\n      .data(mealTypeData)\n      .enter()\n      .append(\"rect\")\n      .attr(\"x\", (d, i) => 400 + Math.floor(i/3) * 140)\n      .attr(\"y\", (d, i) => legendY - 10 + (i % 3) * 20)\n      .attr(\"width\", 15)\n      .attr(\"height\", 15)\n      .attr(\"fill\", d => d.color)\n      .attr(\"stroke\", \"#333\")\n      .attr(\"stroke-width\", 1);\n    \n    svg.selectAll(\".meal-type-text\")\n      .data(mealTypeData)\n      .enter()\n      .append(\"text\")\n      .attr(\"x\", (d, i) => 425 + Math.floor(i/3) * 140)\n      .attr(\"y\", (d, i) => legendY + 2 + (i % 3) * 20)\n      .style(\"font-size\", \"12px\")\n      .text(d => d.type);\n\n    return () => {\n      select(\".chart-tooltip\").remove();\n    };\n  }, [chartRef, processedData, userData]);\n\n  if (!processedData || processedData.length === 0) {\n    return (\n      <div className=\"chart-container\" style={{ width: '100%', minHeight: '300px' }}>\n        <div ref={chartRef} className=\"efficiency-chart\">\n          <div className=\"placeholder\">\n            <p>No meal data available for enhanced efficiency analysis.</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ width: '100%', minHeight: '900px', display: 'flex', flexDirection: 'column' }}>\n      <div ref={chartRef} className=\"efficiency-chart\" style={{ \n        height: '600px', \n        width: '100%', \n        overflow: 'visible',\n        flexShrink: 0\n      }}></div>\n      \n      <div style={{ \n        marginTop: '40px', \n        padding: '25px', \n        backgroundColor: '#f8f9fa', \n        borderRadius: '8px',\n        width: '100%',\n        boxSizing: 'border-box',\n        flexShrink: 0,\n        border: '1px solid #dee2e6'\n      }}>\n        <h4 style={{ \n          marginTop: '0', \n          marginBottom: '20px', \n          fontSize: '20px', \n          fontWeight: 'bold',\n          color: '#333'\n        }}>\n          Enhanced Metabolic Efficiency\n        </h4>\n        <p style={{ \n          marginBottom: '20px', \n          lineHeight: '1.6',\n          fontSize: '16px',\n          color: '#555'\n        }}>\n          This enhanced chart uses advanced algorithms that take into account Long COVID severity, meal timing, \n          macronutrient balance, and individual factors to provide more accurate efficiency calculations for \n          energy management. The efficiency line follows proper chronological order.\n        </p>\n        <div style={{ marginTop: '20px' }}>\n          <strong style={{ fontSize: '18px', color: '#333' }}>Enhanced Features:</strong>\n          <ul style={{ \n            marginTop: '15px', \n            paddingLeft: '30px', \n            lineHeight: '1.8',\n            fontSize: '15px',\n            color: '#555'\n          }}>\n            <li style={{ marginBottom: '8px' }}>Long COVID severity adjustments (metabolic efficiency factors)</li>\n            <li style={{ marginBottom: '8px' }}>Circadian rhythm timing optimization</li>\n            <li style={{ marginBottom: '8px' }}>Macronutrient balance scoring</li>\n            <li style={{ marginBottom: '8px' }}>Anti-inflammatory food benefits/cautions</li>\n            <li style={{ marginBottom: '8px' }}>Chronologically ordered efficiency tracking</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction AnalysisTab({ foodLog, userProfile }) {\n  if (!foodLog || !Array.isArray(foodLog)) {\n    return (\n      <div className=\"analysis-error\">\n        <h3>Data Error</h3>\n        <p>Unable to load food log data. Please try refreshing the page.</p>\n      </div>\n    );\n  }\n\n  if (!userProfile) {\n    return (\n      <div className=\"analysis-error\">\n        <h3>Profile Error</h3>\n        <p>User profile data is missing. Please check your account settings.</p>\n      </div>\n    );\n  }\n\n  const today = formatDateForComparison(new Date());\n  const analysisDate = foodLog.length > 0 ? foodLog[0].date : today;\n  const todayMeals = foodLog.filter(entry => entry.date === today);\n  const { macroSums, microSums, efficiencyData } = getChartData(foodLog, userProfile);\n\n  return (\n    <div className=\"food-analysis-section\">\n      <div className=\"analysis-header\">\n        <h3> Nutritional Analysis Dashboard</h3>\n        <p className=\"analysis-date\">Analysis for {analysisDate}</p>\n        <div className=\"analysis-summary\">\n          <span className=\"summary-stat\">\n            <strong>{todayMeals.length}</strong> meals logged today ({today})\n          </span>\n        </div>\n      </div>\n\n      <div className=\"charts-container\">\n        \n        <div className=\"chart-wrapper\">\n          <div className=\"chart-header\">\n            <h4> Macronutrient Balance</h4>\n            <p className=\"chart-description\">Your protein, carbohydrate, and fat intake compared to personalized recommendations</p>\n          </div>\n          <MacronutrientChart userData={userProfile} userIntake={macroSums} />\n        </div>\n        \n        <div className=\"chart-wrapper\">\n          <div className=\"chart-header\">\n            <h4> Micronutrient Status</h4>\n            <p className=\"chart-description\">Essential vitamins and minerals as percentage of recommended daily amounts</p>\n          </div>\n          <MicronutrientChart data={microSums} userData={userProfile} />\n        </div>\n        \n        <div className=\"chart-wrapper\">\n          <div className=\"chart-header\">\n            <h4> Metabolic Efficiency</h4>\n            <p className=\"chart-description\">How effectively your body converts food calories into usable energy</p>\n          </div>\n          <div style={{ width: '100%', overflow: 'visible' }}>\n            <EfficiencyChart data={efficiencyData} userData={userProfile} />\n          </div>\n        </div>\n\n      </div>\n    </div>\n  );\n}\n\nexport { AnalysisTab, MacronutrientChart, MicronutrientChart, EfficiencyChart };","import React from 'react';\n\nconst MicronutrientRadarChart = ({ micronutrients = {}, selectedMeal = null }) => {\n  // Define the micronutrients in a FIXED order for consistent axis positions\n  const fixedMicronutrientOrder = [\n    'vitamin_c',\n    'vitamin_d', \n    'vitamin_a',\n    'vitamin_e',\n    'vitamin_k',\n    'vitamin_b12',\n    'folate',\n    'vitamin_b6',\n    'thiamin',\n    'riboflavin',\n    'niacin',\n    'calcium',\n    'iron',\n    'magnesium',\n    'zinc',\n    'potassium',\n    'phosphorus',\n    'sodium'\n  ];\n\n  const micronutrientMapping = {\n    'vitamin_c': 'Vitamin C',\n    'vitamin_d': 'Vitamin D', \n    'vitamin_e': 'Vitamin E',\n    'vitamin_a': 'Vitamin A',\n    'vitamin_k': 'Vitamin K',\n    'thiamin': 'B1',\n    'riboflavin': 'B2',\n    'niacin': 'B3',\n    'vitamin_b6': 'B6',\n    'folate': 'Folate',\n    'vitamin_b12': 'B12',\n    'calcium': 'Calcium',\n    'iron': 'Iron',\n    'magnesium': 'Magnesium',\n    'phosphorus': 'Phosphorus',\n    'potassium': 'Potassium',\n    'sodium': 'Sodium',\n    'zinc': 'Zinc'\n  };\n\n  // Extract available micronutrients that have meaningful values\n  const availableMicronutrients = fixedMicronutrientOrder.filter(key => {\n    const nutrient = micronutrients[key];\n    return nutrient?.value !== undefined && \n           parseFloat(nutrient.value) > 0 && \n           parseFloat(nutrient.value) < 10000; // Filter out unrealistic values\n  });\n\n  // If no micronutrients available, show a message\n  if (availableMicronutrients.length === 0) {\n    return (\n      <div className=\"micronutrient-radar-container\">\n        <h4> Micronutrient Profile</h4>\n        <div className=\"no-micronutrients\">\n          <div className=\"no-data-icon\"></div>\n          <p>No micronutrient data available for this food item.</p>\n          {selectedMeal && (\n            <p className=\"data-note\">\n              <em>Select a different food or check if micronutrient data exists in the database.</em>\n            </p>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  // Use only the available nutrients for display (dynamic chart)\n  const displayNutrients = availableMicronutrients.slice(0, 8); // Limit to 8 for better visibility\n  \n  const chartSize = 300;\n  const centerX = chartSize / 2;\n  const centerY = chartSize / 2;\n  const radius = 80;\n  const labelRadius = radius + 35;\n  \n  // Calculate angles for only the nutrients we're displaying\n  const totalAxes = displayNutrients.length;\n  const angleStep = (2 * Math.PI) / totalAxes;\n\n  // Calculate max value for scaling (using only displayed nutrients)\n  const maxValue = Math.max(...displayNutrients.map(key => \n    parseFloat(micronutrients[key]?.value || 0)\n  ));\n\n  // Generate axis lines only for displayed nutrients\n  const axisLines = displayNutrients.map((key, index) => {\n    const angle = index * angleStep - Math.PI / 2; // Start from top\n    return {\n      x1: centerX,\n      y1: centerY,\n      x2: centerX + Math.cos(angle) * radius,\n      y2: centerY + Math.sin(angle) * radius,\n      label: micronutrientMapping[key],\n      labelX: centerX + Math.cos(angle) * labelRadius,\n      labelY: centerY + Math.sin(angle) * labelRadius,\n      key: key,\n      angle: angle\n    };\n  });\n\n  // Generate data points for displayed nutrients\n  const dataPoints = displayNutrients.map((key, index) => {\n    const angle = index * angleStep - Math.PI / 2;\n    const value = parseFloat(micronutrients[key]?.value || 0);\n    const normalizedValue = maxValue > 0 ? Math.min(value / maxValue, 1) : 0; // Cap at 100%\n    const pointRadius = normalizedValue * radius;\n    \n    return {\n      x: centerX + Math.cos(angle) * pointRadius,\n      y: centerY + Math.sin(angle) * pointRadius,\n      label: micronutrientMapping[key],\n      value: value,\n      unit: micronutrients[key]?.unit || 'mg',\n      angle: angle,\n      normalizedValue: normalizedValue,\n      axisIndex: index\n    };\n  });\n\n  // Create polygon path - FIXED to handle all cases properly\n  let polygonPath = '';\n  if (dataPoints.length >= 3) {\n    // Create a proper closed polygon for 3+ points\n    polygonPath = dataPoints\n      .map((point, index) => `${index === 0 ? 'M' : 'L'} ${point.x.toFixed(2)} ${point.y.toFixed(2)}`)\n      .join(' ') + ' Z';\n  } else if (dataPoints.length === 2) {\n    // For 2 points, draw a line segment\n    polygonPath = `M ${dataPoints[0].x.toFixed(2)} ${dataPoints[0].y.toFixed(2)} L ${dataPoints[1].x.toFixed(2)} ${dataPoints[1].y.toFixed(2)}`;\n  }\n\n  // Generate concentric circles for scale\n  const scaleCircles = [0.25, 0.5, 0.75, 1.0].map(scale => ({\n    r: radius * scale,\n    opacity: scale === 1.0 ? 0.4 : 0.2\n  }));\n\n  return (\n    <div className=\"micronutrient-radar-container\">\n      <h4> Micronutrient Profile</h4>\n      \n      <div className=\"radar-chart-wrapper\">\n        <svg width={chartSize} height={chartSize} className=\"radar-chart\">\n          {/* Background circles */}\n          {scaleCircles.map((circle, index) => (\n            <circle\n              key={index}\n              cx={centerX}\n              cy={centerY}\n              r={circle.r}\n              fill=\"none\"\n              stroke=\"#e0e0e0\"\n              strokeWidth=\"1\"\n              opacity={circle.opacity}\n            />\n          ))}\n          \n          {/* Axis lines */}\n          {axisLines.map((line, index) => (\n            <line\n              key={index}\n              x1={line.x1}\n              y1={line.y1}\n              x2={line.x2}\n              y2={line.y2}\n              stroke=\"#ccc\"\n              strokeWidth=\"1\"\n              opacity=\"0.7\"\n            />\n          ))}\n          \n          {/* Data polygon/line - only render if we have valid path */}\n          {polygonPath && dataPoints.length >= 3 && (\n            <path\n              d={polygonPath}\n              fill=\"rgba(54, 162, 235, 0.3)\"\n              stroke=\"rgba(54, 162, 235, 0.8)\"\n              strokeWidth=\"2\"\n              strokeLinejoin=\"round\"\n            />\n          )}\n          \n          {/* For 2 points, draw a line with different styling */}\n          {polygonPath && dataPoints.length === 2 && (\n            <path\n              d={polygonPath}\n              fill=\"none\"\n              stroke=\"rgba(54, 162, 235, 0.8)\"\n              strokeWidth=\"3\"\n              strokeLinecap=\"round\"\n            />\n          )}\n          \n          {/* Data points */}\n          {dataPoints.map((point, index) => (\n            <circle\n              key={index}\n              cx={point.x}\n              cy={point.y}\n              r=\"4\"\n              fill=\"rgba(54, 162, 235, 0.9)\"\n              stroke=\"white\"\n              strokeWidth=\"2\"\n            />\n          ))}\n          \n          {/* Labels with better positioning */}\n          {axisLines.map((line, index) => {\n            const isRightSide = line.labelX > centerX + 10;\n            const isLeftSide = line.labelX < centerX - 10;\n            const isTopHalf = line.labelY < centerY;\n            \n            let textAnchor = \"middle\";\n            if (isRightSide) {\n              textAnchor = \"start\";\n            } else if (isLeftSide) {\n              textAnchor = \"end\";\n            }\n            \n            let dominantBaseline = \"middle\";\n            if (Math.abs(line.labelX - centerX) < 15) {\n              dominantBaseline = isTopHalf ? \"auto\" : \"hanging\";\n            }\n            \n            return (\n              <text\n                key={index}\n                x={line.labelX}\n                y={line.labelY}\n                textAnchor={textAnchor}\n                dominantBaseline={dominantBaseline}\n                fontSize=\"11\"\n                fill=\"#666\"\n                className=\"radar-label\"\n                style={{ fontWeight: 500 }}\n              >\n                {line.label}\n              </text>\n            );\n          })}\n        </svg>\n      </div>\n      \n      {/* Micronutrient values list */}\n      <div className=\"micronutrient-values\">\n        <h5> Detailed Values</h5>\n        <div className=\"micronutrient-grid\">\n          {dataPoints.map((point, index) => (\n            <div key={index} className=\"micronutrient-item\">\n              <span className=\"nutrient-name\">{point.label}:</span>\n              <span className=\"nutrient-value\">\n                {point.value < 1 ? point.value.toFixed(2) : point.value.toFixed(1)} {point.unit}\n              </span>\n            </div>\n          ))}\n        </div>\n        \n        {availableMicronutrients.length > displayNutrients.length && (\n          <div className=\"additional-nutrients\">\n            <small>\n              +{availableMicronutrients.length - displayNutrients.length} more nutrients available\n            </small>\n          </div>\n        )}\n      </div>\n      \n      <style jsx>{`\n        .micronutrient-radar-container {\n          background: white;\n          border-radius: 12px;\n          padding: 20px;\n          margin: 20px 0;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n          border: 1px solid #e1e5e9;\n        }\n        \n        .micronutrient-radar-container h4 {\n          margin: 0 0 16px 0;\n          color: #2c3e50;\n          font-size: 16px;\n          font-weight: 600;\n        }\n        \n        .radar-chart-wrapper {\n          display: flex;\n          justify-content: center;\n          margin-bottom: 20px;\n        }\n        \n        .radar-chart {\n          background: #fafafa;\n          border-radius: 8px;\n        }\n        \n        .radar-label {\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n          font-weight: 500;\n        }\n        \n        .no-micronutrients {\n          text-align: center;\n          padding: 40px 20px;\n          color: #666;\n        }\n        \n        .no-data-icon {\n          font-size: 48px;\n          margin-bottom: 16px;\n        }\n        \n        .data-note {\n          font-size: 14px;\n          color: #888;\n          margin-top: 12px;\n        }\n        \n        .micronutrient-values h5 {\n          margin: 0 0 12px 0;\n          color: #34495e;\n          font-size: 14px;\n          font-weight: 600;\n        }\n        \n        .micronutrient-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));\n          gap: 8px;\n          margin-bottom: 12px;\n        }\n        \n        .micronutrient-item {\n          display: flex;\n          justify-content: space-between;\n          padding: 6px 12px;\n          background: #f8f9fa;\n          border-radius: 6px;\n          font-size: 13px;\n        }\n        \n        .nutrient-name {\n          color: #495057;\n          font-weight: 500;\n        }\n        \n        .nutrient-value {\n          color: #2c3e50;\n          font-weight: 600;\n        }\n        \n        .additional-nutrients {\n          text-align: center;\n          padding: 8px;\n          color: #6c757d;\n          font-style: italic;\n        }\n        \n        @media (max-width: 768px) {\n          .micronutrient-radar-container {\n            padding: 16px;\n          }\n          \n          .micronutrient-grid {\n            grid-template-columns: 1fr;\n          }\n        }\n      `}</style>\n    </div>\n  );\n};\n\nexport default MicronutrientRadarChart;","import React, { useState,  useMemo } from 'react';\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, ReferenceLine } from 'recharts';\nimport _ from 'lodash';\n\nconst VitaminTimeSeriesTab = ({ foodLog = [], userProfile = {} }) => {\n  const [selectedVitamins, setSelectedVitamins] = useState(['vitamin_c', 'vitamin_d', 'iron', 'calcium']);\n  const [timeRange, setTimeRange] = useState(30); // days\n  const [groupBy, setGroupBy] = useState('day'); // day, week, month\n  const [showRecommended, setShowRecommended] = useState(true);\n  //const [selectedUnit, setSelectedUnit] = useState('mg'); // mg, mcg, IU\n\n  // Vitamin reference values (daily recommended intake)\n  const vitaminRecommendations = {\n    vitamin_a: { value: 900, unit: 'mcg', female: 700, male: 900 },\n    vitamin_c: { value: 90, unit: 'mg', female: 75, male: 90 },\n    vitamin_d: { value: 20, unit: 'mcg', female: 15, male: 15 },\n    vitamin_e: { value: 15, unit: 'mg', female: 15, male: 15 },\n    vitamin_k: { value: 120, unit: 'mcg', female: 90, male: 120 },\n    thiamine: { value: 1.2, unit: 'mg', female: 1.1, male: 1.2 },\n    riboflavin: { value: 1.3, unit: 'mg', female: 1.1, male: 1.3 },\n    niacin: { value: 16, unit: 'mg', female: 14, male: 16 },\n    vitamin_b6: { value: 1.7, unit: 'mg', female: 1.3, male: 1.7 },\n    folate: { value: 400, unit: 'mcg', female: 400, male: 400 },\n    vitamin_b12: { value: 2.4, unit: 'mcg', female: 2.4, male: 2.4 },\n    biotin: { value: 30, unit: 'mcg', female: 30, male: 30 },\n    pantothenic_acid: { value: 5, unit: 'mg', female: 5, male: 5 },\n    calcium: { value: 1000, unit: 'mg', female: 1000, male: 1000 },\n    iron: { value: 8, unit: 'mg', female: 18, male: 8 },\n    magnesium: { value: 420, unit: 'mg', female: 320, male: 420 },\n    zinc: { value: 11, unit: 'mg', female: 8, male: 11 },\n    selenium: { value: 55, unit: 'mcg', female: 55, male: 55 },\n    phosphorus: { value: 700, unit: 'mg', female: 700, male: 700 },\n    potassium: { value: 3500, unit: 'mg', female: 2600, male: 3400 },\n    sodium: { value: 2300, unit: 'mg', female: 2300, male: 2300 },\n    copper: { value: 0.9, unit: 'mg', female: 0.9, male: 0.9 },\n    manganese: { value: 2.3, unit: 'mg', female: 1.8, male: 2.3 },\n    chromium: { value: 35, unit: 'mcg', female: 25, male: 35 },\n    molybdenum: { value: 45, unit: 'mcg', female: 45, male: 45 }\n  };\n\n  // Available vitamins from food log\n  const availableVitamins = useMemo(() => {\n    if (!foodLog || !Array.isArray(foodLog)) return [];\n    \n    const vitamins = new Set();\n    foodLog.forEach(entry => {\n      if (entry && entry.micronutrients && typeof entry.micronutrients === 'object') {\n        Object.keys(entry.micronutrients).forEach(vitamin => {\n          vitamins.add(vitamin);\n        });\n      }\n    });\n    return Array.from(vitamins).sort();\n  }, [foodLog]);\n\n  // Process time series data\n  const timeSeriesData = useMemo(() => {\n    if (!foodLog || !Array.isArray(foodLog) || foodLog.length === 0) return [];\n\n    // Helper function to parse local date correctly (inline)\n    const parseLocalDate = (dateString) => {\n      if (!dateString) return null;\n      const parts = dateString.split('-');\n      if (parts.length === 3) {\n        const year = parseInt(parts[0], 10);\n        const month = parseInt(parts[1], 10) - 1; // Month is 0-indexed\n        const day = parseInt(parts[2], 10);\n        return new Date(year, month, day);\n      }\n      return new Date(dateString);\n    };\n\n    // Filter by time range\n    const cutoffDate = new Date();\n    cutoffDate.setDate(cutoffDate.getDate() - timeRange);\n\n    const filteredLog = foodLog.filter(entry => {\n      if (!entry || !entry.date) return false;\n      const entryDate = parseLocalDate(entry.date);\n      return entryDate >= cutoffDate && !isNaN(entryDate.getTime());\n    });\n\n    if (filteredLog.length === 0) return [];\n\n    // Group by time period\n    const groupedData = _(filteredLog)\n      .groupBy(entry => {\n        const date = parseLocalDate(entry.date);\n        switch (groupBy) {\n          case 'week':\n            const weekStart = new Date(date);\n            weekStart.setDate(date.getDate() - date.getDay());\n            return weekStart.toISOString().split('T')[0];\n          case 'month':\n            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-01`;\n          default: // day\n            return entry.date;\n        }\n      })\n      .value();\n\n    // Calculate daily totals for each vitamin\n    const processedData = Object.entries(groupedData).map(([period, entries]) => {\n      const vitaminTotals = {};\n      \n      entries.forEach(entry => {\n        if (entry && entry.micronutrients && typeof entry.micronutrients === 'object') {\n          Object.entries(entry.micronutrients).forEach(([vitamin, data]) => {\n            if (!vitaminTotals[vitamin]) {\n              vitaminTotals[vitamin] = 0;\n            }\n            const value = data && typeof data === 'object' ? data.value : data;\n            vitaminTotals[vitamin] += parseFloat(value || 0);\n          });\n        }\n      });\n\n      return {\n        period,\n        date: parseLocalDate(period),\n        ...vitaminTotals,\n        entryCount: entries.length\n      };\n    });\n\n    return processedData.sort((a, b) => a.date - b.date);\n  }, [foodLog, timeRange, groupBy]);\n\n  // Get recommendation value for vitamin based on user profile\n  const getRecommendedValue = (vitamin) => {\n    const rec = vitaminRecommendations[vitamin];\n    if (!rec) return null;\n    \n    const gender = userProfile?.gender || 'female';\n    return rec[gender] || rec.value;\n  };\n\n  // Color palette for different vitamins\n  const vitaminColors = {\n    vitamin_a: '#FF6B6B',\n    vitamin_c: '#4ECDC4',\n    vitamin_d: '#45B7D1',\n    vitamin_e: '#96CEB4',\n    vitamin_k: '#FFEAA7',\n    thiamine: '#DDA0DD',\n    riboflavin: '#98D8C8',\n    niacin: '#F7DC6F',\n    vitamin_b6: '#BB8FCE',\n    folate: '#85C1E9',\n    vitamin_b12: '#F8C471',\n    biotin: '#82E0AA',\n    pantothenic_acid: '#F1948A',\n    calcium: '#AED6F1',\n    iron: '#CD853F',\n    magnesium: '#90EE90',\n    zinc: '#DEB887',\n    selenium: '#F0E68C',\n    phosphorus: '#DA70D6',\n    potassium: '#87CEEB',\n    sodium: '#FFB6C1',\n    copper: '#D2691E',\n    manganese: '#9370DB',\n    chromium: '#20B2AA',\n    molybdenum: '#FF69B4'\n  };\n\n  // Custom tooltip component\n  const CustomTooltip = ({ active, payload, label }) => {\n    if (active && payload && payload.length) {\n      // Parse the date correctly for display\n      let displayDate;\n      if (!label) {\n        displayDate = new Date();\n      } else if (label.includes('-')) {\n        const parts = label.split('-');\n        if (parts.length === 3) {\n          const year = parseInt(parts[0], 10);\n          const month = parseInt(parts[1], 10) - 1;\n          const day = parseInt(parts[2], 10);\n          displayDate = new Date(year, month, day);\n        } else {\n          displayDate = new Date(label);\n        }\n      } else {\n        displayDate = new Date(label);\n      }\n      \n      return (\n        <div className=\"custom-tooltip\" style={{\n          backgroundColor: 'rgba(255, 255, 255, 0.95)',\n          border: '1px solid #ccc',\n          borderRadius: '8px',\n          padding: '12px',\n          boxShadow: '0 4px 8px rgba(0,0,0,0.1)'\n        }}>\n          <p style={{ margin: '0 0 8px 0', fontWeight: 'bold' }}>\n            {displayDate.toLocaleDateString()}\n          </p>\n          {payload.map((entry) => {\n            const rec = getRecommendedValue(entry.dataKey);\n            const percentage = rec ? ((entry.value / rec) * 100).toFixed(1) : null;\n            const unit = vitaminRecommendations[entry.dataKey]?.unit || '';\n            \n            return (\n              <p key={entry.dataKey} style={{ \n                margin: '4px 0', \n                color: entry.color,\n                fontSize: '14px'\n              }}>\n                <strong>{entry.dataKey.replace(/_/g, ' ').toUpperCase()}:</strong> {entry.value?.toFixed(2)} {unit}\n                {percentage && (\n                  <span style={{ marginLeft: '8px', fontSize: '12px', opacity: 0.8 }}>\n                    ({percentage}% of RDA)\n                  </span>\n                )}\n              </p>\n            );\n          })}\n        </div>\n      );\n    }\n    return null;\n  };\n\n  // Handle vitamin selection\n  const handleVitaminToggle = (vitamin) => {\n    setSelectedVitamins(prev => \n      prev.includes(vitamin) \n        ? prev.filter(v => v !== vitamin)\n        : [...prev, vitamin]\n    );\n  };\n\n  // Preset vitamin groups\n  const vitaminGroups = {\n    'Water Soluble': ['vitamin_c', 'thiamine', 'riboflavin', 'niacin', 'vitamin_b6', 'folate', 'vitamin_b12', 'biotin', 'pantothenic_acid'],\n    'Fat Soluble': ['vitamin_a', 'vitamin_d', 'vitamin_e', 'vitamin_k'],\n    'Major Minerals': ['calcium', 'phosphorus', 'magnesium', 'sodium', 'potassium'],\n    'Trace Minerals': ['iron', 'zinc', 'copper', 'manganese', 'selenium', 'chromium', 'molybdenum']\n  };\n\n  const selectVitaminGroup = (groupName) => {\n    const group = vitaminGroups[groupName];\n    const availableInGroup = group.filter(v => availableVitamins.includes(v));\n    setSelectedVitamins(availableInGroup);\n  };\n\n  return (\n    <div className=\"vitamin-timeseries-tab\" style={{ padding: '20px' }}>\n      <div style={{ marginBottom: '24px' }}>\n        <h3 style={{ marginBottom: '16px', color: '#2c3e50' }}>\n           Nutrient Trends Over Time\n        </h3>\n        \n        {/* Controls */}\n        <div style={{ \n          display: 'grid', \n          gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', \n          gap: '16px',\n          marginBottom: '20px',\n          padding: '16px',\n          backgroundColor: '#f8f9fa',\n          borderRadius: '8px'\n        }}>\n          {/* Time Range */}\n          <div>\n            <label style={{ display: 'block', marginBottom: '8px', fontWeight: 'bold' }}>\n              Time Range:\n            </label>\n            <select \n              value={timeRange} \n              onChange={(e) => setTimeRange(Number(e.target.value))}\n              style={{\n                width: '100%',\n                padding: '8px',\n                borderRadius: '4px',\n                border: '1px solid #ddd'\n              }}\n            >\n              <option value={7}>Last 7 days</option>\n              <option value={14}>Last 2 weeks</option>\n              <option value={30}>Last 30 days</option>\n              <option value={60}>Last 2 months</option>\n              <option value={90}>Last 3 months</option>\n              <option value={180}>Last 6 months</option>\n            </select>\n          </div>\n\n          {/* Group By */}\n          <div>\n            <label style={{ display: 'block', marginBottom: '8px', fontWeight: 'bold' }}>\n              Group By:\n            </label>\n            <select \n              value={groupBy} \n              onChange={(e) => setGroupBy(e.target.value)}\n              style={{\n                width: '100%',\n                padding: '8px',\n                borderRadius: '4px',\n                border: '1px solid #ddd'\n              }}\n            >\n              <option value=\"day\">Daily</option>\n              <option value=\"week\">Weekly</option>\n              <option value=\"month\">Monthly</option>\n            </select>\n          </div>\n\n          {/* Show Recommended Lines */}\n          <div>\n            <label style={{ display: 'flex', alignItems: 'center', marginTop: '32px' }}>\n              <input \n                type=\"checkbox\" \n                checked={showRecommended}\n                onChange={(e) => setShowRecommended(e.target.checked)}\n                style={{ marginRight: '8px' }}\n              />\n              Show recommended intake lines\n            </label>\n          </div>\n        </div>\n\n        {/* Vitamin Group Presets */}\n        <div style={{ marginBottom: '20px' }}>\n          <label style={{ display: 'block', marginBottom: '8px', fontWeight: 'bold' }}>\n            Quick Select:\n          </label>\n          <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>\n            {Object.keys(vitaminGroups).map(groupName => (\n              <button\n                key={groupName}\n                onClick={() => selectVitaminGroup(groupName)}\n                style={{\n                  padding: '6px 12px',\n                  borderRadius: '4px',\n                  border: '1px solid #007bff',\n                  backgroundColor: 'white',\n                  color: '#007bff',\n                  cursor: 'pointer',\n                  fontSize: '12px'\n                }}\n                onMouseOver={(e) => e.target.style.backgroundColor = '#007bff'}\n                onMouseOut={(e) => e.target.style.backgroundColor = 'white'}\n              >\n                {groupName}\n              </button>\n            ))}\n            <button\n              onClick={() => setSelectedVitamins([])}\n              style={{\n                padding: '6px 12px',\n                borderRadius: '4px',\n                border: '1px solid #dc3545',\n                backgroundColor: 'white',\n                color: '#dc3545',\n                cursor: 'pointer',\n                fontSize: '12px'\n              }}\n            >\n              Clear All\n            </button>\n          </div>\n        </div>\n\n        {/* Vitamin Selection */}\n        <div style={{ marginBottom: '24px' }}>\n          <label style={{ display: 'block', marginBottom: '8px', fontWeight: 'bold' }}>\n            Select Vitamins/Minerals to Track ({selectedVitamins.length} selected):\n          </label>\n          <div style={{ \n            display: 'grid', \n            gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))',\n            gap: '8px',\n            maxHeight: '150px',\n            overflowY: 'auto',\n            padding: '8px',\n            border: '1px solid #ddd',\n            borderRadius: '4px',\n            backgroundColor: 'white'\n          }}>\n            {availableVitamins.map(vitamin => (\n              <label key={vitamin} style={{ \n                display: 'flex', \n                alignItems: 'center',\n                padding: '4px',\n                cursor: 'pointer',\n                fontSize: '14px'\n              }}>\n                <input \n                  type=\"checkbox\"\n                  checked={selectedVitamins.includes(vitamin)}\n                  onChange={() => handleVitaminToggle(vitamin)}\n                  style={{ marginRight: '8px' }}\n                />\n                <span style={{ color: vitaminColors[vitamin] || '#666' }}>\n                   {vitamin.replace(/_/g, ' ').toUpperCase()}\n                </span>\n                {vitaminRecommendations[vitamin] && (\n                  <span style={{ marginLeft: '4px', fontSize: '11px', color: '#666' }}>\n                    (RDA: {getRecommendedValue(vitamin)} {vitaminRecommendations[vitamin].unit})\n                  </span>\n                )}\n              </label>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      {/* Chart */}\n      {timeSeriesData.length > 0 && selectedVitamins.length > 0 ? (\n        <div style={{ height: '500px', width: '100%' }}>\n          <ResponsiveContainer>\n            <LineChart data={timeSeriesData}>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e0e0e0\" />\n              <XAxis \n                dataKey=\"period\"\n                tickFormatter={(value) => {\n                  // Handle date formatting correctly for local timezone\n                  if (!value) return '';\n                  if (value.includes('-')) {\n                    const parts = value.split('-');\n                    if (parts.length === 3) {\n                      const year = parseInt(parts[0], 10);\n                      const month = parseInt(parts[1], 10) - 1;\n                      const day = parseInt(parts[2], 10);\n                      const date = new Date(year, month, day);\n                      return date.toLocaleDateString();\n                    }\n                  }\n                  return new Date(value).toLocaleDateString();\n                }}\n                stroke=\"#666\"\n              />\n              <YAxis stroke=\"#666\" />\n              <Tooltip content={<CustomTooltip />} />\n              <Legend />\n\n              {selectedVitamins.map(vitamin => (\n                <Line\n                  key={vitamin}\n                  type=\"monotone\"\n                  dataKey={vitamin}\n                  stroke={vitaminColors[vitamin] || '#666'}\n                  strokeWidth={2}\n                  dot={{ fill: vitaminColors[vitamin] || '#666', strokeWidth: 2, r: 4 }}\n                  connectNulls={false}\n                  name={vitamin.replace(/_/g, ' ').toUpperCase()}\n                />\n              ))}\n\n              {/* Recommended intake reference lines */}\n              {showRecommended && selectedVitamins.map(vitamin => {\n                const recommendedValue = getRecommendedValue(vitamin);\n                return recommendedValue ? (\n                  <ReferenceLine\n                    key={`${vitamin}-ref`}\n                    y={recommendedValue}\n                    stroke={vitaminColors[vitamin] || '#666'}\n                    strokeDasharray=\"5 5\"\n                    strokeOpacity={0.5}\n                    label={{ \n                      value: `${vitamin.replace(/_/g, ' ').toUpperCase()} RDA`, \n                      position: 'topRight',\n                      fontSize: 10\n                    }}\n                  />\n                ) : null;\n              })}\n            </LineChart>\n          </ResponsiveContainer>\n        </div>\n      ) : (\n        <div style={{ \n          textAlign: 'center', \n          padding: '40px',\n          backgroundColor: '#f8f9fa',\n          borderRadius: '8px',\n          color: '#666'\n        }}>\n          {timeSeriesData.length === 0 ? (\n            <p>No food data available for the selected time range.</p>\n          ) : (\n            <p>Please select at least one vitamin or mineral to display the chart.</p>\n          )}\n        </div>\n      )}\n\n      {/* Summary Stats */}\n      {selectedVitamins.length > 0 && timeSeriesData.length > 0 && (\n        <div style={{ marginTop: '24px' }}>\n          <h4 style={{ marginBottom: '16px' }}>Summary Statistics</h4>\n          <div style={{ \n            display: 'grid', \n            gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',\n            gap: '16px'\n          }}>\n            {selectedVitamins.map(vitamin => {\n              const values = timeSeriesData\n                .map(d => d[vitamin])\n                .filter(v => v !== undefined && v !== null);\n              \n              if (values.length === 0) return null;\n\n              const avg = values.reduce((sum, val) => sum + val, 0) / values.length;\n              const max = Math.max(...values);\n              const min = Math.min(...values);\n              const recommended = getRecommendedValue(vitamin);\n              const avgPercentage = recommended ? ((avg / recommended) * 100).toFixed(1) : null;\n              const isPersonalized = vitaminRecommendations[vitamin]?.isPersonalized;\n\n              return (\n                <div key={vitamin} style={{\n                  padding: '16px',\n                  border: '1px solid #ddd',\n                  borderRadius: '8px',\n                  backgroundColor: 'white'\n                }}>\n                  <h5 style={{ \n                    margin: '0 0 8px 0',\n                    color: vitaminColors[vitamin] || '#666'\n                  }}>\n                    {vitamin.replace(/_/g, ' ').toUpperCase()}\n                  </h5>\n                  <div style={{ fontSize: '14px' }}>\n                    <div>Average: <strong>{avg.toFixed(2)} {vitaminRecommendations[vitamin]?.unit}</strong></div>\n                    <div>Range: {min.toFixed(2)} - {max.toFixed(2)} {vitaminRecommendations[vitamin]?.unit}</div>\n                    {recommended && (\n                      <>\n                        <div>\n                          {isPersonalized ? 'Personalized RDA' : 'RDA'}: {recommended} {vitaminRecommendations[vitamin]?.unit}\n                          {isPersonalized && <span style={{ color: '#2196f3', fontWeight: 'bold' }}>*</span>}\n                        </div>\n                        <div style={{ \n                          color: parseFloat(avgPercentage) >= 100 ? '#28a745' : \n                                 parseFloat(avgPercentage) >= 75 ? '#ffc107' : '#dc3545'\n                        }}>\n                          Average intake: <strong>{avgPercentage}% of {isPersonalized ? 'personalized' : 'standard'} RDA</strong>\n                        </div>\n                      </>\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n\n      {/* Personalization Notice */}\n      {Object.values(vitaminRecommendations).some(v => v.isPersonalized) && (\n        <div style={{\n          marginTop: '20px',\n          padding: '16px',\n          backgroundColor: '#e3f2fd',\n          borderRadius: '8px',\n          border: '1px solid #2196f3'\n        }}>\n          <h4 style={{ margin: '0 0 8px 0', color: '#1565c0', fontSize: '16px' }}>\n             Personalized Recommendations\n          </h4>\n          <p style={{ margin: '0 0 12px 0', fontSize: '14px', color: '#1976d2' }}>\n            Values marked with <span style={{ fontWeight: 'bold', color: '#2196f3' }}>*</span> have been \n            personalized based on your profile:\n          </p>\n          <ul style={{ margin: '0', paddingLeft: '20px', fontSize: '13px', color: '#1976d2' }}>\n            {userProfile?.gender === 'female' && (\n              <li>Gender-specific adjustments (e.g., higher iron needs for women)</li>\n            )}\n            {userProfile?.age && (userProfile.age >= 50 || userProfile.age <= 18) && (\n              <li>Age-based modifications (e.g., increased vitamin D for elderly)</li>\n            )}\n            {(userProfile?.hasLongCovid || userProfile?.longCovidSeverity) && (\n              <li>Long COVID severity adjustments for immune support nutrients</li>\n            )}\n            {(userProfile?.activityLevel === 'high' || userProfile?.activityLevel === 'very_high') && (\n              <li>Enhanced requirements for active lifestyle</li>\n            )}\n          </ul>\n          {(userProfile?.hasLongCovid || userProfile?.longCovidSeverity) && (\n            <div style={{ \n              marginTop: '12px', \n              padding: '8px', \n              backgroundColor: '#fff3e0', \n              borderRadius: '4px',\n              fontSize: '12px',\n              color: '#e65100'\n            }}>\n              <strong>Long COVID Note:</strong> Recommendations for vitamin C, D, zinc, and selenium \n              have been increased based on your severity level to support immune function and recovery.\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default VitaminTimeSeriesTab;","import React, { useState, useEffect, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { \n  collection, \n  query, \n  getDocs, \n  addDoc, \n  deleteDoc,\n  updateDoc,\n  doc,\n  getDoc,\n  Timestamp, \n  orderBy, \n  limit\n} from 'firebase/firestore';\nimport { db } from '../../firebase-config';\nimport \"../Common.css\";\nimport './FoodTrackerPage.css';\n\n// Import separated tab components\nimport AddFoodTab from './AddFoodTab';\nimport FoodJournalTab from './FoodJournalTab';\nimport { AnalysisTab } from './FoodTrackerAnalysis';\nimport MicronutrientRadarChart from './MicronutrientRadarChart';\nimport VitaminTimeSeriesTab from './VitaminTimeSeriesTab'; // ADD THIS LINE\n\n// TIMEZONE UTILITIES - Centralized timezone handling\nconst getUserTimezone = () => {\n  return Intl.DateTimeFormat().resolvedOptions().timeZone;\n};\n\nconst getTodayInUserTimezone = () => {\n  const userTimezone = getUserTimezone();\n  const today = new Date();\n  \n  const formatter = new Intl.DateTimeFormat('en-CA', { \n    timeZone: userTimezone,\n    year: 'numeric',\n    month: '2-digit', \n    day: '2-digit'\n  });\n  \n  const parts = formatter.formatToParts(today);\n  const year = parts.find(part => part.type === 'year').value;\n  const month = parts.find(part => part.type === 'month').value;\n  const day = parts.find(part => part.type === 'day').value;\n  \n  return `${year}-${month}-${day}`;\n};\n\nconst getDaysAgoInUserTimezone = (daysAgo) => {\n  const userTimezone = getUserTimezone();\n  const date = new Date();\n  date.setDate(date.getDate() - daysAgo);\n  \n  const formatter = new Intl.DateTimeFormat('en-CA', { \n    timeZone: userTimezone,\n    year: 'numeric',\n    month: '2-digit', \n    day: '2-digit'\n  });\n  \n  const parts = formatter.formatToParts(date);\n  const year = parts.find(part => part.type === 'year').value;\n  const month = parts.find(part => part.type === 'month').value;\n  const day = parts.find(part => part.type === 'day').value;\n  \n  return `${year}-${month}-${day}`;\n};\n\nconst parseLocalDate = (dateString) => {\n  if (!dateString) return null;\n  \n  const parts = dateString.split('-');\n  if (parts.length === 3) {\n    const year = parseInt(parts[0], 10);\n    const month = parseInt(parts[1], 10) - 1;\n    const day = parseInt(parts[2], 10);\n    \n    return new Date(year, month, day);\n  }\n  \n  return new Date(dateString);\n};\n\nconst formatDateHeader = (dateString) => {\n  if (!dateString) return '';\n\n  try {\n    const date = parseLocalDate(dateString);\n    if (!date || isNaN(date.getTime())) return dateString;\n\n    const today = getTodayInUserTimezone();\n    const yesterday = getDaysAgoInUserTimezone(1);\n\n    const options = { \n      weekday: 'long', \n      year: 'numeric', \n      month: 'long', \n      day: 'numeric',\n      timeZone: getUserTimezone()\n    };\n    \n    const formattedDate = date.toLocaleDateString('en-US', options);\n\n    if (dateString === today) {\n      return `Today - ${formattedDate}`;\n    } else if (dateString === yesterday) {\n      return `Yesterday - ${formattedDate}`;\n    } else {\n      return formattedDate;\n    }\n  } catch (error) {\n    console.warn('Error formatting date header:', error);\n    return dateString;\n  }\n};\n\n// MAIN COMPONENT CONSTANTS\nconst mealTypes = ['Breakfast', 'Morning Snack', 'Lunch', 'Afternoon Snack', 'Dinner', 'Late Night Snack'];\nconst TABS = ['Add Food', 'Food Journal', 'Analysis','Trends'];\nconst ENTRIES_PER_PAGE = 20;\n\nfunction FoodTrackerPage() {\n  const navigate = useNavigate();\n\n  // State declarations\n  const [allFoodsCache, setAllFoodsCache] = useState([]);\n  const [pyodideStatus] = useState('unavailable');\n  const [searchFocused, setSearchFocused] = useState(false);\n\n  // User and authentication state\n  const [currentUser, setCurrentUser] = useState(null);\n  const [userProfile, setUserProfile] = useState({\n    age: 30,\n    gender: 'female',\n    weight: 65,\n    height: 165,\n    activityLevel: 'moderate',\n    hasLongCovid: false,\n    longCovidSeverity: 'moderate'\n  });\n  const [authLoading, setAuthLoading] = useState(true);\n\n  // UI state\n  const [tab, setTab] = useState('Add Food');\n\n  // Add Food state\n  const [search, setSearch] = useState('');\n  const [suggestions, setSuggestions] = useState([]);\n  const [selectedMeal, setSelectedMeal] = useState(null);\n  const [fields, setFields] = useState({});\n  const [mealType, setMealType] = useState('Breakfast');\n  const [time, setTime] = useState(() => new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }));\n  const [date, setDate] = useState(() => getTodayInUserTimezone());\n  const [longCovidAdjust, setLongCovidAdjust] = useState(true);\n  const [loading, setLoading] = useState(false);\n  const [success, setSuccess] = useState('');\n  const [error, setError] = useState('');\n\n  // Food Journal state\n  const [foodLog, setFoodLog] = useState([]);\n  const [logLoading, setLogLoading] = useState(false);\n  const [journalError, setJournalError] = useState('');\n  const [journalPage, setJournalPage] = useState(1);\n\n  // Edit/Delete state\n  const [editingEntry, setEditingEntry] = useState(null);\n  const [deleteConfirmId, setDeleteConfirmId] = useState(null);\n  const [deleteLoading, setDeleteLoading] = useState(false);\n\n  // Suggestion cache for performance\n  const [suggestionCache, setSuggestionCache] = useState({});\n\n  // Debounce hook for search\n  const useDebounce = (value, delay) => {\n    const [debouncedValue, setDebouncedValue] = useState(value);\n\n    useEffect(() => {\n      const handler = setTimeout(() => {\n        setDebouncedValue(value);\n      }, delay);\n\n      return () => clearTimeout(handler);\n    }, [value, delay]);\n\n    return debouncedValue;\n  };\n\n  const debouncedSearch = useDebounce(search, 300);\n\n  // Handle logout\n  const handleLogout = async () => {\n    console.log('Logout clicked - starting complete logout process');\n\n    try {\n      localStorage.removeItem('userData');\n      sessionStorage.clear();\n      setCurrentUser(null);\n      setAuthLoading(false);\n      navigate('/login', { replace: true });\n    } catch (error) {\n      console.error('Error during logout:', error);\n      localStorage.removeItem('userData');\n      sessionStorage.clear();\n      setCurrentUser(null);\n      navigate('/login', { replace: true });\n    }\n  };\n\n  // Handle delete entry\n  const handleDeleteEntry = async (entryId) => {\n    if (!currentUser || !entryId) return;\n\n    setDeleteLoading(true);\n    setJournalError('');\n\n    try {\n      await deleteDoc(doc(db, 'users', currentUser.id, 'food_journal', entryId));\n      setFoodLog(prevLog => prevLog.filter(entry => entry.id !== entryId));\n      setSuccess('Food entry deleted successfully!');\n      setTimeout(() => setSuccess(''), 3000);\n    } catch (err) {\n      console.error('Error deleting entry:', err);\n      setJournalError(`Failed to delete entry: ${err.message}`);\n    } finally {\n      setDeleteLoading(false);\n      setDeleteConfirmId(null);\n    }\n  };\n\n  // Handle edit entry\n  const handleEditEntry = (entry) => {\n    setFields({\n      name: entry.name,\n      protein: entry.protein,\n      carbs: entry.carbs,\n      fat: entry.fat,\n      calories: entry.calories,\n      serving: entry.serving || 100,\n      micronutrients: entry.micronutrients || {},\n      longCovidBenefits: entry.longCovidBenefits || [],\n      longCovidCautions: entry.longCovidCautions || [],\n      longCovidRelevance: entry.longCovidRelevance || {},\n    });\n\n    setMealType(entry.mealType);\n    setTime(entry.time);\n    setDate(entry.date);\n    setLongCovidAdjust(entry.longCovidAdjust || false);\n    setSearch(entry.name);\n    setEditingEntry(entry);\n    \n    const originalMeal = allFoodsCache.find(meal => \n      meal.name.toLowerCase() === entry.name.toLowerCase() || \n      meal.id === entry.mealId\n    );\n    \n    if (originalMeal) {\n      setSelectedMeal(originalMeal);\n      console.log('Original meal found for editing:', originalMeal.name);\n    } else {\n      const mockMeal = {\n        name: entry.name,\n        nutritional_metrics: {\n          nutrients_per_100g: {\n            protein: { value: (entry.protein / (entry.serving || 100)) * 100 },\n            carbs: { value: (entry.carbs / (entry.serving || 100)) * 100 },\n            fat: { value: (entry.fat / (entry.serving || 100)) * 100 },\n            calories: { value: (entry.calories / (entry.serving || 100)) * 100 },\n          }\n        }\n      };\n      setSelectedMeal(mockMeal);\n      console.log('Created mock meal for editing:', entry.name);\n    }\n    \n    setTab('Add Food');\n  };\n\n  const handleLogFood = async () => {\n    console.log('=== LOGGING FOOD ===');\n    console.log('Date being saved:', date);\n\n    if (!currentUser || !currentUser.id) {\n      setError('Please log in to save your meals');\n      return;\n    }\n\n    setLoading(true);\n    setError('');\n    setSuccess('');\n\n    try {\n      if (!fields.name) {\n        throw new Error('Food name is required');\n      }\n\n      const entryData = {\n        name: fields.name,\n        protein: parseFloat(fields.protein) || 0,\n        carbs: parseFloat(fields.carbs) || 0,\n        fat: parseFloat(fields.fat) || 0,\n        calories: parseFloat(fields.calories) || 0,\n        serving: parseFloat(fields.serving) || 100,\n        micronutrients: fields.micronutrients || {},\n        mealType,\n        time,\n        date,\n        longCovidAdjust,\n        longCovidBenefits: fields.longCovidBenefits || [],\n        longCovidCautions: fields.longCovidCautions || [],\n        longCovidRelevance: fields.longCovidRelevance || {},\n        mealId: selectedMeal?.id || null\n      };\n\n      entryData.metabolicEfficiency = calculateMetabolicEfficiency(entryData);\n\n      if (editingEntry) {\n        await updateDoc(\n          doc(db, 'users', currentUser.id, 'food_journal', editingEntry.id), \n          {\n            ...entryData,\n            updatedAt: Timestamp.now()\n          }\n        );\n\n        setFoodLog(prevLog => \n          prevLog.map(entry => \n            entry.id === editingEntry.id \n              ? { ...entry, ...entryData, id: editingEntry.id }\n              : entry\n          )\n        );\n\n        setSuccess('Food entry updated successfully!');\n        setEditingEntry(null);\n      } else {\n        entryData.createdAt = Timestamp.now();\n\n        const docRef = await addDoc(\n          collection(db, 'users', currentUser.id, 'food_journal'), \n          entryData\n        );\n\n        const newEntry = { id: docRef.id, ...entryData };\n        setFoodLog(prevLog => [newEntry, ...prevLog]);\n        setSuccess('Food logged successfully!');\n      }\n\n      setFields({});\n      setSelectedMeal(null);\n      setSearch('');\n    } catch (err) {\n      console.error('Error logging food:', err);\n      setError(`Failed to ${editingEntry ? 'update' : 'log'} food: ${err.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Cancel edit mode\n  const handleCancelEdit = () => {\n    setEditingEntry(null);\n    setFields({});\n    setSelectedMeal(null);\n    setSearch('');\n    setSuccess('');\n    setError('');\n  };\n\n  // Fetch user profile from Firestore\n  const fetchUserProfile = async (uid) => {\n    try {\n      const userDocRef = doc(db, 'users', uid);\n      const userDoc = await getDoc(userDocRef);\n\n      if (userDoc.exists()) {\n        const userData = userDoc.data();\n        setUserProfile(userData);\n      } else {\n        console.log('No user profile found in database');\n        setUserProfile(null);\n      }\n    } catch (err) {\n      console.error(\"Error fetching user profile:\", err);\n      setError('Failed to load user profile');\n      setUserProfile(null);\n    }\n  };\n\n  // Authentication check function\n  const checkUserAuthentication = useCallback(async () => {\n    try {\n      const storedUserData = localStorage.getItem('userData');\n\n      if (!storedUserData) {\n        navigate('/login');\n        return;\n      }\n\n      const parsedUserData = JSON.parse(storedUserData);\n      setCurrentUser(parsedUserData);\n\n      if (parsedUserData.id) {\n        await fetchUserProfile(parsedUserData.id);\n      } else {\n        console.log('No user ID found - user profile not loaded');\n        setUserProfile(null);\n      }\n    } catch (error) {\n      console.error(\"Error checking authentication:\", error);\n      navigate('/login');\n    } finally {\n      setAuthLoading(false);\n    }\n  }, [navigate]);\n\n  // Authentication effect\n  useEffect(() => {\n    checkUserAuthentication();\n  }, [checkUserAuthentication]);\n\n  // Helper function for COVID food rating\n  const getCovidFoodRating = (foodName) => {\n    const foodLower = foodName.toLowerCase();\n\n    const beneficial = [\n      'salmon', 'mackerel', 'sardines', 'tuna', 'trout',\n      'blueberries', 'strawberries', 'raspberries', 'blackberries',\n      'spinach', 'kale', 'broccoli', 'brussels sprouts',\n      'walnuts', 'almonds', 'chia seeds', 'flax seeds',\n      'turmeric', 'ginger', 'garlic', 'onion',\n      'olive oil', 'avocado', 'sweet potato',\n      'green tea', 'dark chocolate'\n    ];\n\n    const caution = [\n      'processed meat', 'bacon', 'sausage', 'hot dog',\n      'french fries', 'fried chicken', 'fried',\n      'white bread', 'white rice', 'pastry',\n      'candy', 'soda', 'sugar', 'margarine',\n      'ice cream', 'chips'\n    ];\n\n    if (beneficial.some(food => foodLower.includes(food))) return 'beneficial';\n    if (caution.some(food => foodLower.includes(food))) return 'caution';\n    return 'neutral';\n  };\n\n  // Utility functions\n  const convertTo24Hour = (time12h) => {\n    if (!time12h) return '';\n\n    const [time, modifier] = time12h.split(' ');\n    if (!time || !modifier) return time12h;\n\n    let [hours, minutes] = time.split(':');\n\n    if (hours === '12') {\n      hours = '00';\n    }\n\n    if (modifier === 'PM') {\n      hours = String(parseInt(hours, 10) + 12);\n    }\n\n    hours = String(hours);\n\n    return `${hours.padStart(2, '0')}:${minutes}`;\n  };\n\n  const handleTimeChange = (e) => {\n    const time24 = e.target.value;\n    if (!time24) return;\n\n    const date = new Date(`2000-01-01T${time24}`);\n    const time12 = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n\n    setTime(time12);\n  };\n\n  // Calculate metabolic efficiency\n  const calculateMetabolicEfficiency = (mealData) => {\n    const timeStr = mealData.time;\n    const hourMatch = timeStr.match(/(\\d+):/);\n    const hour = hourMatch ? parseInt(hourMatch[1], 10) : 12;\n    const isPM = timeStr.toLowerCase().includes('pm');\n\n    let hour24 = hour;\n    if (isPM && hour !== 12) hour24 += 12;\n    if (!isPM && hour === 12) hour24 = 0;\n\n    const proteinFactor = (parseFloat(mealData.protein) || 0) * 0.2;\n    const carbFactor = (parseFloat(mealData.carbs) || 0) * 0.1;\n    const fatFactor = (parseFloat(mealData.fat) || 0) * 0.15;\n\n    let timeFactor = 1.0;\n    if (hour24 < 6 || hour24 > 20) {\n      timeFactor = 0.7;\n    } else if (hour24 >= 7 && hour24 <= 10) {\n      timeFactor = 1.2;\n    } else if (hour24 >= 17 && hour24 <= 19) {\n      timeFactor = 0.9;\n    }\n\n    const mealTypeFactors = {\n      'Breakfast': 1.3,\n      'Morning Snack': 0.9,\n      'Lunch': 1.1,\n      'Afternoon Snack': 0.8,\n      'Dinner': 0.9,\n      'Late Night Snack': 0.6,\n      'Snack': 0.8\n    };\n    const mealTypeFactor = mealTypeFactors[mealData.mealType] || 1.0;\n\n    const macroBalance = Math.min(100, (proteinFactor + carbFactor + fatFactor) * 10);\n    let efficiency = macroBalance * timeFactor * mealTypeFactor;\n\n    if (mealData.longCovidAdjust && userProfile?.hasLongCovid) {\n      const severityFactors = {\n        'mild': 0.95,\n        'moderate': 0.85,\n        'severe': 0.75,\n        'very severe': 0.65\n      };\n\n      const severityFactor = severityFactors[userProfile.longCovidSeverity] || 0.85;\n      efficiency *= severityFactor;\n\n      if (mealData.longCovidBenefits && mealData.longCovidBenefits.length > 0) {\n        efficiency *= 1.1;\n      }\n\n      if (mealData.longCovidCautions && mealData.longCovidCautions.length > 0) {\n        efficiency *= 0.9;\n      }\n    }\n\n    return Math.min(100, Math.max(0, efficiency));\n  };\n\n  // Enhanced handleSelectMeal function\n  const handleSelectMeal = (meal) => {\n    console.log('handleSelectMeal called with:', meal.name);\n    \n    setSelectedMeal(meal);\n    setSearch(meal.name);\n    setSuggestions([]);\n    setSearchFocused(false);\n    \n    const nutrients = meal.nutritional_metrics?.nutrients_per_100g || meal.nutrients?.per100g || {};\n    \n    let defaultServing = 100;\n    let defaultUnit = 'g';\n    let defaultDescription = '100g serving';\n    \n    if (meal.nutritional_metrics?.serving_options) {\n      const firstOption = Object.values(meal.nutritional_metrics.serving_options)[0];\n      if (firstOption?.weight) {\n        defaultServing = firstOption.weight;\n        defaultUnit = firstOption.unit || 'g';\n        defaultDescription = firstOption.description;\n      }\n    }\n\n    console.log('Setting default serving:', { defaultServing, defaultUnit, defaultDescription });\n\n    const ratio = calculateServingRatio(defaultServing, defaultUnit, meal);\n    \n    setFields({\n      name: meal.name,\n      protein: (nutrients.protein?.value * ratio).toFixed(1),\n      carbs: (nutrients.carbs?.value * ratio).toFixed(1),\n      fat: (nutrients.fat?.value * ratio).toFixed(1),\n      calories: (nutrients.calories?.value * ratio).toFixed(0),\n      serving: defaultServing,\n      servingUnit: defaultUnit,\n      servingDescription: defaultDescription,\n      micronutrients: nutrients,\n      longCovidBenefits: meal.longCovidBenefits || [],\n      longCovidCautions: meal.longCovidCautions || [],\n      longCovidRelevance: meal.longCovidRelevance || {},\n    });\n\n    setTimeout(() => {\n      setFields(prev => ({ ...prev }));\n    }, 50);\n  };\n\n  // Helper function to calculate serving ratio with unit conversion\n  const calculateServingRatio = (serving, unit = 'g', meal) => {\n    if (unit === 'ml') {\n      const density = getDensityForFood(meal?.name) || 1.0;\n      const weightInGrams = serving * density;\n      return weightInGrams / 100;\n    } else {\n      return serving / 100;\n    }\n  };\n\n  const getDensityForFood = (foodName) => {\n    if (!foodName || typeof foodName !== 'string') {\n      return 1.0;\n    }\n    \n    const foodLower = foodName.toLowerCase();\n    \n    const densityMap = {\n      'water': 1.0,\n      'milk': 1.03,\n      'cream': 1.0,\n      'oil': 0.92,\n      'juice': 1.05,\n      'soup': 1.0,\n      'broth': 1.0,\n      'stock': 1.0,\n      'coffee': 1.0,\n      'tea': 1.0,\n      'wine': 0.99,\n      'beer': 1.0,\n      'yogurt': 1.1,\n      'smoothie': 1.1,\n      'sauce': 1.1,\n      'syrup': 1.3,\n      'honey': 1.4\n    };\n    \n    for (const [key, density] of Object.entries(densityMap)) {\n      if (foodLower.includes(key)) {\n        return density;\n      }\n    }\n    \n    return 1.0;\n  };\n\n  // New function to handle serving selection from suggestions\n  const handleServingSelection = (weight, description, unit = 'g') => {\n    console.log('Serving selection:', { weight, description, unit });\n    \n    if (!selectedMeal) {\n      console.error('No selected meal for serving calculation');\n      return;\n    }\n    \n    const weightNumber = parseFloat(weight);\n    if (isNaN(weightNumber) || weightNumber <= 0) {\n      console.error('Invalid weight provided:', weight);\n      return;\n    }\n    const ratio = calculateServingRatio(weightNumber, unit, selectedMeal);\n    \n    const nutrients = selectedMeal?.nutritional_metrics?.nutrients_per_100g || \n                     selectedMeal?.nutrients?.per100g || {};\n    \n    if (!nutrients || Object.keys(nutrients).length === 0) {\n      console.warn('No nutrition data found for selected meal');\n      setFields(prev => ({\n        ...prev,\n        serving: weightNumber,\n        servingUnit: unit\n      }));\n      return;\n    }\n    \n    const newNutrition = {\n      protein: ((nutrients.protein?.value || 0) * ratio).toFixed(1),\n      carbs: ((nutrients.carbs?.value || 0) * ratio).toFixed(1),\n      fat: ((nutrients.fat?.value || 0) * ratio).toFixed(1),\n      calories: ((nutrients.calories?.value || 0) * ratio).toFixed(0)\n    };\n    \n    console.log('Calculated nutrition for serving:', newNutrition);\n    \n    setFields(prev => ({\n      ...prev,\n      serving: weightNumber,\n      servingUnit: unit,\n      protein: newNutrition.protein,\n      carbs: newNutrition.carbs,\n      fat: newNutrition.fat,\n      calories: newNutrition.calories\n    }));\n    \n    setSuccess(`Serving updated to ${description} (${weightNumber}${unit})`);\n    setTimeout(() => setSuccess(''), 2000);\n  };\n\n  const recalculateNutrients = (newServing, unit = 'g') => {\n    if (!selectedMeal) {\n      console.log('No selected meal for recalculation');\n      return;\n    }\n    \n    const serving = parseFloat(newServing);\n    if (isNaN(serving) || serving <= 0) {\n      console.log('Invalid serving size for recalculation:', newServing);\n      return;\n    }\n    \n    const nutrients = selectedMeal.nutritional_metrics?.nutrients_per_100g || \n                     selectedMeal.nutrients?.per100g || {};\n\n    let ratio;\n    \n    if (unit === 'ml') {\n      const density = getDensityForFood(selectedMeal.name) || 1.0;\n      const weightInGrams = serving * density;\n      ratio = weightInGrams / 100;\n      \n      console.log('Liquid conversion:', {\n        serving: serving + 'ml',\n        density: density,\n        weightInGrams: weightInGrams + 'g',\n        ratio: ratio\n      });\n    } else {\n      ratio = serving / 100;\n      \n      console.log('Solid conversion:', {\n        serving: serving + 'g',\n        ratio: ratio\n      });\n    }\n    \n    console.log('Recalculating nutrients:', {\n      selectedMeal: selectedMeal.name,\n      newServing: serving,\n      unit: unit,\n      ratio: ratio,\n      originalNutrients: nutrients\n    });\n\n    setFields(prevFields => {\n      const updatedFields = { \n        ...prevFields, \n        serving: serving,\n        servingUnit: unit\n      };\n\n      if (nutrients.protein?.value !== undefined) {\n        updatedFields.protein = (nutrients.protein.value * ratio).toFixed(1);\n      }\n      if (nutrients.carbs?.value !== undefined) {\n        updatedFields.carbs = (nutrients.carbs.value * ratio).toFixed(1);\n      }\n      if (nutrients.fat?.value !== undefined) {\n        updatedFields.fat = (nutrients.fat.value * ratio).toFixed(1);\n      }\n      if (nutrients.calories?.value !== undefined) {\n        updatedFields.calories = (nutrients.calories.value * ratio).toFixed(0);\n      }\n\n      updatedFields.micronutrients = {};\n      Object.entries(nutrients).forEach(([key, value]) => {\n        if (!['protein', 'carbs', 'fat', 'calories', 'name', 'unit'].includes(key) && value?.value !== undefined) {\n          updatedFields.micronutrients[key] = {\n            ...value,\n            value: (value.value * ratio).toFixed(1)\n          };\n        }\n      });\n\n      console.log('Updated fields after recalculation:', updatedFields);\n      return updatedFields;\n    });\n  };\n\n  const fetchSuggestions = useCallback(async () => {\n    const normalizedSearch = search.toLowerCase().trim();\n\n    console.log('fetchSuggestions called with:', normalizedSearch);\n\n    if (normalizedSearch.length < 2) {\n      setSuggestions([]);\n      return;\n    }\n\n    if (suggestionCache[normalizedSearch]) {\n      console.log('Using cached results for:', normalizedSearch);\n      setSuggestions(suggestionCache[normalizedSearch]);\n      return;\n    }\n\n    try {\n      console.log(`Search for: \"${normalizedSearch}\"`);\n\n      let allFoods = allFoodsCache;\n      if (allFoods.length === 0) {\n        console.log('Fetching food database...');\n        const q = query(collection(db, 'meals'));\n\n        const snap = await getDocs(q);\n        allFoods = snap.docs.map(doc => ({ \n          id: doc.id, \n          ...doc.data()\n        }));\n\n        setAllFoodsCache(allFoods);\n        console.log(`Loaded ${allFoods.length} foods into cache`);\n      }\n\n      // Enhanced search algorithm with better scoring\n      const results = allFoods\n        .filter(meal => {\n          if (!meal.name) return false;\n          \n          const mealNameLower = meal.name.toLowerCase();\n          const category = (meal.category || '').toLowerCase();\n          const description = (meal.description || '').toLowerCase();\n          const tags = (meal.tags || []).map(tag => tag.toLowerCase());\n          \n          return mealNameLower.includes(normalizedSearch) ||\n                 mealNameLower.startsWith(normalizedSearch) ||\n                 category.includes(normalizedSearch) ||\n                 description.includes(normalizedSearch) ||\n                 tags.some(tag => tag.includes(normalizedSearch)) ||\n                 mealNameLower.split(' ').some(word => word.startsWith(normalizedSearch));\n        })\n        .map(food => {\n          const mealNameLower = (food.name || '').toLowerCase();\n          const category = (food.category || '').toLowerCase();\n          const description = (food.description || '').toLowerCase();\n          \n          let score = 0;\n          \n          if (mealNameLower === normalizedSearch) score += 100;\n          if (mealNameLower.startsWith(normalizedSearch)) score += 50;\n          if (mealNameLower.split(' ').some(word => word.startsWith(normalizedSearch))) score += 30;\n          if (mealNameLower.includes(normalizedSearch)) score += 20;\n          if (category.includes(normalizedSearch)) score += 15;\n          if (description.includes(normalizedSearch)) score += 10;\n          \n          if (food.nutritional_metrics?.serving_options || food.nutritional_metrics?.common_portions) {\n            score += 5;\n          }\n          \n          if (food.longCovidRelevance || food.longCovidBenefits || food.longCovidCautions) {\n            score += 3;\n          }\n          \n          return {\n            ...food,\n            searchMethod: 'javascript',\n            searchScore: score\n          };\n        })\n        .sort((a, b) => {\n          if (b.searchScore !== a.searchScore) {\n            return b.searchScore - a.searchScore;\n          }\n          return (a.name || '').localeCompare(b.name || '');\n        });\n\n      console.log(`Found ${results.length} results (showing all)`);\n\n      setSuggestionCache(prev => ({\n        ...prev,\n        [normalizedSearch]: results\n      }));\n\n      setSuggestions(results);\n\n    } catch (err) {\n      console.error('Search error:', err);\n      setSuggestions([]);\n    }\n  }, [search, suggestionCache, allFoodsCache]);\n\n  // Clear search function\n  const clearSearch = () => {\n    setSearch('');\n    setSuggestions([]);\n    setSelectedMeal(null);\n    setSearchFocused(false);\n    setFields({});\n  };\n\n  // Search input renderer\n  const renderSearchInput = () => (\n    <div className=\"form-group search-group\">\n      <label>Search Food</label>\n      <div className={`search-input-container ${searchFocused ? 'search-focused' : ''}`}>\n        <input\n          type=\"text\"\n          value={search}\n          onChange={e => { \n            const newValue = e.target.value;\n            setSearch(newValue); \n            setSelectedMeal(null);\n            if (newValue.length < 2) {\n              setSuggestions([]);\n            }\n          }}\n          onFocus={() => setSearchFocused(true)}\n          onBlur={() => {\n            setTimeout(() => {\n              setSearchFocused(false);\n              setSuggestions([]);\n            }, 200);\n          }}\n          placeholder=\"Search foods...\"\n          autoComplete=\"off\"\n          className=\"search-input\"\n        />\n\n        {search.length > 0 && (\n          <button \n            onClick={clearSearch}\n            className=\"clear-search-button\"\n            type=\"button\"\n            title=\"Clear search\"\n          >\n            \n          </button>\n        )}\n\n        <div className=\"search-status\">\n          {suggestions.length > 0 && (\n            <span className=\"result-count\">\n              {suggestions.length} result{suggestions.length !== 1 ? 's' : ''}\n              {suggestions.length > 50 && (\n                <span className=\"large-result-hint\"> - scroll to see more</span>\n              )}\n            </span>\n          )}\n        </div>\n      </div>\n\n      {suggestions.length > 0 && searchFocused && (\n        <div className=\"suggestions-container\">\n          <ul className=\"suggestions-list unlimited\">\n            {suggestions.map((s, index) => (\n              <li \n                key={s.id || index} \n                onClick={() => handleSelectMeal(s)}\n                onMouseDown={(e) => e.preventDefault()}\n                className=\"suggestion-item\"\n              >\n                <div className=\"suggestion-main\">\n                  <div className=\"suggestion-name\">{s.name}</div>\n                  {s.category && (\n                    <div className=\"suggestion-category\">{s.category}</div>\n                  )}\n                  {s.searchScore && (\n                    <div className=\"suggestion-score\" title={`Relevance: ${s.searchScore}`}>\n                      {s.searchScore >= 50 ? '' : s.searchScore >= 20 ? '' : ''}\n                    </div>\n                  )}\n                </div>\n                \n                <div className=\"suggestion-indicators\">\n                  {s.nutritional_metrics?.serving_options && (\n                    <span className=\"serving-indicator\" title=\"Has serving suggestions\">\n                      \n                    </span>\n                  )}\n                  {longCovidAdjust && (\n                    <span className={`covid-indicator ${getCovidFoodRating(s.name)}`}>\n                      {getCovidFoodRating(s.name) === 'beneficial' ? '' : \n                       getCovidFoodRating(s.name) === 'caution' ? '' : ''}\n                    </span>\n                  )}\n                </div>\n              </li>\n            ))}\n          </ul>\n          \n          {suggestions.length > 20 && (\n            <div className=\"search-tips\">\n              <small>\n                 Tip: Type more specific terms to narrow down results, or scroll to browse all {suggestions.length} matches\n              </small>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n\n  // Search effect\n  useEffect(() => {\n    if (debouncedSearch.length < 2) {\n      setSuggestions([]);\n      return;\n    }\n    fetchSuggestions();\n  }, [debouncedSearch, fetchSuggestions]);\n\n  // Handle field changes\n  const handleFieldChange = (e) => {\n    const { name, value } = e.target;\n\n    if (name === 'serving') {\n      setFields(prev => ({ ...prev, [name]: value }));\n      if (selectedMeal) {\n        recalculateNutrients(value);\n      }\n    } else {\n      setFields(prev => ({ ...prev, [name]: value }));\n    }\n  };\n\n  // Fetch food log function\n  const fetchFoodLog = useCallback(async (page = 1) => {\n    if (!currentUser || !currentUser.id) return;\n\n    setLogLoading(true);\n    if (page === 1) setFoodLog([]);\n    setJournalError('');\n\n    try {\n      const q = query(\n        collection(db, 'users', currentUser.id, 'food_journal'),\n        orderBy('date', 'desc'),\n        orderBy('createdAt', 'desc'),\n        limit(ENTRIES_PER_PAGE * page)\n      );\n\n      const snap = await getDocs(q);\n      const entries = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n\n      setFoodLog(entries);\n      setJournalPage(page);\n\n    } catch (err) {\n      console.error('Error fetching food log:', err);\n      setJournalError(`Failed to load journal: ${err.message}`);\n    } finally {\n      setLogLoading(false);\n    }\n  }, [currentUser]);\n\n  // Fetch food log when user is authenticated\n  useEffect(() => {\n    if (currentUser && !authLoading) {\n      fetchFoodLog(1);\n    }\n  }, [currentUser, authLoading, fetchFoodLog]);\n\n  // Back navigation\n  const handleBack = () => {\n    navigate('/dashboard');\n  };\n\n  // Loading state\n  if (authLoading) {\n    return (\n      <div className=\"food-tracker-container\">\n        <div className=\"loading-indicator\">Loading...</div>\n      </div>\n    );\n  }\n\n  // Authentication required state\n  if (!currentUser) {\n    return (\n      <div className=\"food-tracker-container\">\n        <div className=\"auth-required\">\n          <h2>Authentication Required</h2>\n          <p>Please log in to use the food tracker.</p>\n          <button onClick={handleBack} className=\"back-button\">\n            Back to Dashboard\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"food-tracker-container\">\n      {/* Animated background elements */}\n      <div className=\"bg-animation\">\n        <div className=\"card-glow\"></div>\n        <div className=\"floating-shape shape-1\"></div>\n        <div className=\"floating-shape shape-2\"></div>\n        <div className=\"floating-shape shape-3\"></div>\n        <div className=\"floating-shape shape-4\"></div>\n        <div className=\"floating-shape shape-5\"></div>\n        <div className=\"floating-shape shape-6\"></div>\n      </div>\n\n      <div className=\"food-tracker-content\">\n        {/* Header */}\n        <div className=\"tracker-header\">\n          <button onClick={handleBack} className=\"back-button\">\n             Back to Dashboard\n          </button>\n          <button onClick={handleLogout} className=\"logout-btn\">\n            Logout\n          </button>\n        </div>\n\n        {/* Title */}\n        <h2> Smart Meal Tracker</h2>\n\n\n        <div className=\"food-tabs\">\n          {TABS.map(t => (\n            <button\n              key={t}\n              className={`food-tab${tab === t ? ' active' : ''}`}\n              onClick={() => setTab(t)}\n            >\n              {t}\n            </button>\n          ))}\n        </div>\n\n        {tab === 'Add Food' && (\n          <AddFoodTab\n            // Search and meal selection\n            search={search}\n            setSearch={setSearch}\n            suggestions={suggestions}\n            setSuggestions={setSuggestions}\n            selectedMeal={selectedMeal}\n            setSelectedMeal={setSelectedMeal}\n            searchFocused={searchFocused}\n            setSearchFocused={setSearchFocused}\n            renderSearchInput={renderSearchInput}\n            handleSelectMeal={handleSelectMeal}\n            clearSearch={clearSearch}\n            \n            // Form fields and state\n            fields={fields}\n            setFields={setFields}\n            mealType={mealType}\n            setMealType={setMealType}\n            time={time}\n            setTime={setTime}\n            date={date}\n            setDate={setDate}\n            longCovidAdjust={longCovidAdjust}\n            setLongCovidAdjust={setLongCovidAdjust}\n            \n            // Edit mode\n            editingEntry={editingEntry}\n            handleCancelEdit={handleCancelEdit}\n            \n            // Form handlers\n            handleFieldChange={handleFieldChange}\n            handleServingSelection={handleServingSelection}\n            handleTimeChange={handleTimeChange}\n            convertTo24Hour={convertTo24Hour}\n            handleLogFood={handleLogFood}\n            \n            // Status and messages\n            loading={loading}\n            success={success}\n            error={error}\n            \n            // Constants\n            mealTypes={mealTypes}\n            pyodideStatus={pyodideStatus}\n            \n            // Other props\n            foodLog={foodLog}\n            MicronutrientRadarChart={MicronutrientRadarChart}\n          />\n        )}\n\n        {tab === 'Food Journal' && (\n          <FoodJournalTab\n            // Data\n            foodLog={foodLog}\n            journalPage={journalPage}\n            \n            // Loading and error states\n            logLoading={logLoading}\n            journalError={journalError}\n            success={success}\n            \n            // Delete confirmation\n            deleteConfirmId={deleteConfirmId}\n            setDeleteConfirmId={setDeleteConfirmId}\n            deleteLoading={deleteLoading}\n            handleDeleteEntry={handleDeleteEntry}\n            \n            // Actions\n            fetchFoodLog={fetchFoodLog}\n            handleEditEntry={handleEditEntry}\n            \n            // Constants\n            ENTRIES_PER_PAGE={ENTRIES_PER_PAGE}\n            \n            // Utility functions\n            formatDateHeader={formatDateHeader}\n          />\n        )}\n\n        {tab === 'Analysis' && (\n          <AnalysisTab \n            foodLog={foodLog} \n            userProfile={userProfile} \n          />\n        )}\n        {tab === 'Trends' && (\n  <VitaminTimeSeriesTab \n    foodLog={foodLog}\n    userProfile={userProfile}\n  />\n)}\n      </div>\n    </div>\n  );\n}\n\nexport default FoodTrackerPage;"],"names":["ServingSuggestions","_ref","selectedMeal","onServingSelect","currentServing","currentUnit","nutritional_metrics","serving_options","getUnitIcon","unit","_jsxs","className","children","_jsx","Object","keys","length","entries","map","_ref2","key","option","selected","weight","arguments","undefined","parseFloat","isSelected","concat","onClick","description","console","log","error","handleServingClick","title","LongCovidFoodInfo","_ref3","foodName","mealData","longCovidRelevance","longCovidBenefits","longCovidCautions","covidRelevance","benefits","cautions","functionalCompounds","category","antiInflammatoryLevel","antiInflammatory","toUpperCase","_ref4","compound","level","replace","benefit","i","caution","LongCovidSidePanel","_ref5","selectedFood","foodLog","isSearching","searchTerm","_ref6","search","setSearch","suggestions","setSuggestions","setSelectedMeal","searchFocused","setSearchFocused","renderSearchInput","handleSelectMeal","clearSearch","fields","setFields","mealType","setMealType","time","setTime","date","setDate","longCovidAdjust","setLongCovidAdjust","editingEntry","handleCancelEdit","handleFieldChange","handleServingSelection","handleTimeChange","convertTo24Hour","handleLogFood","loading","success","mealTypes","pyodideStatus","MicronutrientRadarChart","name","type","checked","onChange","e","target","serving","servingUnit","value","protein","step","placeholder","readOnly","carbs","fat","htmlFor","id","calories","disabled","micronutrients","DeleteConfirmModal","entryId","entryName","onConfirm","onCancel","deleteLoading","_foodLog$find","journalPage","logLoading","journalError","deleteConfirmId","setDeleteConfirmId","handleDeleteEntry","fetchFoodLog","handleEditEntry","ENTRIES_PER_PAGE","formatDateHeader","convertTo24HourForSort","time12h","modifier","split","hours","minutes","hour24","parseInt","toString","padStart","getMealBadge","charAt","find","entry","_Fragment","sortedEntries","sort","a","b","localeCompare","timeA","timeB","groupedEntries","forEach","push","dayTotals","reduce","totals","meals","calculateDayTotals","Math","round","toFixed","index","trim","toLowerCase","substring","metabolicEfficiency","calculateFoodEfficiency","userProfile","timeStr","hourMatch","match","hour","isPM","includes","proteinFactor","carbFactor","fatFactor","timeFactor","mealTypeFactor","efficiency","min","hasLongCovid","severity","longCovidSeverity","max","parseDate","dateString","parts","Date","formatDateForComparison","year","getFullYear","month","String","getMonth","day","getDate","baseRDAData10","vitamin_a","femaleAdjust","vitamin_c","vitamin_d","vitamin_e","vitamin_k","vitamin_b6","vitamin_b12","folate","iron","calcium","magnesium","zinc","selenium","copper","potassium","phosphorus","vitamin_b1","vitamin_b2","vitamin_b3","manganese","MacronutrientChart","userData","userIntake","chartRef","useRef","personalizedRDA","setPersonalizedRDA","useState","calculatePersonalizedRDA","useCallback","calculateBMI","height","pow","totalCalories","age","gender","activity_level","bmr","tdee","covid_condition","bmi","calculateTDEE","macroDistribution","calculateMacroDistribution","proteinPct","carbsPct","fatPct","remaining","covidNotes","covidNote","useEffect","rda","current","select","selectAll","remove","margin","top","right","bottom","left","width","svg","append","attr","macros","data","_objectSpread","colors","x","scaleBand","domain","d","range","padding","maxValue","y","scaleLinear","call","axisBottom","axisLeft","ticks","text","formattedDate","toLocaleDateString","y0","stackedData","nutrient","y1","tooltip","style","join","bandwidth","on","event","parentData","this","parentNode","datum","amount","percentage","caloriesPerGram","html","pageX","pageY","legend","legendRow","calculateCalories","calorieInfo","ref","minHeight","BulletChart","maxPercent","actualWidth","rawValue","displayPercentage","optimalWidth","barColor","percent","isAdjusted","color","backgroundColor","MicronutrientChart","userInfo","setUserInfo","chartData","setChartData","allChartData","setAllChartData","nutrientIntake","intakeData","baseRDAData","completeIntakeData","nutrientKey","hasOwnProperty","rdaInfo","intakeValue","finalValue","finalUnit","numValue","warn","ensureCompleteNutrientData","displayMode","setDisplayMode","isLoading","setIsLoading","selectedCategory","setSelectedCategory","getSeverityFactor","processNutrientData","rdaData","processedNutrients","intakeDetails","percentOfRDA","formattedName","c","processedNutrient","rdaUnit","isAdjustedRDA","sortedNutrients","filter","n","applyFilters","dataToFilter","filteredData","item","baseRDAData_","personalRDA","JSON","parse","stringify","_personalRDA$nutrient","adjustedValue","ageMultiplier","covid_severity","severityFactor","isNaN","isFinite","roundedValue","getNutrientStatus","percentValue","label","getNutrientInfo","nutrientName","nutrientInfoMap","exactMatch","timer","setTimeout","calculatedRDA","processedAllData","clearTimeout","toggleCovidSeverity","_userInfo$covid_sever","_userInfo$longCovidSe","severities","currentSeverity","currentIndex","indexOf","newSeverity","updatedUserInfo","getCurrentCovidSeverity","slice","changeDisplayMode","mode","changeCategory","deficientCount","getCovidSeverityClass","getFilterDescription","displayPart","medical_conditions","border","borderRadius","cursor","fontSize","fontWeight","transition","minWidth","onMouseEnter","transform","onMouseLeave","EfficiencyChart","foodDatabase","processedData","setProcessedData","today","oneWeekAgo","oneWeekAgoString","meal","dateString1","dateString2","err","isSameOrAfter","finalEfficiency","originalEfficiency","actualEnergy","wastedEnergy","fallbackEfficiency","allDatesInRange","combinedData","groupedByDate","group","uniqueMealTypes","dateData","get","mealsByType","sum","weightedEfficiency","acc","totalActualEnergy","totalWastedEnergy","originalMeals","mealOrder","chronologicalData","xOuter","xInner","maxCalories","yEff","tickFormat","axisRight","mealColors","mealColor","barX","barWidth","sortedLineData","barCenterX","xPos","chronologicalIndex","lineGenerator","line","defined","curve","curveMonotoneX","enter","legendY","legendData","opacity","mealTypeData","_ref7","floor","display","flexDirection","overflow","flexShrink","marginTop","boxSizing","marginBottom","lineHeight","paddingLeft","AnalysisTab","_ref8","Array","isArray","analysisDate","todayMeals","macroSums","microSums","efficiencyData","todayEntries","entryIndex","originalKey","nutrientValue","keyMappings","lowerKey","normalizeNutrientKey","valueToAdd","threshold","getChartData","micronutrientMapping","availableMicronutrients","displayNutrients","chartSize","centerX","centerY","totalAxes","angleStep","PI","_micronutrients$key","axisLines","angle","x1","x2","cos","y2","sin","labelX","radius","labelY","dataPoints","_micronutrients$key2","_micronutrients$key3","normalizedValue","pointRadius","axisIndex","polygonPath","point","scaleCircles","scale","r","circle","cx","cy","fill","stroke","strokeWidth","strokeLinejoin","strokeLinecap","isRightSide","isLeftSide","isTopHalf","textAnchor","dominantBaseline","abs","jsx","selectedVitamins","setSelectedVitamins","timeRange","setTimeRange","groupBy","setGroupBy","showRecommended","setShowRecommended","vitaminRecommendations","female","male","thiamine","riboflavin","niacin","biotin","pantothenic_acid","sodium","chromium","molybdenum","availableVitamins","useMemo","vitamins","Set","vitamin","add","from","timeSeriesData","parseLocalDate","cutoffDate","filteredLog","entryDate","getTime","groupedData","_","weekStart","getDay","toISOString","period","vitaminTotals","entryCount","getRecommendedValue","rec","vitaminColors","CustomTooltip","active","payload","displayDate","boxShadow","_vitaminRecommendatio","_entry$value","dataKey","marginLeft","vitaminGroups","gridTemplateColumns","gap","Number","alignItems","marginRight","flexWrap","groupName","availableInGroup","v","selectVitaminGroup","onMouseOver","onMouseOut","maxHeight","overflowY","prev","handleVitaminToggle","ResponsiveContainer","LineChart","CartesianGrid","strokeDasharray","XAxis","tickFormatter","YAxis","Tooltip","content","Legend","Line","dot","connectNulls","recommendedValue","ReferenceLine","strokeOpacity","position","textAlign","_vitaminRecommendatio2","_vitaminRecommendatio3","_vitaminRecommendatio4","_vitaminRecommendatio5","values","avg","val","recommended","avgPercentage","isPersonalized","some","activityLevel","getUserTimezone","Intl","DateTimeFormat","resolvedOptions","timeZone","getTodayInUserTimezone","userTimezone","formatToParts","part","yesterday","daysAgo","getDaysAgoInUserTimezone","options","weekday","TABS","navigate","useNavigate","allFoodsCache","setAllFoodsCache","currentUser","setCurrentUser","setUserProfile","authLoading","setAuthLoading","tab","setTab","toLocaleTimeString","minute","setLoading","setSuccess","setError","setFoodLog","setLogLoading","setJournalError","setJournalPage","setEditingEntry","setDeleteLoading","suggestionCache","setSuggestionCache","debouncedSearch","useDebounce","delay","debouncedValue","setDebouncedValue","handler","checkUserAuthentication","async","storedUserData","localStorage","getItem","parsedUserData","userDocRef","doc","db","uid","userDoc","getDoc","exists","fetchUserProfile","getCovidFoodRating","foodLower","food","calculateMetabolicEfficiency","_meal$nutritional_met","_meal$nutrients","_meal$nutritional_met2","_nutrients$protein","_nutrients$carbs","_nutrients$fat","_nutrients$calories","nutrients","nutrients_per_100g","per100g","defaultServing","defaultUnit","defaultDescription","firstOption","ratio","calculateServingRatio","servingDescription","getDensityForFood","densityMap","density","fetchSuggestions","normalizedSearch","allFoods","q","query","collection","getDocs","docs","results","mealNameLower","tags","tag","startsWith","word","_food$nutritional_met","_food$nutritional_met2","score","common_portions","searchMethod","searchScore","page","orderBy","limit","message","handleBack","removeItem","sessionStorage","clear","t","AddFoodTab","newValue","onFocus","onBlur","autoComplete","s","_s$nutritional_metric","onMouseDown","preventDefault","newServing","_selectedMeal$nutriti2","_selectedMeal$nutrien2","weightInGrams","originalNutrients","prevFields","_nutrients$protein3","_nutrients$carbs3","_nutrients$fat3","_nutrients$calories3","updatedFields","recalculateNutrients","_selectedMeal$nutriti","_selectedMeal$nutrien","_nutrients$protein2","_nutrients$carbs2","_nutrients$fat2","_nutrients$calories2","weightNumber","newNutrition","time24","time12","Error","entryData","mealId","updateDoc","updatedAt","Timestamp","now","prevLog","createdAt","docRef","addDoc","newEntry","FoodJournalTab","deleteDoc","originalMeal","mockMeal","VitaminTimeSeriesTab"],"sourceRoot":""}